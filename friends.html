<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friends</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.9.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.9.1/firebase-firestore.js"></script>
    <script src="theme.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@joeattardi/emoji-button@4.6.2/dist/emoji-button.min.js"></script>
    <style>
     :root {
        --primary-color: #6C63FF;
            --secondary-color: #3F3D56;
            --accent-color: #F50057;
            --text-color: #F8F9FA;
            --bg-color: #121212;
            --card-bg: #1E1E1E;
    --glass-bg: rgba(255, 255, 255, 0.1); /* Frosted Glass Effect */
    --hover-bg: rgba(255, 255, 255, 0.1); /* Slightly Darker Hover Background */
    --border-radius: 15px;
    --svg-size: 50px; /* Default size */

}


* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Poppins', sans-serif;
    line-height: 1.6;
    color: var(--text-color);
    background-color: var(--bg-color); /* Solid dark background */
    backdrop-filter: blur(10px); /* Optional: keeps the frosted glass effect */
}


body.night-mode {
    background-color: #333333;
    primary-color: #121212; /* Darker background */
    secondary-color: #1E1E1E; /* Darker grayish background */
    accent-color: #009bf5; /* Adjust if necessary */
    text-color: #e0e0e0; /* Lighter text color for dark mode */
    --bg-color: rgba(18, 18, 18, 0.8); /* Darker background */
    --card-bg: rgba(30, 30, 30, 0.8); /* Darker card background */
    --glass-bg: rgba(18, 18, 18, 0.8); /* Darker frosted glass effect */
    --hover-bg: rgba(30, 30, 30, 0.9); /* Darker hover background */
}
}

.menu-item {
    display: flex;
    align-items: center;
    cursor: pointer;
    padding: 8px 16px;
    border-radius: 4px;
    transition: background-color 0.3s;
}

.menu-item:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

.theme-icon {
    margin-right: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
}

.theme-icon.active {
    animation: rotate 0.5s ease-in-out;
}

@keyframes rotate {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(360deg);
    }
}



.container {
    display: flex;
    height: 100vh;
}

.sidebar {
    width: 250px;
    min-width: 250px; /* Ensure minimum width is always maintained */
    max-width: 250px; /* Ensure maximum width is always maintained */
    background: inherit;
    padding: 20px;
    display: flex;
    flex-direction: column;
    height: 100%;
    border-radius: var(--border-radius);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
}

.sidebar h1 {
    font-size: 24px;
    margin-bottom: 20px;
}

.sidebar ul {
    list-style: none;
    padding: 0;
}

.sidebar ul li {
    margin-bottom: 20px;
}

.sidebar ul li a {
    text-decoration: none;
    color: var(--secondary-color);
    font-size: 18px;
    transition: color 0.3s ease;
}

.sidebar ul li a:hover {
    color: var(--primary-color);
}

.logo {
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--primary-color);
    display: flex;
    align-items: center;
    margin-bottom: 30px;
}

.logo svg {
    width: 30px;
    height: 30px;
    margin-right: 10px;
}

.menu-item {
    margin-bottom: 15px;
    color: var(--text-color);
    cursor: pointer;
    transition: color 0.3s ease;
    display: flex;
    align-items: center;
    transition: transform 0.3s ease;
}

.menu-item svg {
    width: 20px;
    height: 20px;
    margin-right: 10px;
}

.menu-item:hover {
    color: var(--primary-color);
    transform: scale(1.1);
}

.upgrade-btn {
    background: linear-gradient(45deg, var(--accent-color), #FF1493);
    color: var(--text-color);
    border: none;
    padding: 10px 20px;
    border-radius: 50px;
    cursor: pointer;
    margin-top: 20px;
    font-weight: 600;
    display: flex;
    align-items: center;
    transition: background-color 0.3s ease, transform 0.3s ease;
    backdrop-filter: blur(10px);
    background-color: rgba(255, 255, 255, 0.1);
}

.upgrade-btn svg {
    width: 20px;
    height: 20px;
    margin-right: 10px;
}

.upgrade-btn:hover {
    transform: scale(1.05);
}

.main-content {
    flex-grow: 1;
    padding: 20px;
    overflow-y: auto;
    background: transparent;
}

.dashboard-header {
    display: flex;
    align-items: center;
    margin-bottom: 30px;
}

.dashboard-header h1 {
    display: flex;
    align-items: center;
    font-size: 2.5rem; /* Adjust as needed */
}

.dashboard-header svg {
    width: var(--svg-size); /* Use the variable for size */
    height: var(--svg-size); /* Maintain aspect ratio */
    margin-left: 8px; /* Adjust space between text and icon */
}


.friends-list, .add-friend, .chat-window {
    margin-bottom: 20px; /* Reduced margin for more compact spacing */
}

.friends-list h2, .chat-window h2 {
    font-size: 24px;
    font-weight: 500;
    margin-bottom: 15px;
}

.unfriend-button {
    padding: 5px;
    background-color: var(--accent-color);
    color: #fff;
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.3s;
    margin-left: 10px; /* Space between name and button */
    display: flex;
    align-items: center;
    justify-content: center;
}

.unfriend-button:hover {
    background-color: #c0392b;
}

.unfriend-button svg {
    width: 20px; /* Adjust size as needed */
    height: 20px; /* Adjust size as needed */
}



#onlineFriends {
    list-style: none;
    padding: 0;
    margin: 0;
}

#onlineFriends li {
    background: var(--glass-bg);
    padding: 10px;
    margin-bottom: 10px;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: background 0.3s;
    display: flex;
    justify-content: space-between; /* Ensure the friend name and unfriend button are spaced out */
    align-items: center; /* Align items in the center vertically */
}

#onlineFriends li:hover {
    background: var(--hover-bg);
}

#pinnedFriends {
    list-style: none;
    padding: 0;
    margin: 0;
}

#pinnedFriends .friend-item {
    background: var(--glass-bg);
    padding: 10px;
    margin-bottom: 10px;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: background 0.3s;
    display: flex;
    justify-content: space-between; /* Ensure the friend name and buttons are spaced out */
    align-items: center; /* Align items in the center vertically */
}

#pinnedFriends .friend-item:hover {
    background: var(--hover-bg);
}


.friend-name {
    flex-grow: 1; /* Make the friend name take up remaining space */
    margin-right: 10px; /* Add some spacing between the name and the button */
}

.add-friend {
    display: flex;
    align-items: center;
    gap: 10px; /* Improved spacing between input and button */
    margin-bottom: 20px;
}

.add-friend input[type="text"] {
    padding: 10px;
    border: 1px solid var(--secondary-color);
    border-radius: var(--border-radius);
    width: calc(100% - 130px); /* Adjusted width to ensure proper spacing */
    box-sizing: border-box;
    font-size: 16px;
    background-color: var(--card-bg);
    color: var(--text-color);
}

.add-friend button {
    background-color: var(--primary-color); /* or any color */
    border: none;
    padding: 10px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 80px; /* Longer width */
    height: 40px; /* Height to keep it balanced */
    border-radius: 20px; /* Creates the squircle effect */
    transition: background-color 0.3s;
}

.add-friend button:hover {
    background-color: #3b7bce;
}

.add-friend button svg {
    width: 30px; /* Adjusted SVG size */
    height: 30px;
    fill: #ffffff; /* Ensures the SVG color is white */
    margin: 0; /* Reset margin if needed */
    transform: translateX(0); /* Adjust the X-axis if needed */
    transform: translateY(0px); /* Adjust the X-axis if needed */

}

.message-container {
    position: relative; /* Allows absolute positioning of child elements */
    padding: 5px;
    margin-bottom: 10px; /* Adjust as needed */
}
        
.add-friend-icon-button {
    padding: 0 !important; /* Ensure no padding is applied */
    background-color: var(--primary-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    position: absolute;
    right: -90px;
    top: 50%;
    transform: translateY(-50%);
    z-index: 1;
}

.add-friend-icon-button svg {
    width: 24px;
    height: 24px;
    fill: none; /* Set fill to none */
    stroke: #ffffff; /* Set stroke color to white */
}


/* Ensures the chat window is styled correctly */
.chat-window {
    display: flex;
    flex-direction: column;
    height: calc(100vh - 200px); /* Adjust height as needed */
    background: var(--glass-bg);
    border-radius: var(--border-radius);
    padding: 15px;
    max-height: 600px; /* Limits the height of the chat window */
    position: relative; /* Allows absolute positioning of child elements */
}

#chatMessages {
    flex: 1;
    overflow-y: auto;
    padding-right: 10px;
    margin-bottom: 15px;
    /* Provides the main container for chat messages with scrolling enabled */
}

#chatMessages .message {
    max-width: 70%;
    padding: 10px;
    border-radius: 10px;
    margin-bottom: 10px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    clear: both;
    position: relative; /* Allows positioning of the reaction relative to the message */
    /* Styles for individual message bubbles, including padding, border radius, and shadows */
}

#chatMessages .message.sent {
    background: var(--primary-color);
    color: #fff;
    align-self: flex-end;
    float: right;
    text-align: right;
    border-top-right-radius: 0;
    /* Styles for messages sent by the user, including background color and text alignment */
}

#chatMessages .message.received {
    background: var(--accent-color);
    color: var(--text-color);
    align-self: flex-start;
    float: left;
    text-align: left;
    border-top-left-radius: 0;
    /* Styles for messages received from others, including background color and text alignment */
}

/* Container for the reply count and text */
.message-container-2 {
    position: relative; /* Allows positioning of child elements */
    padding: 5px;
    margin-bottom: 10px; /* Adjust as needed */
}

/* Reply count styling */
.reply-count {
    display: inline; /* Ensure text is displayed inline */
    font-size: 12px;
    color: #fff; /* Make the text color white */
    text-align: center; /* Center text within the container */
    margin-top: 5px; /* Space from the message bubble */
    position: absolute; /* Position it absolutely relative to the container */
    left: 0; /* Align to the left */
    bottom: -30px; /* Position it below the message bubble */
    width: 100%; /* Full width of the container */
    text-align: center; /* Center the text within the width */
    white-space: nowrap; /* Prevent text from wrapping */
}



#chatMessages .message-reaction {
    position: absolute;
    top: -8px; /* Slightly raised above the message bubble */
    right: -10px; /* Positioned on the right side of the message bubble */
    font-size: 18px;
    background-color: var(--primary-color); /* Primary color background */
    color: #fff; /* White color for the reaction icon */
    border-radius: 50%; /* Makes the background a circle */
    padding: 5px; /* Adds padding inside the circle */
    width: 24px; /* Set width for a perfect circle */
    height: 24px; /* Set height for a perfect circle */
    display: flex; /* Align icon inside the circle */
    align-items: center; /* Center the icon vertically */
    justify-content: center; /* Center the icon horizontally */
    /* Styles for the reaction icon, with primary color background and circular shape */
}

/* Input and button container styling */
.chat-input-container {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    position: relative; /* Ensures emoji picker is positioned relative to this container */
}

.chat-input-container input {
    flex: 1;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: var(--border-radius);
    font-size: 16px;
}

.chat-input-container button {
    background-color: var(--primary-color); /* Adjust as needed */
    border: none;
    border-radius: var(--border-radius);
    padding: 8px; /* Adjust padding as needed */
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.3s;
    margin-left: 1px; /* Space between input and button */
    width: 40px; /* Adjust width as needed */
    height: 40px; /* Adjust height as needed */
}

.chat-input-container button:hover {
    background-color: #3b7bce; /* Adjust hover color as needed */
}

.chat-input-container button svg {
    width: 24px; /* Adjust size as needed */
    height: 24px; /* Adjust size as needed */
    stroke: #ffffff; /* Ensures the SVG stroke color is white */
}

#chatInput {
    padding: 10px;
    border: 1px solid var(--secondary-color);
    border-radius: var(--border-radius);
    font-size: 16px;
    flex: 1;
    box-sizing: border-box;
    background-color: var(--card-bg);
    color: var(--text-color);
    margin-right: 10px;
}

.chat-window button {
    padding: 10px;
    background-color: var(--primary-color);
    color: #fff;
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s;
    width: 80px;
}

.chat-window button:hover {
    background-color: #3b7bce;
}

/* Common styles for emojis */
.emoji-list span, .emoji-picker span {
    font-size: 24px; /* Emoji size */
    cursor: pointer; /* Pointer cursor on hover */
    transition: transform 0.3s ease; /* Smooth scaling effect */
    display: inline-block; /* Ensure scaling effect is applied */
    margin: 4px; /* Add margin for spacing between emojis */
}

/* Pop-up effect on hover for both emoji list and picker */
.emoji-list span:hover, .emoji-picker span:hover {
    transform: scale(1.2); /* Scale up on hover */
}

/* Emoji dropdown styling */
.emoji-dropdown {
    background-color: var(--primary-color); /* Background color */
    border: none !important; /* Remove any border */
    padding: 0 !important; /* No padding */
    cursor: pointer !important; /* Pointer cursor */
    border-radius: 50% !important; /* Round shape */
    width: 40px !important; /* Fixed width */
    height: 40px !important; /* Fixed height */
    display: flex !important; /* Flexbox layout */
    align-items: center !important; /* Center vertically */
    justify-content: center !important; /* Center horizontally */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; /* Optional shadow */
    transition: background-color 0.3s, box-shadow 0.3s !important; /* Smooth transitions */
}

.emoji-dropdown:hover {
    background-color: #3b7bce; /* Change color on hover */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3) !important; /* Enhanced shadow on hover */
}

.emoji-dropdown svg {
    width: 24px; /* SVG size */
    height: 24px;
}

/* Emoji picker styling */
.emoji-picker {
    display: flex;
    flex-wrap: wrap;
    padding: 5px;
    background-color: var(--card-bg); /* Matches the chat input background */
    border: 1px solid var(--secondary-color);
    border-radius: 10px;
    position: absolute;
    top: 100%; /* Position below the emoji dropdown */
    left: 0;
    z-index: 100; /* Ensure it appears above other content */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Optional shadow for visibility */
    max-height: 200px; /* Adjust based on the number of emojis */
    overflow-y: auto; /* Adds scroll if needed */
}

.emoji-picker.hidden {
    display: none;
}

/* Emoji container styling */
#emoji-container {
    display: flex;
    align-items: center;
}

/* Clear emojis button styling */
.clear-emojis {
    background-color: var(--primary-color); /* Matches the emoji dropdown */
    border: none !important; /* Remove any border */
    padding: 0 !important; /* No padding */
    cursor: pointer !important; /* Pointer cursor */
    border-radius: 50% !important; /* Round shape */
    width: 40px !important; /* Fixed width */
    height: 40px !important; /* Fixed height */
    display: flex !important; /* Flexbox layout */
    align-items: center !important; /* Center vertically */
    justify-content: center !important; /* Center horizontally */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important; /* Optional shadow */
    transition: background-color 0.3s, box-shadow 0.3s !important; /* Smooth transitions */
    margin-left: 10px; /* Space between emoji dropdown and clear button */
}

.clear-emojis:hover {
    background-color: #3b7bce; /* Change color on hover */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3) !important; /* Enhanced shadow on hover */
}

.clear-emojis svg {
    width: 24px; /* SVG size to match the emoji dropdown */
    height: 24px;
}


#groupList {
    list-style: none;
    padding: 0;
    margin: 0;
}

#groupList .group-item {
    background: var(--glass-bg);
    padding: 10px;
    margin-bottom: 10px;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: background 0.3s;
    display: flex;
    justify-content: space-between; /* Ensure the group name and other elements are spaced out */
    align-items: center; /* Align items in the center vertically */
}

#groupList .group-item:hover {
    background: var(--hover-bg);
}

.group-name {
    font-weight: bold;
    /* You can add more styles here if needed */
}

.add-to-group {
    display: flex;
    align-items: center;
    gap: 10px; /* Spacing between input and button */
    margin-bottom: 20px;
}

.add-to-group input[type="text"] {
    padding: 10px;
    border: 1px solid var(--secondary-color);
    border-radius: var(--border-radius);
    width: calc(100% - 130px); /* Adjust width for proper spacing */
    box-sizing: border-box;
    font-size: 16px;
    background-color: var(--card-bg);
    color: var(--text-color);
}

.add-to-group-button {
    background-color: var(--primary-color); /* or any color */
    border: none;
    padding: 10px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 80px; /* Longer width */
    height: 40px; /* Height to keep it balanced */
    border-radius: 20px; /* Creates the squircle effect */
    transition: background-color 0.3s;
}

.add-to-group-button:hover {
    background-color: #2980b9; /* Add a hover effect */
}

.add-to-group-button svg {
    width: 64px; /* Adjusted SVG size */
    height: 64px;
    fill: #ffffff; /* Ensures the SVG color is white */
    margin: 0; /* Reset margin if needed */
    transform: translateX(0); /* Adjust the X-axis if needed */
    transform: translateY(7px); /* Adjust the X-axis if needed */

}

.group-item {
    background: var(--glass-bg);
    padding: 10px;
    margin-bottom: 10px;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: background 0.3s;
    display: flex;
    justify-content: space-between; /* Space out items in the group item */
    align-items: center; /* Align items in the center vertically */
}

.group-item .buttons {
    display: flex;
    gap: 5px; /* Space between the buttons */
}

.group-item .edit-button,
.group-item .delete-button {
    padding: 5px 10px;
    color: #fff;
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.3s;
}

.group-item .edit-button {
    background-color: var(--primary-color); /* Background color */
}

.group-item .edit-button:hover {
    background-color: #2980b9;
}

.group-item .delete-button {
    background-color: var(--accent-color); 
}

.group-item .delete-button:hover {
    background-color: #c0392b;
}


/* Additional styles for responsiveness and better integration with the chat window */

@media (max-width: 768px) {
    .group-chats h2 {
        font-size: 20px;
    }

    .add-to-group input[type="text"] {
        width: calc(100% - 110px); /* Adjust input width for smaller screens */
    }

    .add-to-group button {
        font-size: 14px;
        padding: 8px 16px;
    }
}


.create-new {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.item {
    background-color: var(--glass-bg);
    padding: 15px;
    border-radius: var(--border-radius);
    margin-bottom: 10px;
    transition: background-color 0.3s ease, transform 0.3s ease;
    display: flex;
    justify-content: space-between;
    align-items: center;
    backdrop-filter: blur(10px);
}

.item:hover {
    background-color: var(--hover-bg);
    transform: scale(1.05);
    backdrop-filter: blur(10px);
}

.user-profile {
    display: flex;
    align-items: center;
    margin-top: auto;
    padding-top: 20px;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--primary-color);
    margin-right: 10px;
    transition: transform 0.3s ease, background-color 0.3s ease;
}

.user-avatar:hover {
    transform: scale(1.1);
    color: var(--text-color);
}

.account-button {
    background: none;
    border: none;
    color: var(--text-color);
    cursor: pointer;
    display: flex;
    align-items: center;
    padding: 0;
    transition: color 0.3s ease, transform 0.3s ease, background-color 0.3s ease;
}

.account-button:hover {
    transform: scale(1.05);
}

.account-button:focus {
    outline: none;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--accent-color); /* Initial color is accent color */
    margin-right: 10px;
    transition: transform 0.3s ease, background-color 0.3s ease;
}

.user-avatar:hover {
    transform: scale(1.1);
}

/* Existing styles */
.sidebar-toggle {
    display: none;
    position: fixed;
    top: 20px;
    right: 20px;
    background-color: var(--hover-bg);
    color: var(--text-color);
    border: none;
    padding: 10px;
    border-radius: 5px;
    cursor: pointer;
    z-index: 1000;
}

.sidebar-toggle svg {
    width: 24px;
    height: 24px;
}

/* Mobile styles */
@media (max-width: 768px) {
    .sidebar {
        display: none;
        position: fixed;
        left: 0;
        top: 0;
        height: 100%;
        width: 250px; /* Adjust width as needed */
        background-color: #333; /* Solid color, adjust as needed */
        color: var(--text-color);
        padding: 20px; /* Adjust padding as needed */
        z-index: 1000;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2); /* Optional shadow for better depth */
        border-radius: 0; /* No rounded corners */
    }
    .sidebar.active {
        display: flex;
    }
    .sidebar-toggle {
        display: block;
    }
    .main-content {
        padding-left: 20px;
        margin-left: 0;
    }
}

/* Animation for SVG */
@keyframes rotateIcon {
    0% {
        transform: rotate(0deg);
    }
    50% {
        transform: rotate(180deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

.theme-icon {
    display: inline-block;
    transition: transform 0.5s;
}

.theme-icon svg {
    transition: fill 0.5s;
}

.theme-icon.active svg {
    animation: rotateIcon 0.5s;
}


/* General Modal Styles */
.modal2 {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto; /* Enable scroll if needed */
    background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity */
}

/* Specific Modal Content Styles */
.modal2 .modal-content {
    background-color: #333; /* Set modal background to gray */
    margin: 15% auto; /* 15% from the top and centered */
    padding: 20px;
    width: 80%; /* Could be more or less, depending on screen size */
    border-radius: var(--border-radius);
    position: relative; /* Position relative to align buttons */
}

/* Close Button */
.modal2 .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}

.modal2 .close:hover,
.modal2 .close:focus {
    color: white;
    text-decoration: none;
}

/* View Members Button */
.view-members-button,
.remove-member-button {
    background-color: var(--primary-color); /* Background color */
    border: none;
    padding: 5px;
    border-radius: 50%;
    cursor: pointer;
    transition: background-color 0.3s;
}

.view-members-button:hover,
.remove-member-button:hover {
    background-color: #2980b9;
}

/* Member Item Styles */
.member-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 5px 0;
    border-bottom: 1px solid #ccc;
}

/* SVG Icons for Modal Buttons */
.modal2 .modal-content .view-members-button svg,
.modal2 .modal-content .remove-member-button svg,
.modal2 .modal-content .close svg {
    width: 24px;
    height: 24px;
}

/* Ensure no interference with other modals */
#viewMembersModal .modal-content {
    /* If additional specific styles needed for this modal, add them here */
}

/* Style for the modal buttons */
.modal2 .modal-btn {
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 5px;
    color: #fff;
    display: flex;
    align-items: center;
    position: relative; /* Changed from absolute to relative for better alignment */
}

/* Ensure SVG icons are appropriately sized */
.modal2 .modal-btn svg {
    width: 24px;
    height: 24px;
}

/* Modal Styles */
.modal {
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 1000;
}

.modal-content {
    background: #333;
    color: #fff;
    padding: 20px;
    border-radius: var(--border-radius);
    width: 90%;
    max-width: 600px;
    position: relative;
}

/* Center the title text and ensure proper alignment */
.modal-header {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 15px;
    position: relative; /* Position relative to align the buttons */
}

/* Center title text */
.modal-title {
    font-size: 18px;
    font-weight: bold;
    margin: 0; /* Remove default margin */
}

/* Style for the modal buttons */
.modal-btn {
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 5px;
    color: #fff;
    display: flex;
    align-items: center;
    position: absolute; /* Absolute positioning for proper alignment */
}

#disableModal {
    left: 10px; /* Position disable button on the left */
}

#closeModal {
    right: 10px; /* Position close button on the right */
}

/* Ensure SVG icons are appropriately sized */
.modal-btn svg {
    width: 24px;
    height: 24px;
}

/* Style for the bug list */
.bug-list {
    list-style: disc; /* Restore default bullet points */
    padding-left: 20px; /* Default padding for bullets */
    margin: 0; /* Remove default margin */
    font-weight: bold; /* Make the text bold */
}

.bug-list li {
    margin-bottom: 10px;
    position: relative; /* For positioning the custom bullet */
}

/* Style for the fix item */
.bug-list .fix-item {
    color: green; /* Color the text in green */
    padding-left: 40px; /* Add space for the larger SVG bullet */
    position: relative; /* Ensure proper positioning */
}

/* Add SVG before the fix item */
.bug-list .fix-item::before {
    content: ""; /* Empty content for the pseudo-element */
    position: absolute;
    left: 0; /* Align to the left edge */
    top: 50%; /* Center vertically */
    transform: translateY(-50%); /* Adjust for centering */
    width: 24px; /* Increased width of the SVG */
    height: 24px; /* Increased height of the SVG */
    background: url('data:image/svg+xml,%3Csvg%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20id%3D%22SVGRepo_bgCarrier%22%20stroke-width%3D%220%22%3E%3C%2Fg%3E%3Cg%20id%3D%22SVGRepo_tracerCarrier%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3C%2Fg%3E%3Cg%20id%3D%22SVGRepo_iconCarrier%22%3E%20%3Crect%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22white%22%3E%3C%2Frect%3E%20%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M9.55879%203.6972C10.7552%202.02216%2013.2447%202.02216%2014.4412%203.6972L14.6317%203.96387C14.8422%204.25867%2015.1958%204.41652%2015.5558%204.37652L16.4048%204.28218C18.3156%204.06988%2019.9301%205.68439%2019.7178%207.59513L19.6235%208.44415C19.5835%208.8042%2019.7413%209.15774%2020.0361%209.36831L20.3028%209.55879C21.9778%2010.7552%2021.9778%2013.2447%2020.3028%2014.4412L20.0361%2014.6317C19.7413%2014.8422%2019.5835%2015.1958%2019.6235%2015.5558L19.7178%2016.4048C19.9301%2018.3156%2018.3156%2019.9301%2016.4048%2019.7178L15.5558%2019.6235C15.1958%2019.5835%2014.8422%2019.7413%2014.6317%2020.0361L14.4412%2020.3028C13.2447%2021.9778%2010.7553%2021.9778%209.55879%2020.3028L9.36831%2020.0361C9.15774%2019.7413%208.8042%2019.5835%208.44414%2019.6235L7.59513%2019.7178C5.68439%2019.9301%204.06988%2018.3156%204.28218%2016.4048L4.37652%2015.5558C4.41652%2015.1958%204.25867%2014.8422%203.96387%2014.6317L3.6972%2014.4412C2.02216%2013.2447%202.02216%2010.7553%203.6972%209.55879L3.96387%209.36831C4.25867%209.15774%204.41652%208.8042%204.37652%208.44414L4.28218%207.59513C4.06988%205.68439%205.68439%204.06988%207.59513%204.28218L8.44415%204.37652C8.8042%204.41652%209.15774%204.25867%209.36831%203.96387L9.55879%203.6972ZM15.7071%209.29289C16.0976%209.68342%2016.0976%2010.3166%2015.7071%2010.7071L11.8882%2014.526C11.3977%2015.0166%2010.6023%2015.0166%2010.1118%2014.526L8.29289%2012.7071C7.90237%2012.3166%207.90237%2011.6834%208.29289%2011.2929C8.68342%2010.9024%209.31658%2010.9024%209.70711%2011.2929L11%2012.5858L14.2929%209.29289C14.6834%208.90237%2015.3166%208.90237%2015.7071%209.29289Z%22%20fill%3D%22%23000000%22%3E%3C%2Fpath%3E%20%3C%2Fg%3E%3C%2Fsvg%3E') no-repeat center center; /* SVG as background */
    background-size: contain; /* Ensure the SVG scales properly */
    background-color: transparent; /* Remove background color */
}




.view-friend-info-button {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--primary-color); /* Background color */
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    border: none;
    padding: 0;
    margin-left: 10px;
}

.view-friend-info-button svg {
    width: 24px;
    height: 24px;
}

.view-friend-info-button:hover {
    background-color: #3b7bce; /* Change to hover color */
}

/* General Modal Styles */
.modal3 {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto; /* Enable scroll if needed */
    background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity */
}

/* Specific Modal Content Styles */
.modal3 .modal-content {
    background-color: #333; /* Set modal background to gray */
    margin: 15% auto; /* 15% from the top and centered */
    padding: 20px;
    width: 80%; /* Could be more or less, depending on screen size */
    border-radius: var(--border-radius);
    position: relative; /* Position relative to align buttons */
}

/* Close Button */
.modal3 .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}

.modal3 .close:hover,
.modal3 .close:focus {
    color: white;
    text-decoration: none;
}

/* Input and Button Styling */
.modal3 #editFriendName {
    width: calc(100% - 20px);
    padding: 10px;
    margin: 10px 0;
    border-radius: var(--border-radius);
    border: 1px solid #ccc;
    background-color: #444;
    color: #fff;
}

.modal3 #saveFriendName {
    background-color: var(--accent-color);
    border: none;
    padding: 10px 20px;
    border-radius: var(--border-radius);
    cursor: pointer;
    color: #fff;
    transition: background-color 0.3s;
}

.modal3 #saveFriendName:hover {
    background-color: #2980b9;
}

/* Ensure SVG icons are appropriately sized */
.modal3 .close svg {
    width: 24px;
    height: 24px;
}

.friends-list h2 {
    display: flex;
    align-items: center;
}

#refreshButton, #refreshPinnedButton {
    background-color: transparent;
    border: none;
    padding: 0;
    margin-left: 10px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s ease-in-out;
}

#refreshButton svg, #refreshPinnedButton svg {
    width: 24px;
    height: 24px;
}

#refreshButton:active, #refreshPinnedButton:active {
    transform: scale(1.2);
}

#refreshButton:active svg path, #refreshPinnedButton:active svg path {
    stroke: #ffffff;
}

#refreshButton:hover, #refreshPinnedButton:hover {
    background-color: transparent;
}

#hideButton {
    background-color: transparent;
    border: none;
    padding: 0;
    margin-left: 1px; /* Reduced to make it closer */
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s ease-in-out;
    color: #ff0000;
}

#hideButton svg {
    width: 42px;  /* Reduced size for better alignment */
    height: 42px; /* Reduced size for better alignment */
}

#hideButton:active {
    transform: scale(1.2);
}

#hideButton:active svg path {
    stroke: #ff0000;
}

#hideButton:hover {
    background-color: transparent;
}

        
.message-options {
    display: flex;
    justify-content: space-around;
    margin-top: 5px;
}

.reaction-button, .remove-reaction-button, .reply-option {
    background-color: var(--primary-color);
    color: #fff;
    border: none;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    font-size: 16px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0 5px;
    cursor: pointer;
}

.reaction-button:hover, .remove-reaction-button:hover, .reply-option:hover {
    background-color: var(--accent-color);
}


.reaction-current-user {
    background-color: var(--accent-color); /* Accent color */
}


/* The Modal (background) */
.modal4 {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto; /* Enable scroll if needed */
    background-color: var(--card-bg); /* Black with opacity */
}

/* The Modal (background) */
.modal4 {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto; /* Enable scroll if needed */
    background-color: var(--glass-bg); /* Black with opacity */
}

/* Modal Content */
.modal4-content {
    background-color: var(--card-bg);
    margin: 15% auto; /* 15% from the top and centered */
    padding: 20px;
    border: none;
    border-radius: 20px; /* Rounded corners for the modal */
    width: 40%; /* Could be more or less, depending on screen size */
    position: relative;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5); /* Subtle shadow for depth */
}

/* Remove Close Button */
.modal4-close {
    display: none;
}

/* Text Area and Button */
#replyInput {
    width: 100%;
    height: 100px;
    margin-top: 10px;
    padding: 10px;
    font-size: 14px;
    border-radius: 10px;
    border: 1px solid #ccc;
}

/* Send Reply Button as a Squricle */
#sendReplyButton {
    background-color: var(--primary-color);
    color: white;
    padding: 15px;
    border: none;
    border-radius: 20px; /* Rounded corners (squricle) */
    cursor: pointer;
    margin-top: 10px;
    width: 100%;
    font-size: 16px;
}

#sendReplyButton:hover {
    background-color: #3b7bce;
}

.scrollable-content {
    overflow: auto; /* Ensure content is still scrollable */
}

/* WebKit Browsers */
.scrollable-content::-webkit-scrollbar {
    display: none; /* Hide scrollbar */
}

/* Firefox */
.scrollable-content {
    scrollbar-width: none; /* Hide scrollbar in Firefox 64+ */
    -ms-overflow-style: none; /* Hide scrollbar in IE 10+ and Edge */
}

/* Internet Explorer and Edge */
.scrollable-content {
    -ms-overflow-style: none; /* Hide scrollbar in IE 10+ and Edge */
}

.friend-item {
    display: flex;
    align-items: center;
}

.friend-item .status-icon {
    margin-right: 8px; /* Space between the icon and the display name */
    width: 24px;
    height: 24px;
}

.friend-item .status-icon.online {
    fill: green;
}

.friend-item .status-icon.offline {
    fill: red;
}

.friend-name {
    font-size: 16px;
}

      
    </style>
</head>
<body>
    <button class="sidebar-toggle">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 12H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M3 6H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </button>
    <div class="container">
        <div class="sidebar">
            <div class="logo" onclick="window.location.href='index.html'">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
  <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
  <g id="SVGRepo_iconCarrier"> 
    <path d="M12.37 8.87988H17.62" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
    <path d="M6.38 8.87988L7.13 9.62988L9.38 7.37988" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
    <path d="M12.37 15.8799H17.62" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
    <path d="M6.38 15.8799L7.13 16.6299L9.38 14.3799" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
    <path d="M9 22H15C20 22 22 20 22 15V9C22 4 20 2 15 2H9C4 2 2 4 2 9V15C2 20 4 22 9 22Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> 
  </g>
</svg>
                TaskMaster AI
            </div>
             <div class="menu-item" onclick="window.location.href='dashboard.html'">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M9 22V12H15V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Dashboard
            </div>
             <div class="menu-item" onclick="window.location.href='account.html'">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9C13.6569 9 15 10.3431 15 12Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M12.9046 3.06005C12.6988 3 12.4659 3 12 3C11.5341 3 11.3012 3 11.0954 3.06005C10.7942 3.14794 10.5281 3.32808 10.3346 3.57511C10.2024 3.74388 10.1159 3.96016 9.94291 4.39272C9.69419 5.01452 9.00393 5.33471 8.36857 5.123L7.79779 4.93281C7.3929 4.79785 7.19045 4.73036 6.99196 4.7188C6.70039 4.70181 6.4102 4.77032 6.15701 4.9159C5.98465 5.01501 5.83376 5.16591 5.53197 5.4677C5.21122 5.78845 5.05084 5.94882 4.94896 6.13189C4.79927 6.40084 4.73595 6.70934 4.76759 7.01551C4.78912 7.2239 4.87335 7.43449 5.04182 7.85566C5.30565 8.51523 5.05184 9.26878 4.44272 9.63433L4.16521 9.80087C3.74031 10.0558 3.52786 10.1833 3.37354 10.3588C3.23698 10.5141 3.13401 10.696 3.07109 10.893C3 11.1156 3 11.3658 3 11.8663C3 12.4589 3 12.7551 3.09462 13.0088C3.17823 13.2329 3.31422 13.4337 3.49124 13.5946C3.69158 13.7766 3.96395 13.8856 4.50866 14.1035C5.06534 14.3261 5.35196 14.9441 5.16236 15.5129L4.94721 16.1584C4.79819 16.6054 4.72367 16.829 4.7169 17.0486C4.70875 17.3127 4.77049 17.5742 4.89587 17.8067C5.00015 18.0002 5.16678 18.1668 5.5 18.5C5.83323 18.8332 5.99985 18.9998 6.19325 19.1041C6.4258 19.2295 6.68733 19.2913 6.9514 19.2831C7.17102 19.2763 7.39456 19.2018 7.84164 19.0528L8.36862 18.8771C9.00393 18.6654 9.6942 18.9855 9.94291 19.6073C10.1159 20.0398 10.2024 20.2561 10.3346 20.4249C10.5281 20.6719 10.7942 20.8521 11.0954 20.94C11.3012 21 11.5341 21 12 21C12.4659 21 12.6988 21 12.9046 20.94C13.2058 20.8521 13.4719 20.6719 13.6654 20.4249C13.7976 20.2561 13.8841 20.0398 14.0571 19.6073C14.3058 18.9855 14.9961 18.6654 15.6313 18.8773L16.1579 19.0529C16.605 19.2019 16.8286 19.2764 17.0482 19.2832C17.3123 19.2913 17.5738 19.2296 17.8063 19.1042C17.9997 18.9999 18.1664 18.8333 18.4996 18.5001C18.8328 18.1669 18.9994 18.0002 19.1037 17.8068C19.2291 17.5743 19.2908 17.3127 19.2827 17.0487C19.2759 16.8291 19.2014 16.6055 19.0524 16.1584L18.8374 15.5134C18.6477 14.9444 18.9344 14.3262 19.4913 14.1035C20.036 13.8856 20.3084 13.7766 20.5088 13.5946C20.6858 13.4337 20.8218 13.2329 20.9054 13.0088C21 12.7551 21 12.4589 21 11.8663C21 11.3658 21 11.1156 20.9289 10.893C20.866 10.696 20.763 10.5141 20.6265 10.3588C20.4721 10.1833 20.2597 10.0558 19.8348 9.80087L19.5569 9.63416C18.9478 9.26867 18.6939 8.51514 18.9578 7.85558C19.1262 7.43443 19.2105 7.22383 19.232 7.01543C19.2636 6.70926 19.2003 6.40077 19.0506 6.13181C18.9487 5.94875 18.7884 5.78837 18.4676 5.46762C18.1658 5.16584 18.0149 5.01494 17.8426 4.91583C17.5894 4.77024 17.2992 4.70174 17.0076 4.71872C16.8091 4.73029 16.6067 4.79777 16.2018 4.93273L15.6314 5.12287C14.9961 5.33464 14.3058 5.0145 14.0571 4.39272C13.8841 3.96016 13.7976 3.74388 13.6654 3.57511C13.4719 3.32808 13.2058 3.14794 12.9046 3.06005Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                Settings
            </div>
            <div class="menu-item toggle-night-mode" onclick="toggleNightMode()">
                <div class="theme-icon">
                    <svg id="theme-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                </div>
                Theme
            </div>
             <div class="menu-item" onclick="window.location.href='notes.html'">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M10 12H14M12 10V14M19.9592 15H16.6C16.0399 15 15.7599 15 15.546 15.109C15.3578 15.2049 15.2049 15.3578 15.109 15.546C15 15.7599 15 16.0399 15 16.6V19.9592M20 14.1031V7.2C20 6.07989 20 5.51984 19.782 5.09202C19.5903 4.71569 19.2843 4.40973 18.908 4.21799C18.4802 4 17.9201 4 16.8 4H7.2C6.0799 4 5.51984 4 5.09202 4.21799C4.71569 4.40973 4.40973 4.71569 4.21799 5.09202C4 5.51984 4 6.0799 4 7.2V16.8C4 17.9201 4 18.4802 4.21799 18.908C4.40973 19.2843 4.71569 19.5903 5.09202 19.782C5.51984 20 6.0799 20 7.2 20H14.1031C14.5923 20 14.8369 20 15.067 19.9447C15.2711 19.8957 15.4662 19.8149 15.6451 19.7053C15.847 19.5816 16.0199 19.4086 16.3658 19.0627L19.0627 16.3658C19.4086 16.0199 19.5816 15.847 19.7053 15.6451C19.8149 15.4662 19.8957 15.2711 19.9447 15.067C20 14.8369 20 14.5923 20 14.1031Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                Notes
            </div>
            <div class="menu-item" onclick="window.location.href='calendar.html'">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M3 9H21M7 3V5M17 3V5M6 12H8M11 12H13M16 12H18M6 15H8M11 15H13M16 15H18M6 18H8M11 18H13M16 18H18M6.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4802 21 18.9201 21 17.8V8.2C21 7.07989 21 6.51984 20.782 6.09202C20.5903 5.71569 20.2843 5.40973 19.908 5.21799C19.4802 5 18.9201 5 17.8 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V17.8C3 18.9201 3 19.4802 3.21799 19.908C3.40973 20.2843 3.71569 20.5903 4.09202 20.782C4.51984 21 5.07989 21 6.2 21Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round"></path> </g></svg>
                Calendar
            </div>
            <div class="menu-item" onclick="window.location.href='academics.html'">
                <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" stroke-width="4.672" stroke="#ffffff" fill="none"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><circle cx="29.22" cy="16.28" r="11.14"></circle><path d="M41.32,35.69c-2.69-1.95-8.34-3.25-12.1-3.25h0A22.55,22.55,0,0,0,6.67,55h29.9"></path><circle cx="45.38" cy="46.92" r="11.94"></circle><line x1="45.98" y1="39.8" x2="45.98" y2="53.8"></line><line x1="38.98" y1="46.8" x2="52.98" y2="46.8"></line></g></svg>
                Friends
            </div>
            <div class="menu-item" onclick="window.location.href='features.html'">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                  </svg>
                Distraction Control
            </div>
            <div class="menu-item" onclick="window.location.href='workschedule.html'">
    <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" fill="#ffffff" stroke="none">
        <g id="SVGRepo_bgCarrier" stroke-width="0" fill="none"></g>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
        <g id="SVGRepo_iconCarrier" fill="#ffffff">
            <title>ai</title>
            <g id="Layer_2" data-name="Layer 2">
                <g id="invisible_box" data-name="invisible box">
                    <rect width="48" height="48" fill="none"></rect>
                </g>
                <g id="Q3_icons" data-name="Q3 icons">
                    <g>
                        <path d="M45.6,18.7,41,14.9V7.5a1,1,0,0,0-.6-.9L30.5,2.1h-.4l-.6.2L24,5.9,18.5,2.2,17.9,2h-.4L7.6,6.6a1,1,0,0,0-.6.9v7.4L2.4,18.7a.8.8,0,0,0-.4.8v9H2a.8.8,0,0,0,.4.8L7,33.1v7.4a1,1,0,0,0,.6.9l9.9,4.5h.4l.6-.2L24,42.1l5.5,3.7.6.2h.4l9.9-4.5a1,1,0,0,0,.6-.9V33.1l4.6-3.8a.8.8,0,0,0,.4-.7V19.4h0A.8.8,0,0,0,45.6,18.7Zm-5.1,6.8H42v1.6l-3.5,2.8-.4.3-.4-.2a1.4,1.4,0,0,0-2,.7,1.5,1.5,0,0,0,.6,2l.7.3h0v5.4l-6.6,3.1-4.2-2.8-.7-.5V25.5H27a1.5,1.5,0,0,0,0-3H25.5V9.7l.7-.5,4.2-2.8L37,9.5v5.4h0l-.7.3a1.5,1.5,0,0,0-.6,2,1.4,1.4,0,0,0,1.3.9l.7-.2.4-.2.4.3L42,20.9v1.6H40.5a1.5,1.5,0,0,0,0,3ZM21,25.5h1.5V38.3l-.7.5-4.2,2.8L11,38.5V33.1h0l.7-.3a1.5,1.5,0,0,0,.6-2,1.4,1.4,0,0,0-2-.7l-.4.2-.4-.3L6,27.1V25.5H7.5a1.5,1.5,0,0,0,0-3H6V20.9l3.5-2.8.4-.3.4.2.7.2a1.4,1.4,0,0,0,1.3-.9,1.5,1.5,0,0,0-.6-2L11,15h0V9.5l6.6-3.1,4.2,2.8.7.5V22.5H21a1.5,1.5,0,0,0,0,3Z"></path>
                        <path d="M13.9,9.9a1.8,1.8,0,0,0,0,2.2l2.6,2.5v2.8l-4,4v5.2l4,4v2.8l-2.6,2.5a1.8,1.8,0,0,0,0,2.2,1.5,1.5,0,0,0,1.1.4,1.5,1.5,0,0,0,1.1-.4l3.4-3.5V29.4l-4-4V22.6l4-4V13.4L16.1,9.9A1.8,1.8,0,0,0,13.9,9.9Z"></path>
                        <path d="M31.5,14.6l2.6-2.5a1.8,1.8,0,0,0,0-2.2,1.8,1.8,0,0,0-2.2,0l-3.4,3.5v5.2l4,4v2.8l-4,4v5.2l3.4,3.5a1.7,1.7,0,0,0,2.2,0,1.8,1.8,0,0,0,0-2.2l-2.6-2.5V30.6l4-4V21.4l-4-4Z"></path>
                    </g>
                </g>
            </g>
        </g>
    </svg>
    AI Chat Bot
</div>
            <div class="menu-item" onclick="window.location.href='metrics.html'">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/>
                    <path d="M12 18c3.314 0 6-2.686 6-6s-2.686-6-6-6-6 2.686-6 6 2.686 6 6 6z"/>
                    <path d="M12 14c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z"/>
                  </svg>
                Focus Metrics
            </div>
            <button class="upgrade-btn" onclick="window.location.href='pricing.html'">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M2 8l10 14L22 8l-4-6H6L2 8z"/>
                    <path d="M2 8h20"/>
                    <path d="M12 2v20"/>
                  </svg>
                Upgrade to Premium
            </button>
<div class="user-profile" onclick="window.location.href='account.html'">
    <button class="account-button">
        <div class="user-avatar" id="smallProfilePictureContainer">
            <!-- SVG will be replaced with the profile picture -->
            <svg id="defaultAvatar" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 4C14.21 4 16 5.79 16 8C16 10.21 14.21 12 12 12C9.79 12 8 10.21 8 8C8 5.79 9.79 4 12 4ZM12 20C9.33 20 6.34 18.87 4.63 16.74C5.91 15.43 8.39 14.5 12 14.5C15.61 14.5 18.09 15.43 19.37 16.74C17.66 18.87 14.67 20 12 20Z" fill="currentColor"/>
            </svg>
        </div>
                <div id="username">User Name</div>
                <div class="menu-dots">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12C11 12.5523 11.4477 13 12 13Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M19 13C19.5523 13 20 12.5523 20 12C20 11.4477 19.5523 11 19 11C18.4477 11 18 11.4477 18 12C18 12.5523 18.4477 13 19 13Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M5 13C5.55228 13 6 12.5523 6 12C6 11.4477 5.55228 11 5 11C4.44772 11 4 11.4477 4 12C4 12.5523 4.44772 13 5 13Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </div>
        </div>  
<div class="main-content">
    <div class="dashboard-header">
        <h1>
            Friends
            <!-- SVG Icon -->
            <svg xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve" style="width: 1em; height: 1em; vertical-align: middle; margin-left: 5px;">
                <path d="M68,69.4H32c2.2,2.1,3.6,4.8,4.5,7h3.9l1.6,16.1c0,1.7,1.3,3.2,3.1,3.4c1.6,0.2,3.1,0.3,4.8,0.3c1.6,0,3.2-0.1,4.8-0.3     c1.7-0.2,3-1.7,3.1-3.4l1.4-16.1h4.2C64.4,74.2,65.8,71.5,68,69.4z" fill="#FFFFFF"/>
                <path d="M41.8,59.3c0,4.5,3.7,8.2,8.2,8.2c4.5,0,8.2-3.7,8.2-8.2c0-4.5-3.7-8.2-8.2-8.2C45.5,51,41.8,54.7,41.8,59.3z" fill="#FFFFFF"/>
                <path d="M35.1,80.9c-0.1-0.4-0.3-0.8-0.5-1.3c-1.3-3.6-3.7-10.2-9.9-10.2h-9.4c-6.2,0-8.6,6.6-9.9,10.2c-0.2,0.5-0.3,0.9-0.5,1.3     c-0.8,1.9-1.7,5.5-2.3,8.4c-0.4,1.7,0.5,3.4,2.1,4c0,0,0.1,0,0.1,0c2,0.8,4.2-0.4,4.7-2.5c0.6-2.9,1.4-6,1.9-7.3     c0.2-0.4,0.4-0.9,0.6-1.5l0.2,10.4c0,1.7,1.3,3.2,3.1,3.4c1.6,0.2,3.2,0.3,4.8,0.3c1.6,0,3.2-0.1,4.8-0.3c1.7-0.2,3-1.7,3.1-3.4     l0.2-10.4c0.2,0.5,0.4,1.1,0.6,1.5c0.5,1.3,1.3,4.4,1.9,7.3c0.5,2.1,2.7,3.3,4.7,2.5c0,0,0,0,0.1,0c1.6-0.6,2.4-2.3,2.1-4     C36.8,86.4,35.9,82.8,35.1,80.9z" fill="#FFFFFF"/>
                <path d="M20,67.5c4.5,0,8.2-3.7,8.2-8.2c0-4.5-3.7-8.2-8.2-8.2c-4.5,0-8.2,3.7-8.2,8.2C11.8,63.8,15.5,67.5,20,67.5z" fill="#FFFFFF"/>
                <path d="M97.4,89.3c-0.6-2.9-1.5-6.5-2.3-8.4c-0.1-0.4-0.3-0.8-0.5-1.3c-1.3-3.6-3.7-10.2-9.9-10.2h-0.3h-8.9h-0.3     c-6.2,0-8.6,6.6-9.9,10.2c-0.2,0.5-0.3,0.9-0.5,1.3c-0.8,1.9-1.7,5.5-2.3,8.4c-0.4,1.7,0.5,3.4,2.1,4c0,0,0.1,0,0.1,0     c2,0.8,4.2-0.4,4.7-2.5c0.6-2.9,1.4-6,1.9-7.3c0.2-0.4,0.4-0.9,0.6-1.5l0.2,10.4c0,1.7,1.3,3.2,3.1,3.4c1.6,0.2,3.2,0.3,4.8,0.3     c1.6,0,3.2-0.1,4.8-0.3c1.7-0.2,3-1.7,3.1-3.4l0.2-10.4c0.2,0.5,0.4,1.1,0.6,1.5c0.5,1.3,1.3,4.4,1.9,7.3     c0.5,2.1,2.7,3.3,4.7,2.5c0,0,0,0,0.1,0C96.9,92.7,97.8,91,97.4,89.3z" fill="#FFFFFF"/>
                <path d="M80,51c-4.5,0-8.2,3.7-8.2,8.2c0,4.5,3.7,8.2,8.2,8.2c4.5,0,8.2-3.7,8.2-8.2C88.2,54.7,84.5,51,80,51z" fill="#FFFFFF"/>
                <path d="M20.2,37.3H24v7.9c0,1.4,1.6,2,2.6,1.1l9-9h8.8l3.9,8.9c0.6,1.5,2.7,1.5,3.4,0l3.9-8.9h8.8l9,9c1,1,2.6,0.3,2.6-1.1v-7.9     h3.8c3.7,0,6.7-3,6.7-6.7v-20c0-3.7-3-6.7-6.7-6.7H20.2c-3.7,0-6.7,3-6.7,6.7v20C13.5,34.3,16.5,37.3,20.2,37.3z M66.3,15.7     c2.7,0,4.8,2.2,4.8,4.8c0,2.7-2.2,4.8-4.8,4.8c-2.7,0-4.8-2.2-4.8-4.8C61.4,17.9,63.6,15.7,66.3,15.7z M50,15.7     c2.7,0,4.8,2.2,4.8,4.8c0,2.7-2.2,4.8-4.8,4.8c-2.7,0-4.8-2.2-4.8-4.8C45.2,17.9,47.3,15.7,50,15.7z M33.7,15.7     c2.7,0,4.8,2.2,4.8,4.8c0,2.7-2.2,4.8-4.8,4.8c-2.7,0-4.8-2.2-4.8-4.8C28.9,17.9,31.1,15.7,33.7,15.7z" fill="#FFFFFF"/>
            </svg>
        </h1>
    </div>
    <div class="add-friend">
        <input type="text" id="friendEmail" placeholder="Enter friend's email">
        <button onclick="addFriend()">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#ffffff">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                    <defs>
                        <style>
                            .a, .b { fill: none; stroke: #ffffff; stroke-linecap: round; stroke-width: 1.5px; }
                            .a { stroke-linejoin: round; }
                            .b { stroke-linejoin: bevel; }
                        </style>
                    </defs>
                    <path class="a" d="M3,21.016l.78984-2.87249C5.0964,13.3918,8.5482,10.984,12,10.984"></path>
                    <circle class="b" cx="12" cy="5.98404" r="5"></circle>
                    <circle class="a" cx="17" cy="18" r="5"></circle>
                    <line class="a" x1="15" x2="19" y1="18" y2="18"></line>
                    <line class="a" x1="17" x2="17" y1="16" y2="20"></line>
                </g>
            </svg>
        </button>
    </div>
<div class="friends-list">
    <h2>
        Pinned Friends
        <button id="refreshPinnedButton">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none">
                <path d="M4.06189 13C4.02104 12.6724 4 12.3387 4 12C4 7.58172 7.58172 4 12 4C14.5006 4 16.7332 5.14727 18.2002 6.94416M19.9381 11C19.979 11.3276 20 11.6613 20 12C20 16.4183 16.4183 20 12 20C9.61061 20 7.46589 18.9525 6 17.2916M9 17H6V17.2916M18.2002 4V6.94416M18.2002 6.94416V6.99993L15.2002 7M6 20V17.2916" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </h2>
    <div id="pinnedFriends">
        <!-- Pinned friends will be dynamically added here -->
    </div>

<h2>
    Online Friends
    <button id="refreshButton">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none">
            <path d="M4.06189 13C4.02104 12.6724 4 12.3387 4 12C4 7.58172 7.58172 4 12 4C14.5006 4 16.7332 5.14727 18.2002 6.94416M19.9381 11C19.979 11.3276 20 11.6613 20 12C20 16.4183 16.4183 20 12 20C9.61061 20 7.46589 18.9525 6 17.2916M9 17H6V17.2916M18.2002 4V6.94416M18.2002 6.94416V6.99993L15.2002 7M6 20V17.2916" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
    </button>
<button id="hideButton">
    <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" preserveAspectRatio="xMidYMid meet">
        <g id="SVGRepo_iconCarrier">
            <path fill="white" d="M13.098 8H6.902c-.751 0-1.172.754-.708 1.268L9.292 12.7c.36.399 1.055.399 1.416 0l3.098-3.433C14.27 8.754 13.849 8 13.098 8Z"></path>
        </g>
    </svg>
</button>
</h2>
<div id="onlineFriends">
    <!-- Online friends will be dynamically added here -->
</div>

</div>
<div class="group-chats">
    <h2>Manage Group Chats</h2>
    <div class="add-to-group">
        <input type="text" id="groupEmails" placeholder="Enter friends' emails, separated by commas">
        <button onclick="addToGroup()" class="add-to-group-button">
            <svg xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" viewBox="0 0 100 125" x="0px" y="0px" fill="#ffffff">
                <path d="m32.0225989,46.9052016c-2.2088058-2.3237093-5.3751412-3.7792324-8.8862264-3.7792324h-6.0199104c-6.6902396,0-12.1164621,5.2794078-12.1164621,11.7908825v2.451354c0,1.4236119,1.1873758,2.5790766,2.6492889,2.5790766h17.1723748c.2425872-5.3560101,3.0259497-10.0736411,7.2009351-13.0420807Z"/>
                <ellipse cx="20.1268654" cy="32.6188973" rx="8.6428599" ry="8.4079875"/>
                <ellipse cx="76.2191311" cy="32.6188973" rx="8.6428599" ry="8.4079875"/>
                <ellipse cx="48.1729982" cy="28.9672316" rx="12.5627508" ry="12.221391"/>
                <path d="m90.2488603,55.7175141c-2.9106565-2.8988895-6.920904-4.6923047-11.3603741-4.6923047-1.6287941,0-3.1987921.2410676-4.6806156.6879408-1.522969.4645626-2.9459186,1.1407754-4.239548,2.0051432-.3939606.2587571-.7761933.5409702-1.1407754.8349893-3.6926943,2.951841-6.0564972,7.4912527-6.0564972,12.5834794,0,.5350867.023534,1.0642899.0764465,1.581765.0764465.7702708.2057666,1.5170466.3880771,2.2520553,1.7170076,7.0561465,8.0675239,12.2835769,15.6529125,12.2835769,8.8966297,0,16.1115137-7.2090395,16.1115137-16.1173972,0-4.4630431-1.8169492-8.502669-4.7511397-11.419248Zm-5.0745373,13.5831288h-4.121956v4.1278395c0,1.1995714-.9761153,2.1638808-2.1638808,2.1638808-1.1936879,0-2.1639197-.9643094-2.1639197-2.1638808v-4.1278395h-4.1278395c-1.1936879,0-2.1579973-.9643483-2.1579973-2.1638808,0-1.1936879.9643094-2.1580362,2.1579973-2.1580362h4.1278395v-4.1278005c0-.0647185,0-.1235145.0058835-.1823105.0764465-.8820183.6820962-1.6111825,1.499474-1.8699006.2116501-.0646795.4292227-.1058251.6585622-.1058251,1.1230859,0,2.0639003.8643678,2.1521138,1.9757257.011767.058796.011767.1175921.011767.1823105v4.1278005h4.121956c1.1936489,0,2.1638808.9643483,2.1638808,2.1580362,0,1.1995324-.9702318,2.1638808-2.1638808,2.1638808Z"/>
                <path d="m69.3202026,52.4036236c1.4044418-.9384376,2.9493084-1.6725502,4.6027274-2.1768946,1.6087278-.4851744,3.3131892-.7468927,5.0815118-.7468927,4.8197545,0,9.1735048,1.9470485,12.3334502,5.0942529-.1851159-6.35188-5.541126-11.4461329-12.1100331-11.4461329h-6.0199104c-3.5110851,0-6.6774596,1.4555231-8.8862264,3.7791935,2.049172,1.4555231,3.7600234,3.3323592,4.9984804,5.4964738Z"/>
                <path d="m68.0817456,53.310111c-1.2511981-2.2790181-3.0195207-4.2515878-5.1517241-5.7645821-2.9110072-2.0747321-6.4986947-3.3004091-10.3864017-3.3004091h-8.7458017c-9.7288915,0-17.6128969,7.6733294-17.6128969,17.1341126v3.5621274c0,2.0683811,1.7236314,3.7473213,3.8494448,3.7473213h31.555075c-.0574323-.5617767-.0829924-1.1363335-.0829924-1.7172414,0-5.528385,2.5662965-10.456653,6.5752971-13.6613287Z"/>
            </svg>
        </button>
    </div>
    <div class="group-list">
        <h3>Your Groups</h3>
        <div id="groupList">
            <!-- Groups will be dynamically added here -->
        </div>
    </div>
</div>
<div class="scrollable-content">
<div class="chat-window">
    <h2>Chat with <span id="chatWith"></span></h2>
    <div id="chatMessages">
        <!-- Chat messages will be displayed here -->
    </div>
    <div class="chat-input-container">
        <input 
            type="text" 
            id="chatInput" 
            placeholder="Type a message" 
            spellcheck="true" 
            autocomplete="on" 
            aria-label="Chat message input"
        >
        <button onclick="sendMessage(currentGroupId)">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                    <path d="M11.5003 12H5.41872M5.24634 12.7972L4.24158 15.7986C3.69128 17.4424 3.41613 18.2643 3.61359 18.7704C3.78506 19.21 4.15335 19.5432 4.6078 19.6701C5.13111 19.8161 5.92151 19.4604 7.50231 18.7491L17.6367 14.1886C19.1797 13.4942 19.9512 13.1471 20.1896 12.6648C20.3968 12.2458 20.3968 11.7541 20.1896 11.3351C19.9512 10.8529 19.1797 10.5057 17.6367 9.81135L7.48483 5.24303C5.90879 4.53382 5.12078 4.17921 4.59799 4.32468C4.14397 4.45101 3.77572 4.78336 3.60365 5.22209C3.40551 5.72728 3.67772 6.54741 4.22215 8.18767L5.24829 11.2793C5.34179 11.561 5.38855 11.7019 5.407 11.8459C5.42338 11.9738 5.42321 12.1032 5.40651 12.231C5.38768 12.375 5.34057 12.5157 5.24634 12.7972Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                </g>
            </svg>
        </button>
    </div>
<div class="emoji-container">
    <div id="recentEmojis" class="emoji-list"></div>
    <div class="dropdown">
<div id="emoji-container">
<button class="emoji-dropdown" type="button" onclick="toggleEmojiPicker()">
    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
        <g id="SVGRepo_iconCarrier">
            <circle cx="12" cy="12" r="9" fill="transparent" stroke="#FFFFFF" stroke-width="2"/>
            <circle cx="8.5" cy="9.5" r="1.5" fill="#FFFFFF"/>
            <circle cx="15.5" cy="9.5" r="1.5" fill="#FFFFFF"/>
            <path d="M8.88875 13.5414C8.63822 13.0559 8.0431 12.8607 7.55301 13.1058C7.05903 13.3528 6.8588 13.9535 7.10579 14.4474C7.18825 14.6118 7.29326 14.7659 7.40334 14.9127C7.58615 15.1565 7.8621 15.4704 8.25052 15.7811C9.04005 16.4127 10.2573 17.0002 12.0002 17.0002C13.7431 17.0002 14.9604 16.4127 15.7499 15.7811C16.1383 15.4704 16.4143 15.1565 16.5971 14.9127C16.7076 14.7654 16.8081 14.6113 16.8941 14.4485C17.1387 13.961 16.9352 13.3497 16.4474 13.1058C15.9573 12.8607 15.3622 13.0559 15.1117 13.5414C15.0979 13.5663 14.9097 13.892 14.5005 14.2194C14.0401 14.5877 13.2573 15.0002 12.0002 15.0002C10.7431 15.0002 9.96038 14.5877 9.49991 14.2194C9.09071 13.892 8.90255 13.5663 8.88875 13.5414Z" fill="#FFFFFF"/>
        </g>
    </svg>
</button>
<button class="clear-emojis" type="button" onclick="clearRecentEmojis()">
    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
        <g id="SVGRepo_iconCarrier">
            <path d="M11 15L9 13M9 13L11 11M9 13H13C14.1046 13 15 13.8954 15 15V16M16 6L15.7294 5.18807C15.4671 4.40125 15.3359 4.00784 15.0927 3.71698C14.8779 3.46013 14.6021 3.26132 14.2905 3.13878C13.9376 3 13.523 3 12.6936 3H11.3064C10.477 3 10.0624 3 9.70951 3.13878C9.39792 3.26132 9.12208 3.46013 8.90729 3.71698C8.66405 4.00784 8.53292 4.40125 8.27064 5.18807L8 6M4 6H20M18 6V16.2C18 17.8802 18 18.7202 17.673 19.362C17.3854 19.9265 16.9265 20.3854 16.362 20.673C15.7202 21 14.8802 21 13.2 21H10.8C9.11984 21 8.27976 21 7.63803 20.673C7.07354 20.3854 6.6146 19.9265 6.32698 19.362C6 18.7202 6 17.8802 6 16.2V6" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </g>
    </svg>
</button>
<button class="clear-emojis" type="button" onclick="toggleEmojiPicker()">
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
<path d="M0 0 C1.57620691 -0.00418143 3.1524108 -0.00966335 4.7286092 -0.01631981 C9.0257406 -0.03068709 13.32267878 -0.02655721 17.61982036 -0.019153 C22.26752027 -0.0144019 26.91517954 -0.02694827 31.56286621 -0.03717041 C40.6547751 -0.05432575 49.74661478 -0.05520522 58.83853565 -0.04995751 C66.23179217 -0.04590853 73.6250283 -0.047368 81.01828384 -0.05270576 C82.59942752 -0.0538284 82.59942752 -0.0538284 84.21251348 -0.05497371 C86.35422158 -0.05650526 88.49592967 -0.05804361 90.63763775 -0.05958868 C110.70105169 -0.07330187 130.76442659 -0.0678843 150.82783963 -0.05640347 C169.16245406 -0.04647205 187.49696757 -0.05941231 205.83156644 -0.08333766 C224.68179778 -0.10774955 243.53198215 -0.1173314 262.38222897 -0.11068493 C272.95551115 -0.1071974 283.52871574 -0.10939401 294.10198593 -0.12693596 C303.10251623 -0.14168407 312.10291428 -0.14225929 321.10344206 -0.12486505 C325.69067711 -0.11637422 330.27767616 -0.11415841 334.86489868 -0.1295166 C339.07318046 -0.14343106 343.28102555 -0.13851462 347.4892825 -0.11927737 C349.00260851 -0.11553765 350.51597006 -0.11838007 352.0292642 -0.12888902 C365.24142944 -0.21403509 377.62964769 1.91804154 389.41043091 8.20018005 C390.07760132 8.5463739 390.74477173 8.89256775 391.43215942 9.24925232 C396.77569797 12.09501995 401.54973382 15.30264717 406.03543091 19.38768005 C406.7921106 20.06443787 407.54879028 20.74119568 408.32839966 21.4384613 C414.02356838 26.80928206 418.17243067 32.60080496 422.03543091 39.38768005 C422.72959106 40.57297302 422.72959106 40.57297302 423.43777466 41.7822113 C431.34224468 56.26973538 431.61878533 70.89205714 431.55300903 86.96580505 C431.55843943 89.20966545 431.56556721 91.45352227 431.57424927 93.69737244 C431.59237621 99.7511074 431.58545912 105.80456755 431.57273293 111.85830688 C431.56254995 118.21738889 431.57201324 124.57644861 431.57827759 130.93553162 C431.58600266 142.29328944 431.57363372 153.65090876 431.55324024 165.00863886 C431.53537269 175.27697442 431.53847788 185.54512901 431.55691528 195.8134613 C431.5783898 207.77861142 431.58625315 219.74365192 431.57446623 231.70882797 C431.5682555 238.02764474 431.56732875 244.34633727 431.58061218 250.66514587 C431.59223427 256.60793357 431.58402925 262.55038218 431.56103516 268.49313354 C431.55578191 270.66379231 431.55720319 272.83448001 431.56608582 275.00512695 C431.62245891 290.19020762 430.57427352 303.93197085 423.34793091 317.63768005 C423.00689331 318.29896912 422.66585571 318.96025818 422.31448364 319.6415863 C412.73193533 337.55858156 396.69995599 349.74213705 377.71511841 356.37986755 C365.94411995 359.60377159 354.7073527 359.63416119 342.59207153 359.5478363 C340.52950861 359.54075447 338.46694194 359.53470424 336.40437317 359.52960205 C331.98030841 359.51742635 327.55630891 359.49988336 323.13227844 359.47868347 C316.13013526 359.44708119 309.12809196 359.43934009 302.12588501 359.43699646 C300.94147937 359.43648285 299.75707374 359.43596924 298.53677702 359.43544006 C296.11594901 359.43439873 293.69512099 359.43339446 291.27429295 359.43242645 C274.98599453 359.42454212 258.69804308 359.39920348 242.40994263 359.31590271 C231.40281619 359.25979453 220.3962437 359.23919149 209.3889842 359.25910282 C203.57168226 359.26817193 197.75567994 359.25908506 191.93858337 359.20631409 C186.46814151 359.15690256 180.99964196 359.15423929 175.52909279 359.18678856 C173.52763788 359.19044921 171.52606507 359.17714385 169.52486229 359.1451664 C156.47373682 358.82859954 156.47373682 358.82859954 145.58584595 365.19285583 C144.05138671 366.90883917 142.53365437 368.63997001 141.03543091 370.38768005 C139.31460108 371.8599745 137.5675244 373.30266475 135.78543091 374.70018005 C131.28175535 378.33528961 126.89554789 382.08325352 122.53543091 385.88768005 C117.40331171 390.36320121 112.20357087 394.72775723 106.91043091 399.01268005 C103.39995452 401.91263881 99.96710364 404.89526143 96.53543091 407.88768005 C91.40728542 412.35942292 86.21328581 416.72218005 80.92214966 421.0009613 C77.34060515 423.9621571 73.84665654 427.01702194 70.34793091 430.07518005 C54.5512974 443.84680696 54.5512974 443.84680696 44.67214966 443.73143005 C38.87757806 442.97598961 35.18824526 439.80652848 31.59793091 435.38768005 C29.03813681 430.47287539 28.91172225 426.06664725 28.92190552 420.5778656 C28.92175949 419.91389267 28.92161346 419.24991974 28.92146301 418.56582642 C28.92215608 416.38531656 28.92991992 414.20489362 28.93777466 412.0243988 C28.93964099 410.50696865 28.94106388 408.9895379 28.94206238 407.47210693 C28.94587058 403.48876771 28.95568632 399.50546525 28.96676636 395.5221405 C28.97701702 391.45323687 28.98156782 387.38432727 28.98660278 383.31541443 C28.99731017 375.33948614 29.01436613 367.36358768 29.03543091 359.38768005 C27.84167847 359.4033905 26.64792603 359.41910095 25.41799927 359.43528748 C20.9170935 359.49028434 16.41621631 359.52427937 11.91506958 359.55247498 C9.98044818 359.56740484 8.04585967 359.58775614 6.11135864 359.61399841 C-15.47264411 359.89910179 -34.53388589 357.38984871 -51.96456909 343.38768005 C-53.21173706 342.38607849 -53.21173706 342.38607849 -54.48410034 341.36424255 C-68.61498215 329.33888384 -78.46488119 312.90400291 -80.96456909 294.38768005 C-81.52195841 286.95541618 -81.38580014 279.48448096 -81.36862183 272.03660583 C-81.37433265 269.7930416 -81.38129966 267.54948027 -81.38941956 265.30592346 C-81.40728742 259.24385371 -81.40619454 253.18192922 -81.40047717 247.1198411 C-81.39737602 242.0455519 -81.40348807 236.97129023 -81.40951592 231.89700496 C-81.42433878 219.23602975 -81.42076541 206.57514152 -81.40865261 193.91417287 C-81.39872409 182.95137246 -81.4116604 171.98874092 -81.4355868 161.02596654 C-81.4600451 149.7332542 -81.46917065 138.44061822 -81.46293408 127.14787281 C-81.45957409 120.8223104 -81.46191579 114.49688747 -81.4791851 108.17134476 C-81.4947243 102.22038988 -81.49062142 96.26975585 -81.47187996 90.31881332 C-81.46821333 88.14492603 -81.47124576 85.97101459 -81.48176575 83.79714966 C-81.58179932 61.40256148 -77.50765197 42.52864996 -61.96456909 25.38768005 C-61.26460815 24.60650818 -60.56464722 23.8253363 -59.84347534 23.02049255 C-43.78994198 6.0226337 -22.76203527 -0.09931919 0 0 Z M-49.96847534 39.61424255 C-62.36199363 54.76485022 -63.41271786 70.2994664 -63.36862183 89.0844574 C-63.37433066 91.28171128 -63.3812969 93.47896221 -63.38941956 95.6762085 C-63.40730962 101.62049832 -63.40619031 107.56464018 -63.40047717 113.5089488 C-63.3973792 118.48142795 -63.40348458 123.45387892 -63.40951592 128.42635405 C-63.42434696 140.83214246 -63.42075922 153.23785873 -63.40865261 165.64364584 C-63.39872388 176.3912972 -63.41165934 187.1387763 -63.4355868 197.8864011 C-63.46003183 208.95078284 -63.46917362 220.01508062 -63.46293408 231.0794884 C-63.45957126 237.27982122 -63.46193471 243.48001177 -63.4791851 249.68032455 C-63.49470567 255.51305735 -63.49064184 261.34546251 -63.47187996 267.1781826 C-63.46820819 269.31098177 -63.47126103 271.44380549 -63.48176575 273.57658195 C-63.57286215 293.61126001 -60.20358104 309.69200535 -45.86300659 324.7431488 C-32.89845308 336.57199345 -18.24173061 341.48528781 -0.81613159 341.5634613 C1.17867067 341.58665572 3.17346238 341.6107729 5.16824341 341.63572693 C8.29071179 341.67081911 11.41278932 341.70019019 14.53543091 341.71360779 C17.56454846 341.7291454 20.59254882 341.76938119 23.62136841 341.8134613 C24.54557587 341.81155289 25.46978333 341.80964447 26.42199707 341.80767822 C32.23060126 341.91641068 37.40350907 342.62694698 42.03543091 346.38768005 C45.68740494 350.87264032 46.54106187 353.94009164 46.58132935 359.6782074 C46.59166702 360.38134064 46.6020047 361.08447388 46.61265564 361.80891418 C46.64196064 364.11405248 46.6435801 366.41830807 46.64480591 368.72361755 C46.65979599 370.32931683 46.67652488 371.93500074 46.69491577 373.54066467 C46.73850903 377.7524946 46.7585704 381.96411655 46.77365112 386.1761322 C46.79325131 390.47984575 46.83521799 394.78333565 46.87527466 399.0868988 C46.95048975 407.5204339 47.00083365 415.95388096 47.03543091 424.38768005 C50.00812964 422.62864362 52.75734073 420.92614185 55.34793091 418.63768005 C55.94170532 418.1173822 56.53547974 417.59708435 57.14724731 417.0610199 C57.7703479 416.50881775 58.39344849 415.9566156 59.03543091 415.38768005 C60.37602299 414.21256885 61.71717852 413.03810017 63.05886841 411.86424255 C63.72756958 411.27804138 64.39627075 410.69184021 65.0852356 410.08787537 C67.91930066 407.61711559 70.7857114 405.18590987 73.66043091 402.76268005 C74.188302 402.31730896 74.7161731 401.87193787 75.26004028 401.41307068 C76.32068651 400.51859669 77.38155762 399.6243893 78.44265747 398.73045349 C81.14357903 396.45346567 83.83920335 394.17022212 86.53543091 391.88768005 C87.61873955 390.97098421 88.70207287 390.05431753 89.78543091 389.13768005 C90.32168091 388.68393005 90.85793091 388.23018005 91.41043091 387.76268005 C96.28543091 383.63768005 96.28543091 383.63768005 97.91018677 382.26292419 C98.99438329 381.34550208 100.07853036 380.42802154 101.16262817 379.51048279 C103.85735402 377.22989461 106.55290903 374.9503019 109.25027466 372.6728363 C110.3245557 371.76535796 111.39877435 370.85780575 112.47293091 369.95018005 C113.00442749 369.50118347 113.53592407 369.05218689 114.08352661 368.58958435 C117.54529668 365.66079467 120.98796016 362.71072645 124.42263794 359.75022888 C129.11248953 355.71227556 133.81335262 351.68830586 138.59793091 347.76268005 C139.34171997 347.15166443 140.08550903 346.5406488 140.85183716 345.91111755 C145.92152364 342.37412699 150.59324754 342.09952531 156.63552856 342.12939453 C157.50042499 342.12571883 158.36532141 342.12204312 159.25642681 342.11825603 C162.15417571 342.10827731 165.05173265 342.1124267 167.94949341 342.11643982 C170.02763574 342.11205251 172.10577632 342.10675033 174.18391418 342.1006012 C178.66044185 342.08909735 183.13692215 342.08364146 187.61346436 342.0827198 C194.69972025 342.08077856 201.78587842 342.06272044 208.87210083 342.04196167 C226.47988197 341.99277261 244.08768977 341.96192946 261.69552612 341.94065857 C275.36760144 341.92411367 289.03959323 341.90122469 302.7116127 341.85763782 C309.74708713 341.83592042 316.78240267 341.82779825 323.81790829 341.83003056 C328.20964885 341.82835642 332.60128694 341.81426183 336.99299049 341.79681778 C339.01934878 341.79124752 341.04572859 341.79070586 343.07208824 341.79575539 C365.03616278 341.84471993 381.24478288 337.86699227 397.92996216 322.66111755 C402.05141617 318.43732496 404.69699582 313.60554596 407.34793091 308.38768005 C407.68582642 307.72316833 408.02372192 307.05865662 408.37185669 306.37400818 C412.12151854 298.65065404 413.33409969 291.47802637 413.30285645 282.97125244 C413.30965311 281.59655896 413.30965311 281.59655896 413.31658709 280.19409388 C413.32919223 277.13983683 413.32761322 274.08575898 413.32595825 271.03147888 C413.33194598 268.8346687 413.33875209 266.63786062 413.34631348 264.4410553 C413.36395714 258.48422328 413.36866821 252.52744875 413.36994505 246.57059312 C413.37136829 242.84502648 413.3756412 239.11947438 413.38093948 235.39391136 C413.39848152 223.05608007 413.4077804 210.7182794 413.40627854 198.3804361 C413.40619862 197.71630073 413.40611871 197.05216535 413.40603638 196.36790466 C413.40591373 195.37047325 413.40591373 195.37047325 413.40578862 194.35289171 C413.40497637 183.58565611 413.4241015 172.81856063 413.45231311 162.05136553 C413.48110762 150.97352669 413.49448431 139.89575939 413.49312556 128.81788272 C413.49261678 122.60743508 413.49825346 116.39714602 413.51948166 110.18673134 C413.53891572 104.34174085 413.53895301 98.49705935 413.52444839 92.65205765 C413.52236553 90.51441812 413.52702981 88.37675898 413.53916931 86.23915291 C413.59933202 74.90554828 413.42102956 65.00494089 409.03543091 54.38768005 C408.67810064 53.48961041 408.32077038 52.59154078 407.95261192 51.6662569 C401.98743082 37.41167079 388.50191041 27.57487774 374.87136841 21.4306488 C366.15762518 18.2260077 357.98277593 18.09937205 348.81053162 18.12025452 C347.2537154 18.11651509 345.69690107 18.11191241 344.14008969 18.10652387 C339.87344592 18.09431446 335.60688068 18.09455191 331.34022343 18.09691262 C326.73406149 18.09732131 322.12792454 18.08627662 317.52177429 18.07679749 C308.50138819 18.06019753 299.48102823 18.05468838 290.46062813 18.05357273 C283.12635337 18.05262173 275.79208721 18.04850883 268.45781517 18.04217148 C247.65334387 18.02456139 226.84889319 18.01533218 206.04441438 18.01683243 C204.92326868 18.01691234 203.80212298 18.01699225 202.64700317 18.01707458 C201.52448484 18.01715635 200.4019665 18.01723811 199.24543246 18.01732235 C181.05788236 18.01813506 162.87041511 17.99900047 144.68288896 17.97079785 C125.99781197 17.94205289 107.31277537 17.92825846 88.62767571 17.9299854 C78.14156767 17.93064877 67.65554648 17.92517977 57.16945839 17.9036293 C48.24048777 17.88539625 39.31164336 17.88108759 30.38266215 17.89464815 C25.83013364 17.90116721 21.27784712 17.9013335 16.7253418 17.88394165 C12.55089576 17.86815865 8.37688254 17.87112751 4.20244672 17.88850991 C2.6990978 17.89156836 1.19571616 17.88799133 -0.30759414 17.87678976 C-20.41819261 17.73696582 -36.47061929 24.61662471 -49.96847534 39.61424255 Z " fill="#000000" transform="translate(80.96456909179688,33.61231994628906)"/>
<path d="M0 0 C1.29531143 -0.00619858 2.59062286 -0.01239716 3.92518616 -0.01878357 C6.65432669 -0.02913293 9.38294406 -0.02470673 12.11206055 -0.01000977 C15.58317643 0.00716744 19.05263506 -0.0163292 22.52356625 -0.05149937 C25.86997043 -0.07893437 29.21598909 -0.06872683 32.5625 -0.0625 C33.79508041 -0.07575821 35.02766083 -0.08901642 36.29759216 -0.10267639 C44.94441274 -0.01016503 51.86148692 1.505934 58.40963745 7.432724 C63.07901949 12.2830017 65.93745528 18.02875366 68.78515625 24.06640625 C69.45321289 25.443125 69.45321289 25.443125 70.13476562 26.84765625 C71.21706923 29.08208949 72.28765895 31.32132875 73.34765625 33.56640625 C74.82190063 33.5804248 74.82190063 33.5804248 76.32592773 33.59472656 C80.01094053 33.6349324 83.69514499 33.70077137 87.37963867 33.77392578 C88.96709726 33.80195966 90.55469087 33.82326073 92.14233398 33.83740234 C102.70922099 33.93712132 110.60000536 34.80832682 119.59765625 40.69140625 C126.68170714 48.09745945 127.81332339 54.79256368 127.91015625 64.81640625 C127.92481934 65.77538818 127.93948242 66.73437012 127.95458984 67.72241211 C127.84692895 75.15295971 126.26656455 78.48070319 121.16015625 83.87890625 C117.29820124 86.19607926 113.76558946 86.32207863 109.34765625 86.56640625 C109.36891634 87.40857697 109.36891634 87.40857697 109.39060593 88.26776123 C109.49265988 95.70486883 108.85899422 102.99860519 108.12597656 110.39453125 C107.99416512 111.75903799 107.86273685 113.12358178 107.73165894 114.48815918 C107.37685749 118.16630266 107.01564226 121.84378679 106.65237522 125.52110291 C106.42499133 127.82440784 106.1987573 130.12782302 105.97286224 132.43127441 C105.26404373 139.65586714 104.5513101 146.88005729 103.83282208 154.10369492 C103.00657507 162.41099987 102.19330675 170.71944001 101.39128041 179.02911758 C100.76822629 185.47634024 100.13366183 191.92236623 99.4904716 198.36761093 C99.10758987 202.20686454 98.72944635 206.04643833 98.3633194 209.8873291 C98.01859388 213.50030209 97.6594879 217.11156927 97.28970718 220.72206116 C97.09445561 222.66330132 96.91382963 224.60599554 96.73379517 226.54870605 C95.79636439 235.4995888 94.38293066 244.8862558 87.16015625 251.00390625 C86.46535156 251.62136719 85.77054688 252.23882812 85.0546875 252.875 C77.76357809 257.43062825 70.42830362 258.00477073 62.00390625 257.95458984 C60.9051416 257.9598468 59.80637695 257.96510376 58.67431641 257.97052002 C55.06528235 257.98365512 51.4566943 257.97500463 47.84765625 257.96484375 C45.32617102 257.96686634 42.80468636 257.96977932 40.28320312 257.97354126 C35.00776676 257.97795583 29.73244498 257.97185046 24.45703125 257.95751953 C18.37835302 257.94119605 12.29997677 257.94648573 6.22130585 257.96299875 C0.34745363 257.97831005 -5.52628483 257.97661708 -11.40014648 257.96785355 C-13.88793989 257.96585798 -16.37574105 257.9682881 -18.86352539 257.97529221 C-22.34541996 257.98294475 -25.82674164 257.97124851 -29.30859375 257.95458984 C-30.32808105 257.96066254 -31.34756836 257.96673523 -32.39794922 257.97299194 C-41.73610651 257.89058259 -49.08407993 256.0461973 -55.9296875 249.5 C-64.42789404 239.96119674 -63.87312921 225.41111049 -65.07275391 213.31567383 C-65.19984238 212.06187424 -65.32693085 210.80807465 -65.45787048 209.51628113 C-65.80190672 206.12011542 -66.14162304 202.72353153 -66.48020983 199.3268187 C-66.76473425 196.47629756 -67.0513632 193.6259895 -67.33794916 190.775675 C-68.01427809 184.04843751 -68.68699868 177.32084599 -69.35742188 170.59301758 C-70.04647942 163.67884273 -70.74171901 156.76530907 -71.43997157 149.85205728 C-72.0423299 143.88601666 -72.64081792 137.91959626 -73.236256 131.95286101 C-73.59061689 128.40229112 -73.94639477 124.85187866 -74.30592728 121.30182838 C-74.70648189 117.34475717 -75.09895487 113.38690633 -75.49072266 109.42895508 C-75.60914017 108.26973541 -75.72755768 107.11051575 -75.8495636 105.91616821 C-76.48291253 99.44076006 -76.80545726 93.07251484 -76.65234375 86.56640625 C-77.27157715 86.55134033 -77.89081055 86.53627441 -78.52880859 86.52075195 C-84.1038079 86.31839828 -87.15750127 84.99074129 -91.2421875 81.234375 C-96.93526862 74.50045357 -95.28685681 64.38681305 -94.890625 56.10839844 C-94.18809635 48.61379973 -90.394783 43.55058042 -84.7890625 38.8203125 C-78.80101686 35.306304 -73.24887525 34.11668635 -66.43359375 34.0546875 C-65.6902478 34.0367363 -64.94690186 34.0187851 -64.18103027 34.00028992 C-61.83819021 33.9466916 -59.4955477 33.91245645 -57.15234375 33.87890625 C-55.55075403 33.84568833 -53.94919024 33.81119462 -52.34765625 33.77539062 C-48.44936264 33.69099559 -44.55112244 33.62394693 -40.65234375 33.56640625 C-40.39130859 33.00767822 -40.13027344 32.4489502 -39.86132812 31.87329102 C-27.85360723 6.40420001 -27.85360723 6.40420001 -16.41917419 1.43643188 C-11.05586696 -0.25005194 -5.5764544 -0.02240271 0 0 Z M-14.65234375 22.56640625 C-16.2812829 25.0346564 -16.2812829 25.0346564 -17.46484375 27.69140625 C-17.88378906 28.56023437 -18.30273438 29.4290625 -18.734375 30.32421875 C-19.7786384 32.47108381 -19.7786384 32.47108381 -19.65234375 34.56640625 C4.10765625 34.56640625 27.86765625 34.56640625 52.34765625 34.56640625 C50.54027956 29.12101609 50.54027956 29.12101609 47.91015625 24.31640625 C47.49894531 23.65125 47.08773437 22.98609375 46.6640625 22.30078125 C45.28629544 20.28904271 45.28629544 20.28904271 42.34765625 18.56640625 C39.97998207 18.24965427 39.97998207 18.24965427 37.31298828 18.27587891 C36.28827423 18.2631192 35.26356018 18.2503595 34.20779419 18.23721313 C33.10152679 18.23498749 31.9952594 18.23276184 30.85546875 18.23046875 C29.71737762 18.22381195 28.5792865 18.21715515 27.40670776 18.21029663 C24.99755471 18.20016486 22.58837356 18.19547977 20.17919922 18.19580078 C16.49399502 18.19143155 12.8099919 18.15512631 9.125 18.1171875 C6.78516035 18.11131872 4.445315 18.10734974 2.10546875 18.10546875 C0.45214035 18.0839122 0.45214035 18.0839122 -1.23458862 18.06192017 C-8.79278416 18.05986336 -8.79278416 18.05986336 -14.65234375 22.56640625 Z M-74.60542297 54.41858864 C-77.65177713 58.47756299 -77.65177713 58.47756299 -76.65234375 68.56640625 C-15.27234375 68.56640625 46.10765625 68.56640625 109.34765625 68.56640625 C110.34708963 58.47756299 110.34708963 58.47756299 107.30073547 54.41858864 C103.62905379 52.11569609 101.42325323 51.93782394 97.09838867 51.93148804 C96.37893916 51.92368808 95.65948965 51.91588813 94.91823864 51.90785182 C92.51267649 51.88794214 90.10869826 51.90369067 87.703125 51.91943359 C85.9765226 51.91265696 84.24992743 51.90375356 82.52334595 51.8928833 C77.83732508 51.87008873 73.15185461 51.87892689 68.46582413 51.89477873 C63.56208054 51.90743691 58.65838411 51.89569784 53.75463867 51.8878479 C45.51960793 51.8787511 37.28480139 51.89074006 29.04980469 51.91455078 C19.52874503 51.94176211 10.00822071 51.93294797 0.48717403 51.90541875 C-7.68708154 51.88272956 -15.86117595 51.87952667 -24.03545284 51.8926121 C-28.91773695 51.90040765 -33.79976941 51.90144533 -38.68203735 51.88492966 C-43.27215257 51.87048691 -47.86157755 51.88050283 -52.45161819 51.90940094 C-54.13624551 51.91601283 -55.82093091 51.91411226 -57.50553513 51.90308762 C-59.80549974 51.88942345 -62.10325258 51.90655437 -64.40307617 51.93148804 C-65.68985764 51.93337317 -66.9766391 51.93525829 -68.30241394 51.93720055 C-71.74207899 52.37180727 -71.74207899 52.37180727 -74.60542297 54.41858864 Z M-58.65234375 86.56640625 C-58.06041788 97.22107192 -57.45335558 107.7703139 -56.40893555 118.37231445 C-56.28841827 119.62512207 -56.167901 120.87792969 -56.04373169 122.16870117 C-55.65092325 126.23532567 -55.25209545 130.3013189 -54.8515625 134.3671875 C-54.71262733 135.78178277 -54.57372497 137.19638127 -54.43485451 138.61098289 C-53.85728225 144.48905663 -53.27775677 150.36693129 -52.69249249 156.24424458 C-51.85925609 164.6118682 -51.03809199 172.9804775 -50.23346013 181.3509019 C-49.66293445 187.27608566 -49.07916401 193.19987327 -48.48545581 199.12277859 C-48.13252507 202.64697882 -47.78531189 206.17151879 -47.45224571 209.69765663 C-47.08189662 213.61464061 -46.68415964 217.52857694 -46.28393555 221.44262695 C-46.17832809 222.60261703 -46.07272064 223.76260712 -45.96391296 224.95774841 C-45.23886979 232.60892481 -45.23886979 232.60892481 -40.65234375 238.56640625 C-37.8441229 239.50247987 -36.13017962 239.69587014 -33.22512817 239.70684814 C-32.31950134 239.71255829 -31.41387451 239.71826843 -30.48080444 239.72415161 C-29.48956573 239.72526947 -28.49832703 239.72638733 -27.47705078 239.72753906 C-25.90836243 239.73498642 -25.90836243 239.73498642 -24.3079834 239.74258423 C-20.84203437 239.75721143 -17.3761311 239.76400847 -13.91015625 239.76953125 C-11.50503538 239.77528181 -9.09991453 239.78103956 -6.6947937 239.7868042 C-1.64922878 239.79731548 3.3963202 239.80315746 8.44189453 239.80664062 C14.91071559 239.81212853 21.37932649 239.83616257 27.84808159 239.86461258 C32.81687031 239.88322437 37.78560823 239.88844377 42.75442886 239.8899765 C45.1394783 239.89300636 47.52452678 239.90104604 49.90954208 239.91416168 C53.24438283 239.93119286 56.57870778 239.92934897 59.91357422 239.92285156 C61.39435959 239.93667374 61.39435959 239.93667374 62.90505981 239.95077515 C67.83731075 239.92063198 71.4077971 239.891887 75.34765625 236.56640625 C77.5123554 233.31935752 77.73484814 231.83444011 78.11965942 228.02719116 C78.24020691 226.87492035 78.36075439 225.72264954 78.48495483 224.53546143 C78.67053452 222.6372464 78.67053452 222.6372464 78.85986328 220.70068359 C78.99737985 219.35518261 79.1356221 218.00975562 79.27453613 216.66439819 C79.64988623 213.0078138 80.01471319 209.35024805 80.37745142 205.69239378 C80.75900378 201.86034298 81.14935798 198.02918814 81.5385437 194.19790649 C82.19143824 187.75734356 82.83778172 181.31614946 83.47998047 174.87451172 C84.22099697 167.44220639 84.9709727 160.01084937 85.72612488 152.57996786 C86.45344486 145.42195035 87.17558772 138.26342065 87.8949852 131.10460281 C88.200552 128.0640259 88.50767988 125.02361279 88.81604385 121.98331833 C89.17980692 118.39359193 89.53894009 114.80343017 89.8946228 111.21289444 C90.08726924 109.2784743 90.28426067 107.34448838 90.48141479 105.41052246 C90.59632263 104.2413327 90.71123047 103.07214294 90.82962036 101.86752319 C90.93026354 100.86205633 91.03090672 99.85658947 91.13459969 98.82065392 C91.40149845 94.74401499 91.34765625 90.6517728 91.34765625 86.56640625 C41.84765625 86.56640625 -7.65234375 86.56640625 -58.65234375 86.56640625 Z " fill="#000000" transform="translate(239.65234375,84.43359375)"/>
<path d="M0 0 C4.02339163 0.64661651 5.68303517 1.66268326 8.5 4.5625 C9.77647923 8.39193768 9.65564932 12.00278322 9.66113281 15.99365234 C9.66609772 16.85412674 9.67106262 17.71460114 9.67617798 18.60115051 C9.69079373 21.45025428 9.69760036 24.29930239 9.703125 27.1484375 C9.7088766 29.12757367 9.71463433 31.10670982 9.72039795 33.08584595 C9.73090603 37.23692077 9.73675007 41.38797624 9.74023438 45.5390625 C9.74572102 50.85775449 9.76975355 56.17619073 9.79820633 61.49480247 C9.81683018 65.58345284 9.82203816 69.67204154 9.82357025 73.76073074 C9.82659749 75.72153752 9.83462841 77.68234319 9.84775543 79.64310837 C9.86481179 82.3864565 9.86293678 85.12917893 9.85644531 87.87255859 C9.8656601 88.68208481 9.87487488 89.49161102 9.8843689 90.32566833 C9.85032834 94.9184656 9.39892493 97.93823288 6.5 101.5625 C2.74952518 104.06281654 0.94143734 104.09853554 -3.5 103.5625 C-6.20757842 101.58356437 -8.15733289 99.99682082 -8.96132278 96.6315155 C-9.15179425 94.2535416 -9.17558668 91.92262212 -9.14697266 89.53710938 C-9.16011505 88.18743828 -9.16011505 88.18743828 -9.17352295 86.8105011 C-9.1954952 83.84192408 -9.18097184 80.87484165 -9.1640625 77.90625 C-9.16743126 75.84028844 -9.17228437 73.77432881 -9.17855835 71.70837402 C-9.18592674 67.38074861 -9.17522496 63.05363956 -9.15185547 58.72607422 C-9.12336804 53.18069101 -9.13977214 47.63651772 -9.16971779 42.09117889 C-9.18779146 37.82573338 -9.18203234 33.56057441 -9.16907883 29.29512024 C-9.16574502 27.25059363 -9.16983097 25.20604096 -9.18147659 23.1615448 C-9.19418621 20.30295986 -9.17480665 17.44633003 -9.14697266 14.58789062 C-9.15709381 13.74410355 -9.16721497 12.90031647 -9.17764282 12.03096008 C-9.10042168 7.74703473 -8.86885611 6.04371912 -6.17831421 2.53356934 C-3.5 0.5625 -3.5 0.5625 0 0 Z " fill="#000000" transform="translate(281.5,195.4375)"/>
<path d="M0 0 C2.70757842 1.97893563 4.65733289 3.56567918 5.46132278 6.9309845 C5.65179425 9.3089584 5.67558668 11.63987788 5.64697266 14.02539062 C5.66011505 15.37506172 5.66011505 15.37506172 5.67352295 16.7519989 C5.6954952 19.72057592 5.68097184 22.68765835 5.6640625 25.65625 C5.66743126 27.72221156 5.67228437 29.78817119 5.67855835 31.85412598 C5.68592674 36.18175139 5.67522496 40.50886044 5.65185547 44.83642578 C5.62336804 50.38180899 5.63977214 55.92598228 5.66971779 61.47132111 C5.68779146 65.73676662 5.68203234 70.00192559 5.66907883 74.26737976 C5.66574502 76.31190637 5.66983097 78.35645904 5.68147659 80.4009552 C5.69418621 83.25954014 5.67480665 86.11616997 5.64697266 88.97460938 C5.65709381 89.81839645 5.66721497 90.66218353 5.67764282 91.53153992 C5.60042168 95.81546527 5.36885611 97.51878088 2.67831421 101.02893066 C0 103 0 103 -3.5 103.5625 C-7.52339163 102.91588349 -9.18303517 101.89981674 -12 99 C-13.27647923 95.17056232 -13.15564932 91.55971678 -13.16113281 87.56884766 C-13.16609772 86.70837326 -13.17106262 85.84789886 -13.17617798 84.96134949 C-13.19079373 82.11224572 -13.19760036 79.26319761 -13.203125 76.4140625 C-13.2088766 74.43492633 -13.21463433 72.45579018 -13.22039795 70.47665405 C-13.23090603 66.32557923 -13.23675007 62.17452376 -13.24023438 58.0234375 C-13.24572102 52.70474551 -13.26975355 47.38630927 -13.29820633 42.06769753 C-13.31683018 37.97904716 -13.32203816 33.89045846 -13.32357025 29.80176926 C-13.32659749 27.84096248 -13.33462841 25.88015681 -13.34775543 23.91939163 C-13.36481179 21.1760435 -13.36293678 18.43332107 -13.35644531 15.68994141 C-13.3656601 14.88041519 -13.37487488 14.07088898 -13.3843689 13.23683167 C-13.35032834 8.6440344 -12.89892493 5.62426712 -10 2 C-6.24952518 -0.50031654 -4.44143734 -0.53603554 0 0 Z " fill="#000000" transform="translate(234,196)"/>
<path d="M0 0 C1.99885531 2.07768341 3.00921149 4.13864219 3.2421875 7.015625 C3.01778517 9.83891942 2.55718714 12.24488041 0.92578125 14.59765625 C-1.7497351 16.53938119 -4.30369107 16.73394737 -7.55078125 17.25390625 C-15.67803923 18.8810353 -21.8387223 21.60576752 -26.80078125 28.44140625 C-29.50570083 33.18881612 -30.16330207 38.42353176 -30.95703125 43.76953125 C-32.14999 47.67550909 -33.43040162 48.89483615 -36.92578125 50.94140625 C-39.27734375 51.25390625 -39.27734375 51.25390625 -41.55078125 50.94140625 C-42.30617188 50.85890625 -43.0615625 50.77640625 -43.83984375 50.69140625 C-46.67588698 49.67170531 -47.49647808 48.58183235 -48.92578125 45.94140625 C-50.65872908 34.56015429 -47.27100122 24.28713241 -40.67578125 15.0703125 C-32.42613099 5.03446565 -13.54745502 -7.44697832 0 0 Z " fill="#000000" transform="translate(82.92578125,69.05859375)"/>
<path d="M0 0 C3 1.6875 3 1.6875 5 5 C6.79875505 15.45342076 3.80095753 25.01762337 -1.796875 33.828125 C-9.24297839 43.77611912 -19.72497239 49.95416206 -32 52 C-36.48618586 52.46859133 -39.91227653 52.54386174 -44 50.5 C-46.30710118 47.61612352 -46.82796816 45.67852076 -47.34765625 42.09765625 C-46.800423 38.79581071 -45.38442241 37.30824278 -43 35 C-39.64453125 33.84765625 -39.64453125 33.84765625 -35.8125 33.0625 C-28.33025837 31.29995214 -22.02503756 29.24999105 -17.41796875 22.77734375 C-14.48632047 17.4463061 -13.43920142 12.32052168 -12.50390625 6.36328125 C-12 4 -12 4 -10.375 1.3125 C-6.90133754 -0.60715557 -3.80501853 -0.81374654 0 0 Z " fill="#000000" transform="translate(473,307)"/>
</svg>
</button>
    
</div>
<div id="emojiPicker" class="emoji-picker hidden">
    <!-- List of all emojis -->
        <span onclick="addEmoji('😀')">😀</span>
        <span onclick="addEmoji('😁')">😁</span>
        <span onclick="addEmoji('😂')">😂</span>
        <span onclick="addEmoji('🤣')">🤣</span>
        <span onclick="addEmoji('😃')">😃</span>
        <span onclick="addEmoji('😄')">😄</span>
        <span onclick="addEmoji('😅')">😅</span>
        <span onclick="addEmoji('😆')">😆</span>
        <span onclick="addEmoji('😉')">😉</span>
        <span onclick="addEmoji('😊')">😊</span>
        <span onclick="addEmoji('😋')">😋</span>
        <span onclick="addEmoji('😎')">😎</span>
        <span onclick="addEmoji('😍')">😍</span>
        <span onclick="addEmoji('😘')">😘</span>
        <span onclick="addEmoji('😗')">😗</span>
        <span onclick="addEmoji('😙')">😙</span>
        <span onclick="addEmoji('😚')">😚</span>
        <span onclick="addEmoji('🙂')">🙂</span>
        <span onclick="addEmoji('🤗')">🤗</span>
        <span onclick="addEmoji('🤩')">🤩</span>
        <span onclick="addEmoji('🤔')">🤔</span>
        <span onclick="addEmoji('🤨')">🤨</span>
        <span onclick="addEmoji('😐')">😐</span>
        <span onclick="addEmoji('😑')">😑</span>
        <span onclick="addEmoji('😶')">😶</span>
        <span onclick="addEmoji('🙄')">🙄</span>
        <span onclick="addEmoji('😏')">😏</span>
        <span onclick="addEmoji('😣')">😣</span>
        <span onclick="addEmoji('😥')">😥</span>
        <span onclick="addEmoji('😮')">😮</span>
        <span onclick="addEmoji('🤐')">🤐</span>
        <span onclick="addEmoji('😯')">😯</span>
        <span onclick="addEmoji('😪')">😪</span>
        <span onclick="addEmoji('😫')">😫</span>
        <span onclick="addEmoji('😴')">😴</span>
        <span onclick="addEmoji('😌')">😌</span>
        <span onclick="addEmoji('😛')">😛</span>
        <span onclick="addEmoji('😜')">😜</span>
        <span onclick="addEmoji('😝')">😝</span>
        <span onclick="addEmoji('🤤')">🤤</span>
        <span onclick="addEmoji('😒')">😒</span>
        <span onclick="addEmoji('😓')">😓</span>
        <span onclick="addEmoji('😔')">😔</span>
        <span onclick="addEmoji('😕')">😕</span>
        <span onclick="addEmoji('🙃')">🙃</span>
        <span onclick="addEmoji('🤑')">🤑</span>
        <span onclick="addEmoji('😲')">😲</span>
        <span onclick="addEmoji('☹️')">☹️</span>
        <span onclick="addEmoji('🙁')">🙁</span>
        <span onclick="addEmoji('😖')">😖</span>
        <span onclick="addEmoji('😞')">😞</span>
        <span onclick="addEmoji('😟')">😟</span>
        <span onclick="addEmoji('😤')">😤</span>
        <span onclick="addEmoji('😢')">😢</span>
        <span onclick="addEmoji('😭')">😭</span>
        <span onclick="addEmoji('😦')">😦</span>
        <span onclick="addEmoji('😧')">😧</span>
        <span onclick="addEmoji('😨')">😨</span>
        <span onclick="addEmoji('😩')">😩</span>
        <span onclick="addEmoji('🤯')">🤯</span>
        <span onclick="addEmoji('😬')">😬</span>
        <span onclick="addEmoji('😰')">😰</span>
        <span onclick="addEmoji('😱')">😱</span>
        <span onclick="addEmoji('🥵')">🥵</span>
        <span onclick="addEmoji('🥶')">🥶</span>
        <span onclick="addEmoji('🤫')">🤫</span>
        <span onclick="addEmoji('😳')">😳</span>
        <span onclick="addEmoji('🤪')">🤪</span>
        <span onclick="addEmoji('😵')">😵</span>
        <span onclick="addEmoji('😡')">😡</span>
        <span onclick="addEmoji('😠')">😠</span>
        <span onclick="addEmoji('🤬')">🤬</span>
        <span onclick="addEmoji('😷')">😷</span>
        <span onclick="addEmoji('🤒')">🤒</span>
        <span onclick="addEmoji('🤕')">🤕</span>
        <span onclick="addEmoji('🤢')">🤢</span>
        <span onclick="addEmoji('🤮')">🤮</span>
        <span onclick="addEmoji('🤧')">🤧</span>
        <span onclick="addEmoji('😇')">😇</span>
        <span onclick="addEmoji('🥳')">🥳</span>
        <span onclick="addEmoji('🥴')">🥴</span>
        <span onclick="addEmoji('🥺')">🥺</span>
        <span onclick="addEmoji('🤠')">🤠</span>
        <span onclick="addEmoji('👍')">👍</span>
        <span onclick="addEmoji('👌')">👌</span>
        <span onclick="addEmoji('🫡')">🫡</span>
        <span onclick="addEmoji('🥱')">🥱</span> 
        <span onclick="addEmoji('🤓')">🤓</span>
        <span onclick="addEmoji('🤥')">🤥</span>
        <span onclick="addEmoji('🧢')">🧢</span>
        <span onclick="addEmoji('🤝')">🤝</span>
        <span onclick="addEmoji('🤤')">🤤</span>
        <span onclick="addEmoji('😈')">😈</span>
        <span onclick="addEmoji('👿')">👿</span>
        <span onclick="addEmoji('👹')">👹</span>
        <span onclick="addEmoji('👺')">👺</span>
        <span onclick="addEmoji('🤡')">🤡</span>
        <span onclick="addEmoji('💩')">💩</span>
        <span onclick="addEmoji('👻')">👻</span>
        <span onclick="addEmoji('💀')">💀</span>
        <span onclick="addEmoji('☠️')">☠️</span>
        <span onclick="addEmoji('👽')">👽</span>
        <span onclick="addEmoji('👾')">👾</span>
        <span onclick="addEmoji('🤖')">🤖</span>
    <span onclick="addEmoji('💤')">💤</span>
    <span onclick="addEmoji('💭')">💭</span>
    <span onclick="addEmoji('🗯')">🗯</span>
    <span onclick="addEmoji('🗨')">🗨</span>
    <span onclick="addEmoji('👁️‍🗨️')">👁️‍🗨️</span>
    <span onclick="addEmoji('💓')">💓</span>
    <span onclick="addEmoji('💞')">💞</span>
    <span onclick="addEmoji('💕')">💕</span>
    <span onclick="addEmoji('💟')">💟</span>
    <span onclick="addEmoji('❣')">❣</span>
    <span onclick="addEmoji('💔')">💔</span>
    <span onclick="addEmoji('❤')">❤</span>
    <span onclick="addEmoji('🧡')">🧡</span>
    <span onclick="addEmoji('💛')">💛</span>
    <span onclick="addEmoji('💙')">💙</span>
    <span onclick="addEmoji('💜')">💜</span>
    <span onclick="addEmoji('🤎')">🤎</span>
    <span onclick="addEmoji('🖤')">🖤</span>
    <span onclick="addEmoji('🤍')">🤍</span>
    <span onclick="addEmoji('💯')">💯</span>
    <span onclick="addEmoji('💢')">💢</span>
    <span onclick="addEmoji('💥')">💥</span>
    <span onclick="addEmoji('💫')">💫</span>
    <span onclick="addEmoji('💦')">💦</span>
    <span onclick="addEmoji('💨')">💨</span>
    <span onclick="addEmoji('🕳')">🕳</span>
    <span onclick="addEmoji('💣')">💣</span>
    <span onclick="addEmoji('💬')">💬</span>
    <span onclick="addEmoji('💗')">💗</span>
    <span onclick="addEmoji('💖')">💖</span>
    <span onclick="addEmoji('💝')">💝</span>
    <span onclick="addEmoji('💘')">💘</span>
    <span onclick="addEmoji('💌')">💌</span>
    <span onclick="addEmoji('💋')">💋</span>
    <span onclick="addEmoji('🙊')">🙊</span>
    <span onclick="addEmoji('🙉')">🙉</span>
    <span onclick="addEmoji('🙈')">🙈</span>
    <span onclick="addEmoji('😾')">😾</span>
    <span onclick="addEmoji('😿')">😿</span>
    <span onclick="addEmoji('🙀')">🙀</span>
    <span onclick="addEmoji('😽')">😽</span>
    <span onclick="addEmoji('😼')">😼</span>
    <span onclick="addEmoji('😻')">😻</span>
    <span onclick="addEmoji('😹')">😹</span>
    <span onclick="addEmoji('😸')">😸</span>
    <span onclick="addEmoji('😺')">😺</span>
    <span onclick="addEmoji('🤖')">🤖</span>
    <span onclick="addEmoji('👾')">👾</span>
    <span onclick="addEmoji('👽')">👽</span>
    <span onclick="addEmoji('👻')">👻</span>
    <span onclick="addEmoji('👺')">👺</span>
    <span onclick="addEmoji('👹')">👹</span>
    <span onclick="addEmoji('👿')">👿</span>
    <span onclick="addEmoji('😈')">😈</span>
    <span onclick="addEmoji('💀')">💀</span>
    <span onclick="addEmoji('☠️')">☠️</span>
    <span onclick="addEmoji('💩')">💩</span>
    <span onclick="addEmoji('🧑‍⚕️')">🧑‍⚕️</span>
    <span onclick="addEmoji('👨‍⚕️')">👨‍⚕️</span>
    <span onclick="addEmoji('👩‍⚕️')">👩‍⚕️</span>
    <span onclick="addEmoji('🧑‍🎓')">🧑‍🎓</span>
    <span onclick="addEmoji('👨‍🎓')">👨‍🎓</span>
    <span onclick="addEmoji('👩‍🎓')">👩‍🎓</span>
    <span onclick="addEmoji('🧑‍🏫')">🧑‍🏫</span>
    <span onclick="addEmoji('👨‍🏫')">👨‍🏫</span>
    <span onclick="addEmoji('👩‍🏫')">👩‍🏫</span>
    <span onclick="addEmoji('👨‍💻')">👨‍💻</span>
    <span onclick="addEmoji('🧑‍💻')">🧑‍💻</span>
    <span onclick="addEmoji('👩‍💻')">👩‍💻</span>
    <span onclick="addEmoji('👨‍🔬')">👨‍🔬</span>
    <span onclick="addEmoji('🧑‍🔬')">🧑‍🔬</span>
    <span onclick="addEmoji('👩‍🔬')">👩‍🔬</span>
    <span onclick="addEmoji('👨‍💼')">👨‍💼</span>
    <span onclick="addEmoji('🧑‍💼')">🧑‍💼</span>
    <span onclick="addEmoji('👩‍💼')">👩‍💼</span>
    <span onclick="addEmoji('👨‍🏭')">👨‍🏭</span>
    <span onclick="addEmoji('🧑‍🏭')">🧑‍🏭</span>
    <span onclick="addEmoji('👩‍🏭')">👩‍🏭</span>
    <span onclick="addEmoji('👨‍🔧')">👨‍🔧</span>
    <span onclick="addEmoji('🧑‍🔧')">🧑‍🔧</span>
    <span onclick="addEmoji('👩‍🔧')">👩‍🔧</span>
    <span onclick="addEmoji('👨‍🍳')">👨‍🍳</span>
    <span onclick="addEmoji('🧑‍🍳')">🧑‍🍳</span>
    <span onclick="addEmoji('👩‍🍳')">👩‍🍳</span>
    <span onclick="addEmoji('👨‍🌾')">👨‍🌾</span>
    <span onclick="addEmoji('🧑‍🌾')">🧑‍🌾</span>
    <span onclick="addEmoji('👩‍🌾')">👩‍🌾</span>
    <span onclick="addEmoji('👨‍⚖️')">👨‍⚖️</span>
    <span onclick="addEmoji('🧑‍⚖️')">🧑‍⚖️</span>
    <span onclick="addEmoji('👩‍⚖️')">👩‍⚖️</span>
    <span onclick="addEmoji('👨‍🎤')">👨‍🎤</span>
    <span onclick="addEmoji('🧑‍🎤')">🧑‍🎤</span>
    <span onclick="addEmoji('👩‍🎤')">👩‍🎤</span>
    <span onclick="addEmoji('👨‍🎨')">👨‍🎨</span>
    <span onclick="addEmoji('🧑‍🎨')">🧑‍🎨</span>
    <span onclick="addEmoji('👩‍🎨')">👩‍🎨</span>
    <span onclick="addEmoji('👨‍✈️')">👨‍✈️</span>
    <span onclick="addEmoji('🧑‍✈️')">🧑‍✈️</span>
    <span onclick="addEmoji('👩‍✈️')">👩‍✈️</span>
    <span onclick="addEmoji('👨‍🚀')">👨‍🚀</span>
    <span onclick="addEmoji('🧑‍🚀')">🧑‍🚀</span>
    <span onclick="addEmoji('👩‍🚀')">👩‍🚀</span>
    <span onclick="addEmoji('👨‍🚒')">👨‍🚒</span>
    <span onclick="addEmoji('👩‍🚒')">👩‍🚒</span>
    <span onclick="addEmoji('👮')">👮</span>
    <span onclick="addEmoji('🕵️‍♂️')">🕵️‍♂️</span>
    <span onclick="addEmoji('🕵️‍♀️')">🕵️‍♀️</span>
    <span onclick="addEmoji('💂')">💂</span>
    <span onclick="addEmoji('🦹')">🦹</span>
    <span onclick="addEmoji('🦸')">🦸</span>
    <span onclick="addEmoji('🤶')">🤶</span>
    <span onclick="addEmoji('🎅')">🎅</span>
    <span onclick="addEmoji('👼')">👼</span>
    <span onclick="addEmoji('🤱')">🤱</span>
    <span onclick="addEmoji('🤰')">🤰</span>
    <span onclick="addEmoji('👰')">👰</span>
    <span onclick="addEmoji('🤵')">🤵</span>
    <span onclick="addEmoji('👲')">👲</span>
    <span onclick="addEmoji('👳‍♂️')">👳‍♂️</span>
    <span onclick="addEmoji('👳')">👳</span>
    <span onclick="addEmoji('👸')">👸</span>
    <span onclick="addEmoji('🤴')">🤴</span>
    <span onclick="addEmoji('👷‍♀️')">👷‍♀️</span>
    <span onclick="addEmoji('👷‍♂️')">👷‍♂️</span>
    <span onclick="addEmoji('💂‍♀️')">💂‍♀️</span>
    <span onclick="addEmoji('🧙')">🧙</span>
    <span onclick="addEmoji('🧚')">🧚</span>
    <span onclick="addEmoji('🧛')">🧛</span>
    <span onclick="addEmoji('🧜')">🧜</span>
    <span onclick="addEmoji('🧝')">🧝</span>
    <span onclick="addEmoji('🧞')">🧞</span>
    <span onclick="addEmoji('🧟')">🧟</span>
    <span onclick="addEmoji('💆')">💆</span>
    <span onclick="addEmoji('🏃‍♀️')">🏃‍♀️</span>
    <span onclick="addEmoji('🏃‍♂️')">🏃‍♂️</span>
    <span onclick="addEmoji('🏃')">🏃</span>
    <span onclick="addEmoji('👩‍🦽')">👩‍🦽</span>
    <span onclick="addEmoji('👨‍🦽')">👨‍🦽</span>
    <span onclick="addEmoji('👩‍🦼')">👩‍🦼</span>
    <span onclick="addEmoji('🚶‍♂️')">🚶‍♂️</span>
    <span onclick="addEmoji('🚶')">🚶</span>
    <span onclick="addEmoji('💇‍♀️')">💇‍♀️</span>
    <span onclick="addEmoji('💇‍♂️')">💇‍♂️</span>
    <span onclick="addEmoji('💃')">💃</span>
    <span onclick="addEmoji('🕺')">🕺</span>
    <span onclick="addEmoji('🕴')">🕴</span>
    <span onclick="addEmoji('👯')">👯</span>
    <span onclick="addEmoji('🧖')">🧖</span>
    <span onclick="addEmoji('🧗')">🧗</span>
    <span onclick="addEmoji('🤺')">🤺</span>
    <span onclick="addEmoji('🏇')">🏇</span>
    <span onclick="addEmoji('⛷')">⛷</span>
    <span onclick="addEmoji('🏂')">🏂</span>
    <span onclick="addEmoji('🏌')">🏌</span>
    <span onclick="addEmoji('🏄')">🏄</span>
    <span onclick="addEmoji('🚣')">🚣</span>
    <span onclick="addEmoji('🤼‍♀️')">🤼‍♀️</span>
    <span onclick="addEmoji('🤸‍♀️')">🤸‍♀️</span>
    <span onclick="addEmoji('🚵‍♀️')">🚵‍♀️</span>
    <span onclick="addEmoji('🚴‍♀️')">🚴‍♀️</span>
    <span onclick="addEmoji('🏋️‍♀️')">🏋️‍♀️</span>
    <span onclick="addEmoji('🏊‍♀️')">🏊‍♀️</span>
    <span onclick="addEmoji('🤽‍♀️')">🤽‍♀️</span>
    <span onclick="addEmoji('🤾‍♀️')">🤾‍♀️</span>
    <span onclick="addEmoji('🤹‍♀️')">🤹‍♀️</span>
    <span onclick="addEmoji('🧘')">🧘</span>
    <span onclick="addEmoji('🛀')">🛀</span>
    <span onclick="addEmoji('🧑‍🤝‍🧑')">🧑‍🤝‍🧑</span>
    <span onclick="addEmoji('👭')">👭</span>
    <span onclick="addEmoji('👫')">👫</span>
    <span onclick="addEmoji('👬')">👬</span>
    <span onclick="addEmoji('💏')">💏</span>
    <span onclick="addEmoji('💑')">💑</span>
    <span onclick="addEmoji('👪')">👪</span>
    <span onclick="addEmoji('🗣')">🗣</span>
    <span onclick="addEmoji('👤')">👤</span>
    <span onclick="addEmoji('👥')">👥</span>
    <span onclick="addEmoji('👣')">👣</span>
    <span onclick="addEmoji('🦰')">🦰</span>
    <span onclick="addEmoji('🦲')">🦲</span>
    <span onclick="addEmoji('🦳')">🦳</span>
    <span onclick="addEmoji('🦱')">🦱</span>
    <span onclick="addEmoji('🐵')">🐵</span>
    <span onclick="addEmoji('🐒')">🐒</span>
    <span onclick="addEmoji('🦍')">🦍</span>
    <span onclick="addEmoji('🦧')">🦧</span>
    <span onclick="addEmoji('🐶')">🐶</span>
    <span onclick="addEmoji('🐕')">🐕</span>
    <span onclick="addEmoji('🦮')">🦮</span>
    <span onclick="addEmoji('🐩')">🐩</span>
    <span onclick="addEmoji('🐺')">🐺</span>
    <span onclick="addEmoji('🦊')">🦊</span>
    <span onclick="addEmoji('🦝')">🦝</span>
    <span onclick="addEmoji('🐱')">🐱</span>
    <span onclick="addEmoji('🐈')">🐈</span>
    <span onclick="addEmoji('🐯')">🐯</span>
    <span onclick="addEmoji('🐅')">🐅</span>
    <span onclick="addEmoji('🐆')">🐆</span>
    <span onclick="addEmoji('🐴')">🐴</span>
    <span onclick="addEmoji('🐎')">🐎</span>
    <span onclick="addEmoji('🦄')">🦄</span>
    <span onclick="addEmoji('🦌')">🦌</span>
    <span onclick="addEmoji('🐮')">🐮</span>
    <span onclick="addEmoji('🐿')">🐿</span>
    <span onclick="addEmoji('🐇')">🐇</span>
    <span onclick="addEmoji('🐹')">🐹</span>
    <span onclick="addEmoji('🐀')">🐀</span>
    <span onclick="addEmoji('🐁')">🐁</span>
    <span onclick="addEmoji('🐭')">🐭</span>
    <span onclick="addEmoji('🦛')">🦛</span>
    <span onclick="addEmoji('🦏')">🦏</span>
    <span onclick="addEmoji('🐘')">🐘</span>
    <span onclick="addEmoji('🦒')">🦒</span>
    <span onclick="addEmoji('🦙')">🦙</span>
    <span onclick="addEmoji('🐫')">🐫</span>
    <span onclick="addEmoji('🐪')">🐪</span>
    <span onclick="addEmoji('🐐')">🐐</span>
    <span onclick="addEmoji('🐑')">🐑</span>
    <span onclick="addEmoji('🐏')">🐏</span>
    <span onclick="addEmoji('🐽')">🐽</span>
    <span onclick="addEmoji('🐗')">🐗</span>
    <span onclick="addEmoji('🐖')">🐖</span>
    <span onclick="addEmoji('🐷')">🐷</span>
    <span onclick="addEmoji('🐄')">🐄</span>
    <span onclick="addEmoji('🐃')">🐃</span>
    <span onclick="addEmoji('🐂')">🐂</span>
    <span onclick="addEmoji('🦔')">🦔</span>
    <span onclick="addEmoji('🦇')">🦇</span>
    <span onclick="addEmoji('🐻')">🐻</span>
    <span onclick="addEmoji('🐨')">🐨</span>
    <span onclick="addEmoji('🐼')">🐼</span>
    <span onclick="addEmoji('🦥')">🦥</span>
    <span onclick="addEmoji('🦦')">🦦</span>
    <span onclick="addEmoji('🦨')">🦨</span>
    <span onclick="addEmoji('🦘')">🦘</span>
    <span onclick="addEmoji('🦡')">🦡</span>
    <span onclick="addEmoji('🐾')">🐾</span>
    <span onclick="addEmoji('🦃')">🦃</span>
    <span onclick="addEmoji('🐔')">🐔</span>
    <span onclick="addEmoji('🐓')">🐓</span>
    <span onclick="addEmoji('🐣')">🐣</span>
    <span onclick="addEmoji('🐥')">🐥</span>
    <span onclick="addEmoji('🐤')">🐤</span>
    <span onclick="addEmoji('🐦')">🐦</span>
    <span onclick="addEmoji('🐧')">🐧</span>
    <span onclick="addEmoji('🕊')">🕊</span>
    <span onclick="addEmoji('🦅')">🦅</span>
    <span onclick="addEmoji('🦆')">🦆</span>
    <span onclick="addEmoji('🐛')">🐛</span>
    <span onclick="addEmoji('🦋')">🦋</span>
    <span onclick="addEmoji('🦉')">🦉</span>
    <span onclick="addEmoji('🐌')">🐌</span>
    <span onclick="addEmoji('🐚')">🐚</span>
    <span onclick="addEmoji('🐙')">🐙</span>
    <span onclick="addEmoji('🦈')">🦈</span>
    <span onclick="addEmoji('🐡')">🐡</span>
    <span onclick="addEmoji('🐠')">🐠</span>
    <span onclick="addEmoji('🐟')">🐟</span>
    <span onclick="addEmoji('🐬')">🐬</span>
    <span onclick="addEmoji('🐋')">🐋</span>
    <span onclick="addEmoji('🦖')">🦖</span>
    <span onclick="addEmoji('🦕')">🦕</span>
    <span onclick="addEmoji('🐉')">🐉</span>
    <span onclick="addEmoji('🐲')">🐲</span>
    <span onclick="addEmoji('🐍')">🐍</span>
    <span onclick="addEmoji('🦎')">🦎</span>
    <span onclick="addEmoji('🐢')">🐢</span>
    <span onclick="addEmoji('🐊')">🐊</span>
    <span onclick="addEmoji('🐸')">🐸</span>
    <span onclick="addEmoji('🦜')">🦜</span>
    <span onclick="addEmoji('🦚')">🦚</span>
    <span onclick="addEmoji('🦩')">🦩</span>
    <span onclick="addEmoji('🐜')">🐜</span>
    <span onclick="addEmoji('🐝')">🐝</span>
    <span onclick="addEmoji('🐞')">🐞</span>
    <span onclick="addEmoji('🦗')">🦗</span>
    <span onclick="addEmoji('🕷')">🕷</span>
    <span onclick="addEmoji('🕸')">🕸</span>
    <span onclick="addEmoji('🦂')">🦂</span>
    <span onclick="addEmoji('🦟')">🦟</span>
    <span onclick="addEmoji('🦠')">🦠</span>
    <span onclick="addEmoji('💐')">💐</span>
    <span onclick="addEmoji('🌸')">🌸</span>
    <span onclick="addEmoji('💮')">💮</span>
    <span onclick="addEmoji('🏵')">🏵</span>
    <span onclick="addEmoji('🥀')">🥀</span>
    <span onclick="addEmoji('🌺')">🌺</span>
    <span onclick="addEmoji('🌱')">🌱</span>
    <span onclick="addEmoji('🌲')">🌲</span>
    <span onclick="addEmoji('🌳')">🌳</span>
    <span onclick="addEmoji('🌴')">🌴</span>
    <span onclick="addEmoji('🌵')">🌵</span>
    <span onclick="addEmoji('🍃')">🍃</span>
    <span onclick="addEmoji('🍂')">🍂</span>
    <span onclick="addEmoji('🍁')">🍁</span>
    <span onclick="addEmoji('☘')">☘</span>
    <span onclick="addEmoji('🌾')">🌾</span>
<span onclick="addEmoji('🌿')">🌿</span>
<span onclick="addEmoji('☘')">☘</span>
<span onclick="addEmoji('🍀')">🍀</span>
<span onclick="addEmoji('🍁')">🍁</span>
<span onclick="addEmoji('🍂')">🍂</span>
<span onclick="addEmoji('🍃')">🍃</span>
<span onclick="addEmoji('🍇')">🍇</span>
<span onclick="addEmoji('🍈')">🍈</span>
<span onclick="addEmoji('🍉')">🍉</span>
<span onclick="addEmoji('🍊')">🍊</span>
<span onclick="addEmoji('🍋')">🍋</span>
<span onclick="addEmoji('🍌')">🍌</span>
<span onclick="addEmoji('🍍')">🍍</span>
<span onclick="addEmoji('🥭')">🥭</span>
<span onclick="addEmoji('🍎')">🍎</span>
<span onclick="addEmoji('🍏')">🍏</span>
<span onclick="addEmoji('🍐')">🍐</span>
<span onclick="addEmoji('🍑')">🍑</span>
<span onclick="addEmoji('🍓')">🍓</span>
<span onclick="addEmoji('🥝')">🥝</span>
<span onclick="addEmoji('🍅')">🍅</span>
<span onclick="addEmoji('🥥')">🥥</span>
<span onclick="addEmoji('🥑')">🥑</span>
<span onclick="addEmoji('🍆')">🍆</span>
<span onclick="addEmoji('🥔')">🥔</span>
<span onclick="addEmoji('🥕')">🥕</span>
<span onclick="addEmoji('🌽')">🌽</span>
<span onclick="addEmoji('🌶')">🌶</span>
<span onclick="addEmoji('🥒')">🥒</span>
<span onclick="addEmoji('🥬')">🥬</span>
<span onclick="addEmoji('🥦')">🥦</span>
<span onclick="addEmoji('🧄')">🧄</span>
<span onclick="addEmoji('🧅')">🧅</span>
<span onclick="addEmoji('🍄')">🍄</span>
<span onclick="addEmoji('🥜')">🥜</span>
<span onclick="addEmoji('🌰')">🌰</span>
<span onclick="addEmoji('🍞')">🍞</span>
<span onclick="addEmoji('🥐')">🥐</span>
<span onclick="addEmoji('🥖')">🥖</span>
<span onclick="addEmoji('🥨')">🥨</span>
<span onclick="addEmoji('🥯')">🥯</span>
<span onclick="addEmoji('🥞')">🥞</span>
<span onclick="addEmoji('🧇')">🧇</span>
<span onclick="addEmoji('🧀')">🧀</span>
<span onclick="addEmoji('🍖')">🍖</span>
<span onclick="addEmoji('🍗')">🍗</span>
<span onclick="addEmoji('🥩')">🥩</span>
<span onclick="addEmoji('🥓')">🥓</span>
<span onclick="addEmoji('🍟')">🍟</span>
<span onclick="addEmoji('🍕')">🍕</span>
<span onclick="addEmoji('🌭')">🌭</span>
<span onclick="addEmoji('🥪')">🥪</span>
<span onclick="addEmoji('🌮')">🌮</span>
<span onclick="addEmoji('🌯')">🌯</span>
<span onclick="addEmoji('🥙')">🥙</span>
<span onclick="addEmoji('🧆')">🧆</span>
<span onclick="addEmoji('🥚')">🥚</span>
<span onclick="addEmoji('🍳')">🍳</span>
<span onclick="addEmoji('🥘')">🥘</span>
<span onclick="addEmoji('🍲')">🍲</span>
<span onclick="addEmoji('🥣')">🥣</span>
<span onclick="addEmoji('🥗')">🥗</span>
<span onclick="addEmoji('🍿')">🍿</span>
<span onclick="addEmoji('🧈')">🧈</span>
<span onclick="addEmoji('🧂')">🧂</span>
<span onclick="addEmoji('🥫')">🥫</span>
<span onclick="addEmoji('🍱')">🍱</span>
<span onclick="addEmoji('🍘')">🍘</span>
<span onclick="addEmoji('🍙')">🍙</span>
<span onclick="addEmoji('🍚')">🍚</span>
<span onclick="addEmoji('🍛')">🍛</span>
<span onclick="addEmoji('🍜')">🍜</span>
<span onclick="addEmoji('🍝')">🍝</span>
<span onclick="addEmoji('🍠')">🍠</span>
<span onclick="addEmoji('🍢')">🍢</span>
<span onclick="addEmoji('🍣')">🍣</span>
<span onclick="addEmoji('🍤')">🍤</span>
<span onclick="addEmoji('🍥')">🍥</span>
<span onclick="addEmoji('🥮')">🥮</span>
<span onclick="addEmoji('🍡')">🍡</span>
<span onclick="addEmoji('🥟')">🥟</span>
<span onclick="addEmoji('🥠')">🥠</span>
<span onclick="addEmoji('🥡')">🥡</span>
<span onclick="addEmoji('🦀')">🦀</span>
<span onclick="addEmoji('🦞')">🦞</span>
<span onclick="addEmoji('🦐')">🦐</span>
<span onclick="addEmoji('🦑')">🦑</span>
<span onclick="addEmoji('🦪')">🦪</span>
<span onclick="addEmoji('🍦')">🍦</span>
<span onclick="addEmoji('🍧')">🍧</span>
<span onclick="addEmoji('🍨')">🍨</span>
<span onclick="addEmoji('🍩')">🍩</span>
<span onclick="addEmoji('🍪')">🍪</span>
<span onclick="addEmoji('🎂')">🎂</span>
<span onclick="addEmoji('🍰')">🍰</span>
<span onclick="addEmoji('🧁')">🧁</span>
<span onclick="addEmoji('🥧')">🥧</span>
<span onclick="addEmoji('🍫')">🍫</span>
<span onclick="addEmoji('🍬')">🍬</span>
<span onclick="addEmoji('🍭')">🍭</span>
<span onclick="addEmoji('🍮')">🍮</span>
<span onclick="addEmoji('🍯')">🍯</span>
<span onclick="addEmoji('🍼')">🍼</span>
<span onclick="addEmoji('🥛')">🥛</span>
<span onclick="addEmoji('☕')">☕</span>
<span onclick="addEmoji('🍵')">🍵</span>
<span onclick="addEmoji('🍶')">🍶</span>
<span onclick="addEmoji('🍾')">🍾</span>
<span onclick="addEmoji('🍷')">🍷</span>
<span onclick="addEmoji('🍸')">🍸</span>
<span onclick="addEmoji('🍹')">🍹</span>
<span onclick="addEmoji('🍺')">🍺</span>
<span onclick="addEmoji('🍻')">🍻</span>
<span onclick="addEmoji('🥂')">🥂</span>
<span onclick="addEmoji('🥃')">🥃</span>
<span onclick="addEmoji('🥤')">🥤</span>
<span onclick="addEmoji('🧃')">🧃</span>
<span onclick="addEmoji('🧉')">🧉</span>
<span onclick="addEmoji('🧊')">🧊</span>
<span onclick="addEmoji('🥢')">🥢</span>
<span onclick="addEmoji('🍽')">🍽</span>
<span onclick="addEmoji('🍴')">🍴</span>
<span onclick="addEmoji('🔪')">🔪</span>
<span onclick="addEmoji('🏺')">🏺</span>
<span onclick="addEmoji('🌍')">🌍</span>
<span onclick="addEmoji('🌎')">🌎</span>
<span onclick="addEmoji('🌏')">🌏</span>
<span onclick="addEmoji('🌐')">🌐</span>
<span onclick="addEmoji('🗺')">🗺</span>
<span onclick="addEmoji('🗾')">🗾</span>
<span onclick="addEmoji('🧭')">🧭</span>
<span onclick="addEmoji('🏔')">🏔</span>
<span onclick="addEmoji('⛰')">⛰</span>
<span onclick="addEmoji('🌋')">🌋</span>
<span onclick="addEmoji('🗻')">🗻</span>
<span onclick="addEmoji('🏕')">🏕</span>
<span onclick="addEmoji('🏖')">🏖</span>
<span onclick="addEmoji('🏜')">🏜</span>
<span onclick="addEmoji('🏝')">🏝</span>
<span onclick="addEmoji('🏞')">🏞</span>
<span onclick="addEmoji('🏟')">🏟</span>
<span onclick="addEmoji('🏛')">🏛</span>
<span onclick="addEmoji('🏗')">🏗</span>
<span onclick="addEmoji('🧱')">🧱</span>
<span onclick="addEmoji('🏘')">🏘</span>
<span onclick="addEmoji('🏚')">🏚</span>
<span onclick="addEmoji('🏠')">🏠</span>
<span onclick="addEmoji('🏡')">🏡</span>
<span onclick="addEmoji('🏢')">🏢</span>
<span onclick="addEmoji('🏣')">🏣</span>
<span onclick="addEmoji('🏤')">🏤</span>
<span onclick="addEmoji('🏥')">🏥</span>
<span onclick="addEmoji('🏦')">🏦</span>
<span onclick="addEmoji('🏨')">🏨</span>
<span onclick="addEmoji('🏩')">🏩</span>
<span onclick="addEmoji('🏪')">🏪</span>
<span onclick="addEmoji('🏫')">🏫</span>
<span onclick="addEmoji('🏬')">🏬</span>
<span onclick="addEmoji('🏭')">🏭</span>
<span onclick="addEmoji('🏯')">🏯</span>
<span onclick="addEmoji('🏰')">🏰</span>
<span onclick="addEmoji('💒')">💒</span>
<span onclick="addEmoji('🗼')">🗼</span>
<span onclick="addEmoji('🗽')">🗽</span>
<span onclick="addEmoji('⛪')">⛪</span>
<span onclick="addEmoji('🕌')">🕌</span>
<span onclick="addEmoji('🛕')">🛕</span>
<span onclick="addEmoji('🕍')">🕍</span>
<span onclick="addEmoji('⛩')">⛩</span>
<span onclick="addEmoji('🕋')">🕋</span>
<span onclick="addEmoji('⛲')">⛲</span>
<span onclick="addEmoji('⛺')">⛺</span>
<span onclick="addEmoji('🌁')">🌁</span>
<span onclick="addEmoji('🌃')">🌃</span>
<span onclick="addEmoji('🏙')">🏙</span>
<span onclick="addEmoji('🌄')">🌄</span>
<span onclick="addEmoji('🌅')">🌅</span>
<span onclick="addEmoji('🌆')">🌆</span>
<span onclick="addEmoji('🌇')">🌇</span>
<span onclick="addEmoji('🌉')">🌉</span>
<span onclick="addEmoji('♨')">♨</span>
<span onclick="addEmoji('🎠')">🎠</span>
<span onclick="addEmoji('🎡')">🎡</span>
<span onclick="addEmoji('🎢')">🎢</span>
<span onclick="addEmoji('💈')">💈</span>
<span onclick="addEmoji('🎪')">🎪</span>
<span onclick="addEmoji('🚂')">🚂</span>
<span onclick="addEmoji('🚃')">🚃</span>
<span onclick="addEmoji('🚄')">🚄</span>
<span onclick="addEmoji('🚅')">🚅</span>
<span onclick="addEmoji('🚆')">🚆</span>
<span onclick="addEmoji('🚇')">🚇</span>
<span onclick="addEmoji('🚈')">🚈</span>
<span onclick="addEmoji('🚉')">🚉</span>
<span onclick="addEmoji('🚊')">🚊</span>
<span onclick="addEmoji('🚝')">🚝</span>
<span onclick="addEmoji('🚞')">🚞</span>
<span onclick="addEmoji('🚋')">🚋</span>
<span onclick="addEmoji('🚌')">🚌</span>
<span onclick="addEmoji('🚍')">🚍</span>
<span onclick="addEmoji('🚎')">🚎</span>
<span onclick="addEmoji('🚐')">🚐</span>
<span onclick="addEmoji('🚑')">🚑</span>
<span onclick="addEmoji('🚒')">🚒</span>
<span onclick="addEmoji('🚓')">🚓</span>
<span onclick="addEmoji('🚔')">🚔</span>
<span onclick="addEmoji('🚕')">🚕</span>
<span onclick="addEmoji('🚖')">🚖</span>
<span onclick="addEmoji('🚗')">🚗</span>
<span onclick="addEmoji('🚘')">🚘</span>
<span onclick="addEmoji('🚙')">🚙</span>
<span onclick="addEmoji('🚚')">🚚</span>
<span onclick="addEmoji('🚛')">🚛</span>
<span onclick="addEmoji('🚜')">🚜</span>
<span onclick="addEmoji('🏎')">🏎</span>
<span onclick="addEmoji('🏍')">🏍</span>
<span onclick="addEmoji('🛵')">🛵</span>
<span onclick="addEmoji('🦽')">🦽</span>
<span onclick="addEmoji('🦼')">🦼</span>
<span onclick="addEmoji('🛺')">🛺</span>
<span onclick="addEmoji('🚲')">🚲</span>
<span onclick="addEmoji('🛴')">🛴</span>
<span onclick="addEmoji('🛹')">🛹</span>
<span onclick="addEmoji('🚏')">🚏</span>
<span onclick="addEmoji('🛣')">🛣</span>
<span onclick="addEmoji('🛤')">🛤</span>
<span onclick="addEmoji('🛢')">🛢</span>
<span onclick="addEmoji('⛽')">⛽</span>
<span onclick="addEmoji('🚨')">🚨</span>
<span onclick="addEmoji('🚥')">🚥</span>
<span onclick="addEmoji('🚦')">🚦</span>
<span onclick="addEmoji('🛑')">🛑</span>
<span onclick="addEmoji('🚧')">🚧</span>
<span onclick="addEmoji('⚓')">⚓</span>
<span onclick="addEmoji('⛵')">⛵</span>
<span onclick="addEmoji('🛶')">🛶</span>
<span onclick="addEmoji('🚤')">🚤</span>
<span onclick="addEmoji('🛳')">🛳</span>
<span onclick="addEmoji('⛴')">⛴</span>
<span onclick="addEmoji('🛥')">🛥</span>
<span onclick="addEmoji('🚢')">🚢</span>
<span onclick="addEmoji('✈')">✈</span>
<span onclick="addEmoji('🛩')">🛩</span>
<span onclick="addEmoji('🛫')">🛫</span>
<span onclick="addEmoji('🛬')">🛬</span>
<span onclick="addEmoji('🪂')">🪂</span>
<span onclick="addEmoji('💺')">💺</span>
<span onclick="addEmoji('🚁')">🚁</span>
<span onclick="addEmoji('🚟')">🚟</span>
<span onclick="addEmoji('🚠')">🚠</span>
<span onclick="addEmoji('🚡')">🚡</span>
<span onclick="addEmoji('🛰')">🛰</span>
<span onclick="addEmoji('🚀')">🚀</span>
<span onclick="addEmoji('🛸')">🛸</span>
<span onclick="addEmoji('🛎')">🛎</span>
<span onclick="addEmoji('🧳')">🧳</span>
<span onclick="addEmoji('⌛')">⌛</span>
<span onclick="addEmoji('⏳')">⏳</span>
<span onclick="addEmoji('⌚')">⌚</span>
<span onclick="addEmoji('⏱')">⏱</span>
<span onclick="addEmoji('⏲')">⏲</span>
<span onclick="addEmoji('🕰')">🕰</span>
<span onclick="addEmoji('🕛')">🕛</span>
<span onclick="addEmoji('🕧')">🕧</span>
<span onclick="addEmoji('🕐')">🕐</span>
<span onclick="addEmoji('🕜')">🕜</span>
<span onclick="addEmoji('🕑')">🕑</span>
<span onclick="addEmoji('🕦')">🕦</span>
<span onclick="addEmoji('🕚')">🕚</span>
<span onclick="addEmoji('🕥')">🕥</span>
<span onclick="addEmoji('🕙')">🕙</span>
<span onclick="addEmoji('🕤')">🕤</span>
<span onclick="addEmoji('🕘')">🕘</span>
<span onclick="addEmoji('🕣')">🕣</span>
<span onclick="addEmoji('🕗')">🕗</span>
<span onclick="addEmoji('🕢')">🕢</span>
<span onclick="addEmoji('🕖')">🕖</span>
<span onclick="addEmoji('🕡')">🕡</span>
<span onclick="addEmoji('🕕')">🕕</span>
<span onclick="addEmoji('🕠')">🕠</span>
<span onclick="addEmoji('🕟')">🕟</span>
<span onclick="addEmoji('🕓')">🕓</span>
<span onclick="addEmoji('🕞')">🕞</span>
<span onclick="addEmoji('🕒')">🕒</span>
<span onclick="addEmoji('🕝')">🕝</span>
<span onclick="addEmoji('🌕')">🌕</span>
<span onclick="addEmoji('🌔')">🌔</span>
<span onclick="addEmoji('🌓')">🌓</span>
<span onclick="addEmoji('🌒')">🌒</span>
<span onclick="addEmoji('🌑')">🌑</span>
<span onclick="addEmoji('🌖')">🌖</span>
<span onclick="addEmoji('🌘')">🌘</span>
<span onclick="addEmoji('🌙')">🌙</span>
<span onclick="addEmoji('🌚')">🌚</span>
<span onclick="addEmoji('🌛')">🌛</span>
<span onclick="addEmoji('🌜')">🌜</span>
<span onclick="addEmoji('🌡')">🌡</span>
<span onclick="addEmoji('☀')">☀</span>
<span onclick="addEmoji('🌝')">🌝</span>
<span onclick="addEmoji('🌞')">🌞</span>
<span onclick="addEmoji('🪐')">🪐</span>
<span onclick="addEmoji('🌟')">🌟</span>
<span onclick="addEmoji('🌠')">🌠</span>
<span onclick="addEmoji('🌌')">🌌</span>
<span onclick="addEmoji('☁')">☁</span>
<span onclick="addEmoji('⛅')">⛅</span>
<span onclick="addEmoji('⛈')">⛈</span>
<span onclick="addEmoji('🌤')">🌤</span>
<span onclick="addEmoji('🌥')">🌥</span>
<span onclick="addEmoji('🌦')">🌦</span>
<span onclick="addEmoji('🌧')">🌧</span>
<span onclick="addEmoji('🌨')">🌨</span>
<span onclick="addEmoji('🌊')">🌊</span>
<span onclick="addEmoji('💧')">💧</span>
<span onclick="addEmoji('🔥')">🔥</span>
<span onclick="addEmoji('☄')">☄</span>
<span onclick="addEmoji('⛄')">⛄</span>
<span onclick="addEmoji('☃')">☃</span>
<span onclick="addEmoji('❄')">❄</span>
<span onclick="addEmoji('⚡')">⚡</span>
<span onclick="addEmoji('⛱')">⛱</span>
<span onclick="addEmoji('☔')">☔</span>
<span onclick="addEmoji('☂')">☂</span>
<span onclick="addEmoji('🌂')">🌂</span>
<span onclick="addEmoji('🌈')">🌈</span>
<span onclick="addEmoji('🌀')">🌀</span>
<span onclick="addEmoji('🌬')">🌬</span>
<span onclick="addEmoji('🌫')">🌫</span>
<span onclick="addEmoji('🌪')">🌪</span>
<span onclick="addEmoji('🌩')">🌩</span>

            <!-- Add more emojis here -->
        </div>
    </div>
</div>




</div>

<!-- Modal for Viewing Group Members -->
<div id="viewMembersModal" class="modal2">
    <div class="modal-content">
        <span class="close">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 24px; height: 24px;">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                    <g id="Edit / Close_Circle">
                        <path id="Vector" d="M9 9L11.9999 11.9999M11.9999 11.9999L14.9999 14.9999M11.9999 11.9999L9 14.9999M11.9999 11.9999L14.9999 9M12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21Z"
                            stroke="#ffffff"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round">
                        </path>
                    </g>
                </g>
            </svg>
        </span>
        <h2>Group Members</h2>
        <div id="membersList">
            <!-- Members will be dynamically added here -->
        </div>
    </div>
</div>

<!-- Modal Structure -->
<div id="bugModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <button id="disableModal" class="modal-btn">
                <svg fill="#ffffff" viewBox="0 0 32 32" enable-background="new 0 0 32 32" id="Glyph" version="1.1" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" stroke="#ffffff">
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                    <g id="SVGRepo_iconCarrier">
                        <path d="M20.722,24.964c0.096,0.096,0.057,0.264-0.073,0.306c-7.7,2.466-16.032-1.503-18.594-8.942 c-0.072-0.21-0.072-0.444,0-0.655c0.743-2.157,1.99-4.047,3.588-5.573c0.061-0.058,0.158-0.056,0.217,0.003l4.302,4.302 c0.03,0.03,0.041,0.072,0.031,0.113c-1.116,4.345,2.948,8.395,7.276,7.294c0.049-0.013,0.095-0.004,0.131,0.032 C17.958,22.201,20.045,24.287,20.722,24.964z" id="XMLID_323_"></path>
                        <path d="M24.68,23.266c2.406-1.692,4.281-4.079,5.266-6.941c0.072-0.21,0.072-0.44,0-0.65 C27.954,9.888,22.35,6,16,6c-2.479,0-4.841,0.597-6.921,1.665L3.707,2.293c-0.391-0.391-1.023-0.391-1.414,0s-0.391,1.023,0,1.414 l26,26c0.391,0.391,1.023,0.391,1.414,0c0.391-0.391,0.391-1.023,0-1.414L24.68,23.266z M16,10c3.309,0,6,2.691,6,6 c0,1.294-0.416,2.49-1.115,3.471l-8.356-8.356C13.51,10.416,14.706,10,16,10z" id="XMLID_325_"></path>
                    </g>
                </svg>
            </button>
            <span class="modal-title">Current Bugs:</span>
            <button id="closeModal" class="modal-btn">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                    <g id="SVGRepo_iconCarrier">
                        <g id="Edit / Close_Circle">
                            <path id="Vector" d="M9 9L11.9999 11.9999M11.9999 11.9999L14.9999 14.9999M11.9999 11.9999L9 14.9999M11.9999 11.9999L14.9999 9M12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                        </g>
                    </g>
                </svg>
            </button>
        </div>
<ul class="bug-list">
    <li>Chat Switching Bug: When switching between individual chats, messages may be sent to the previous chat instead of the current one.</li>
    <li class="fix-item">Fix: Refresh the page before switching chats, then select the desired contact.</li>
    <li>View Friend Info Bug: The view friend modal is still under development, and the close button may be difficult to use.</li>
    <li class="fix-item">Fix: If possible, try to close the modal or refresh the page to resolve the issue.</li>
</ul>
    </div>
</div>

<!-- Modal structure -->
<div id="viewFriendModal" class="modal3">
    <div class="modal-content3">
        <span class="close-button3">&times;</span>
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 24px; height: 24px;">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                    <g id="Edit / Close_Circle">
                        <path id="Vector" d="M9 9L11.9999 11.9999M11.9999 11.9999L14.9999 14.9999M11.9999 11.9999L9 14.9999M11.9999 11.9999L14.9999 9M12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21Z"
                            stroke="#ffffff"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round">
                        </path>
                    </g>
                </g>
            </svg>
        </span>
        <h3>Friend Information</h3>
        <p><strong>Name:</strong> <span id="friendDisplayName"></span></p>
        <p><strong>Email:</strong> <span id="friendEmail"></span></p>
        <label for="editFriendName">Edit Friend Name:</label>
        <input type="text" id="editFriendName" class="input-style">
        <button id="saveFriendName" class="save-button">Save</button>
    </div>
</div>

<!-- Modal for Replies -->
<div id="modal4" class="modal4">
    <div class="modal4-content">
        <span class="modal4-close">&times;</span>
        <div id="modal4Message"></div>
        <textarea id="replyInput" placeholder="Write your reply here..."></textarea>
        <button id="sendReplyButton">Send Reply</button>
    </div>
</div>


<div style="display:none;">
    <svg id="defaultAvatar" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 4C14.21 4 16 5.79 16 8C16 10.21 14.21 12 12 12C9.79 12 8 10.21 8 8C8 5.79 9.79 4 12 4ZM12 20C9.33 20 6.34 18.87 4.63 16.74C5.91 15.43 8.39 14.5 12 14.5C15.61 14.5 18.09 15.43 19.37 16.74C17.66 18.87 14.67 20 12 20Z" fill="currentColor"/>
    </svg>
</div>



        
 <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
    <script>
// Initialize Firebase
var firebaseConfig = {
    apiKey: "AIzaSyDaMAlQRMXiDsZ4P0b06P18id3y5xBiZ1k",
    authDomain: "deepworkai-c3419.firebaseapp.com",
    projectId: "deepworkai-c3419",
    storageBucket: "deepworkai-c3419.appspot.com",
    messagingSenderId: "367439182644",
    appId: "1:367439182644:web:304216430df97eff68c361"
};
firebase.initializeApp(firebaseConfig);
var db = firebase.firestore();
var auth = firebase.auth();
const firestore = firebase.firestore();

var emojiPicker = document.getElementById("emojiPicker");
var recentEmojisContainer = document.getElementById("recentEmojis");

let inactivityTimeout;
let isUserOffline = false;

function setUserOnlineStatus(status) {
    const currentUser = firebase.auth().currentUser;
    if (currentUser) {
        const currentUserUID = currentUser.uid;
        
        db.collection('users').doc(currentUserUID).update({
            online: status
        }).then(() => {
            
            isUserOffline = !status; // Update isUserOffline based on the new status
        }).catch((error) => {
            console.error('Error updating online status: ', error);
        });
    } else {
        console.error('No current user is logged in.'); // Log if currentUser is null
    }
}

function updateUserStatusOnInteraction() {
    if (isUserOffline) {
        setUserOnlineStatus(true); // Set status to true if user is offline
    }
    clearTimeout(inactivityTimeout); // Clear previous timeout
    inactivityTimeout = setTimeout(() => {
        setUserOnlineStatus(false); // Set status to false after 2 minutes of inactivity
    }, 120000); // 2 minutes 
}

// Bind the interaction function to all necessary events
window.addEventListener('click', updateUserStatusOnInteraction);
window.addEventListener('mousemove', updateUserStatusOnInteraction);
window.addEventListener('keydown', updateUserStatusOnInteraction);
window.addEventListener('scroll', updateUserStatusOnInteraction);

// Initialize user's online status to true when the page loads
function initializeUserStatus() {
    if (firebase.auth().currentUser) {
        setUserOnlineStatus(true); // Set status to true when the page loads or reloads
        updateUserStatusOnInteraction(); // Set up inactivity timeout
    }
}

// Call initializeUserStatus on page load
initializeUserStatus();

// Update status to offline when the page is unloaded
window.addEventListener('beforeunload', () => {
    if (firebase.auth().currentUser) {
        setUserOnlineStatus(true); // Set status to false when the user leaves
    }
});
        
// Toggle the emoji picker dropdown
function toggleEmojiPicker() {
    emojiPicker.classList.toggle("hidden");
}

// Function to add emoji to input and save it as recent
function addEmoji(emoji) {
    const chatInput = document.getElementById('chatInput');
    if (chatInput) {
        chatInput.value += emoji;
    }

    var user = auth.currentUser;
    if (user) {
        var userDocRef = db.collection("recentEmojis").doc(user.uid);
        userDocRef.get().then(function(doc) {
            if (doc.exists) {
                userDocRef.update({
                    emojis: firebase.firestore.FieldValue.arrayUnion(emoji)
                }).then(() => {
                    // Update recent emojis in the UI
                    loadRecentEmojis();
                });
            } else {
                userDocRef.set({
                    emojis: [emoji]
                }).then(() => {
                    // Update recent emojis in the UI
                    loadRecentEmojis();
                });
            }
        }).catch(function(error) {
            console.error("Error adding emoji: ", error);
        });
    }
}


// Load recent emojis from Firestore
function loadRecentEmojis() {
    var user = auth.currentUser;
    if (user) {
        db.collection("recentEmojis").doc(user.uid).get().then(function(doc) {
            if (doc.exists && doc.data().emojis.length > 0) {
                var recentEmojis = doc.data().emojis;
                recentEmojisContainer.innerHTML = "";
                recentEmojis.reverse().forEach(function(emoji) {
                    var emojiSpan = document.createElement("span");
                    emojiSpan.textContent = emoji;
                    emojiSpan.onclick = function() { addEmoji(emoji); };
                    recentEmojisContainer.appendChild(emojiSpan);
                });
            } else {
                // Show popular emojis if no recent emojis are available
                var popularEmojis = ["😀", "😂", "😍", "😭", "🙄"];
                recentEmojisContainer.innerHTML = "";
                popularEmojis.forEach(function(emoji) {
                    var emojiSpan = document.createElement("span");
                    emojiSpan.textContent = emoji;
                    emojiSpan.onclick = function() { addEmoji(emoji); };
                    recentEmojisContainer.appendChild(emojiSpan);
                });
            }
        }).catch(function(error) {
            console.error("Error loading recent emojis: ", error);
        });
    }
}

// Call loadRecentEmojis on page load
auth.onAuthStateChanged(function(user) {
    if (user) {
        loadRecentEmojis();
    }
});

function clearRecentEmojis() {
    // Get current user
    var user = auth.currentUser;
    
    if (user) {
        var userId = user.uid;
        
        // Reference to the recentEmojis collection for the current user
        var recentEmojisRef = db.collection('recentEmojis').doc(userId);
        
        // Clear the recent emojis for the current user
        recentEmojisRef.update({
            emojis: [] // Assuming 'emojis' is the field storing recent emojis
        })
        .then(() => {
            
            
            // Clear the emojis from the UI
            var recentEmojisContainer = document.getElementById('recentEmojis');
            if (recentEmojisContainer) {
                recentEmojisContainer.innerHTML = ''; // Clears the recent emojis
            }
            
            // Call loadRecentEmojis to refresh the UI
            loadRecentEmojis();
        })
        .catch((error) => {
            console.error('Error clearing recent emojis: ', error);
        });
    } else {
        console.error('No user is signed in.');
    }
}

    
        function updateOnlineStatus(isOnline) {
            if (auth.currentUser) {
                db.collection('users').doc(auth.currentUser.uid).set({
                    online: isOnline,
                    lastSeen: firebase.firestore.FieldValue.serverTimestamp()
                }, { merge: true }).then(() => {
                    
                }).catch((error) => {
                    console.error('Error updating online status:', error);
                });
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            auth.onAuthStateChanged(function(user) {
                if (user) {
                    // Update the UI with the user's display name
                    const username = user.displayName || user.email;
                    document.getElementById('username').textContent = username;
                    document.getElementById('displayName').textContent = username;

                    // Set Firestore online status to true when the user is authenticated
                    updateOnlineStatus(true);

                    // Handle the user going offline only when the tab is closed or navigated away
                    window.addEventListener('beforeunload', function() {
                        updateOnlineStatus(false);
                    });

                    // Handle tab visibility change
                    document.addEventListener('visibilitychange', function() {
                        if (document.visibilityState === 'visible') {
                            updateOnlineStatus(true);
                        }
                    });

                } else {
                    // No user is signed in, redirect to login page
                    window.location.href = "login.html";
                }
            });
        });

            document.addEventListener('DOMContentLoaded', function() {
        firebase.auth().onAuthStateChanged(function(user) {
            if (user) {
                loadOnlineFriends();
                listenForFriendRequests();
                refreshOnlineFriends();
            } else {
                window.location.href = "login.html";
            }
        });
    });

self.addEventListener('notificationclick', function(event) {
    event.notification.close();
    event.waitUntil(
        clients.matchAll({ type: 'window' }).then(function(clientList) {
            if (clientList.length > 0) {
                return clientList[0].focus();
            }
            return clients.openWindow('/chat.html'); // Or the URL of your chat page
        })
    );
});


document.addEventListener('DOMContentLoaded', function() {
    if (Notification.permission === 'default') {
        Notification.requestPermission().then(permission => {
            if (permission === 'granted') {
                
            } else {
                console.log('Notification permission denied.');
            }
        });
    }
});



function addFriend() {
    const friendEmail = document.getElementById('friendEmail').value;
    const currentUser = firebase.auth().currentUser;

    if (friendEmail && currentUser) {
        const userId = currentUser.uid;

        db.collection('users').where('email', '==', friendEmail).get()
            .then((querySnapshot) => {
                if (querySnapshot.empty) {
                    console.error('User with this email does not exist.');
                    return;
                }

                const recipientDoc = querySnapshot.docs[0];
                const recipientId = recipientDoc.id;

                db.collection('friendRequests').add({
                    senderId: userId,
                    recipientId: recipientId,
                    status: 'pending',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                }).then(() => {
                    console.log('Friend request sent!');
                    alert('Friend request sent!');
                }).catch((error) => {
                    console.error('Error sending friend request:', error);
                });
            })
            .catch((error) => {
                console.error('Error fetching user data:', error);
            });
    }
}

function listenForFriendRequests() {
    const currentUser = firebase.auth().currentUser;

    if (currentUser) {
        const userId = currentUser.uid;

        db.collection('friendRequests').where('recipientId', '==', userId)
            .onSnapshot((snapshot) => {
                snapshot.docChanges().forEach((change) => {
                    if (change.type === 'added') {
                        const friendRequest = change.doc.data();
                        if (friendRequest.status === 'pending') {
                            getUserEmail(friendRequest.senderId).then((email) => {
                                showAcceptPopup(email, change.doc.id);
                            });
                        }
                    }
                });
            });
    }
}

function showAcceptPopup(senderEmail, requestId) {
    if (confirm(`You have a new friend request from ${senderEmail}. Do you want to accept it?`)) {
        acceptFriendRequest(requestId, senderEmail);
    } else {
        console.log('Friend request declined');
    }
}

function acceptFriendRequest(requestId, senderEmail) {
    const currentUser = firebase.auth().currentUser;

    if (currentUser) {
        const userId = currentUser.uid;

        // Update the friend request status to accepted
        db.collection('friendRequests').doc(requestId).update({
            status: 'accepted'
        }).then(() => {
            console.log('Friend request accepted!');
            
            // Add both users to accepted friends
            addToAcceptedFriends(userId, senderEmail);
            
            // Open a chat with the sender
            openChat(senderEmail);
            
            // Update the online friends list
            loadOnlineFriends();
        }).catch((error) => {
            console.error('Error accepting friend request:', error);
        });
    }
}

function addToAcceptedFriends(userId, senderEmail) {
    const currentUser = firebase.auth().currentUser;

    if (currentUser) {
        const currentUserId = currentUser.uid;
        
        // Fetch the recipient's user document
        db.collection('users').where('email', '==', senderEmail).get()
            .then((querySnapshot) => {
                if (!querySnapshot.empty) {
                    const recipientDoc = querySnapshot.docs[0];
                    const recipientId = recipientDoc.id;
                    
                    // Add sender to recipient's accepted friends
                    db.collection('users').doc(recipientId).update({
                        acceptedFriends: firebase.firestore.FieldValue.arrayUnion(currentUser.email)
                    }).catch((error) => {
                        console.error('Error updating recipient’s accepted friends list:', error);
                    });
                    
                    // Add recipient to sender's accepted friends
                    db.collection('users').doc(currentUserId).update({
                        acceptedFriends: firebase.firestore.FieldValue.arrayUnion(senderEmail)
                    }).catch((error) => {
                        console.error('Error updating sender’s accepted friends list:', error);
                    });
                }
            })
            .catch((error) => {
                console.error('Error fetching recipient data:', error);
            });
    }
}



function refreshOnlineFriends() {
    loadOnlineFriends();
}

document.getElementById('refreshButton').addEventListener('click', () => {
    refreshOnlineFriends();

    // Optional: Add a simple rotation animation
    const button = document.getElementById('refreshButton');
    button.style.transition = 'transform 0.5s ease-in-out';
    button.style.transform = 'rotate(360deg)';

    setTimeout(() => {
        button.style.transform = 'none';
    }, 500);
});

function loadOnlineFriends() {
    const currentUser = firebase.auth().currentUser;

    if (currentUser) {
        const currentUserEmail = currentUser.email;
        const acceptedFriends = new Set();
        const displayNameMap = new Map(); // To store the display names of friends
        const pinnedFriendsSet = new Set(); // Initialize the pinned friends set


        // Fetch the current user's accepted friends
        db.collection('users').where('email', '==', currentUserEmail).get()
            .then((querySnapshot) => {
                if (!querySnapshot.empty) {
                    const userDoc = querySnapshot.docs[0];
                    const data = userDoc.data();
                    
                    if (data.acceptedFriends) {
                        data.acceptedFriends.forEach((email) => {
                            acceptedFriends.add(email);
                            displayNameMap.set(email, null); // Initialize with null
                        });
                    }

                    // Populate the pinnedFriendsSet with the user's pinned friends
                    if (data.pinnedFriends) {
                        data.pinnedFriends.forEach((email) => {
                            pinnedFriendsSet.add(email);
                        });
                    }
                    
                    // Now fetch online users
                    db.collection('users').get().then((querySnapshot) => {
    const onlineFriendsList = document.getElementById('onlineFriends');
    onlineFriendsList.innerHTML = ''; // Clear the list before appending new items

    querySnapshot.forEach((doc) => {
        const friendRef = doc.ref; // Reference to the friend's document
        const friend = doc.data();
        const friendEmail = friend.email;
        let friendDisplayName = (friend.displayName === 'Anonymous') ? friend.email : friend.displayName;

        if (acceptedFriends.has(friendEmail) && friendEmail !== currentUserEmail) {
            // Update display name if changed
            if (displayNameMap.get(friendEmail) !== friendDisplayName) {
                displayNameMap.set(friendEmail, friendDisplayName);

                const listItem = document.createElement('li');
                listItem.classList.add('friend-item');


                                    // Create user avatar container
                                    const avatarContainer = document.createElement('div');
                                    avatarContainer.classList.add('user-avatar');
                                    loadFriendProfilePicture(friendEmail, avatarContainer); // Load friend profile picture

                // Create or update a span for the friend's name
                const friendName = document.createElement('span');
                friendName.textContent = friendDisplayName;
                friendName.classList.add('friend-name');

               const statusIcon = document.createElement('span');
statusIcon.classList.add('status-icon');

if (friend.online) {
    statusIcon.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M5.63604 18.3639C2.12132 14.8492 2.12132 9.15071 5.63604 5.63599M18.364 5.63599C21.8787 9.15071 21.8787 14.8492 18.364 18.3639M8.46447 15.5355C6.51184 13.5829 6.51184 10.417 8.46447 8.46441M15.5355 8.46441C17.4882 10.417 17.4882 13.5829 15.5355 15.5355M13 11.9999C13 12.5522 12.5523 12.9999 12 12.9999C11.4477 12.9999 11 12.5522 11 11.9999C11 11.4477 11.4477 10.9999 12 10.9999C12.5523 10.9999 13 11.4477 13 11.9999Z" stroke="green" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>`;
} else {
    statusIcon.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M18.364 5.63605C21.8787 9.15077 21.8787 14.8493 18.364 18.364M18.364 18.364L15.5355 15.5355M18.364 18.364L21 21M15.5355 8.46447C17.4882 10.4171 17.4882 13.5829 15.5355 15.5355M15.5355 15.5355L12.7071 12.7071M8.46447 15.5355C7.66839 14.7395 7.19687 13.7417 7.04991 12.7068M5.63604 18.364C3.13732 15.8652 2.41501 12.2628 3.46913 9.12598M11.2929 11.2929C11.4739 11.1119 11.7239 11 12 11C12.5523 11 13 11.4477 13 12C13 12.2761 12.8881 12.5261 12.7071 12.7071M11.2929 11.2929L3 3M11.2929 11.2929L12.7071 12.7071" stroke="#c0392b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>`;
}


                
                                        // Create and append Unfriend button
                                        const unfriendButton = createUnfriendButton(friendEmail);

                                        // Create the 'View Friend Info' button
                                        const viewFriendInfoButton = document.createElement('button');
                                        viewFriendInfoButton.innerHTML = `
                                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#000000" width="20" height="20">
                                                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                                <g id="SVGRepo_iconCarrier">
                                                    <defs>
                                                        <style>
                                                            .a,.b{fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:1.5px;}
                                                            .a{stroke-linejoin:round;}
                                                            .b{stroke-linejoin:bevel;}
                                                        </style>
                                                    </defs>
                                                    <path class="a" d="M3,21.016l.78984-2.87249C5.0964,13.3918,8.5482,10.984,12,10.984"></path>
                                                    <circle class="b" cx="12" cy="5.98404" r="5"></circle>
                                                    <circle class="a" cx="17" cy="18" r="5"></circle>
                                                    <line class="a" x1="17" x2="17" y1="17.34043" y2="20.51064"></line>
                                                    <line class="a" x1="17" x2="17" y1="15.59574" y2="15.51064"></line>
                                                </g>
                                            </svg>
                                        `;

                                        viewFriendInfoButton.style.backgroundColor = 'var(--primary-color)';
                                        viewFriendInfoButton.style.border = 'none';
                                        viewFriendInfoButton.style.borderRadius = '50%';
                                        viewFriendInfoButton.style.marginLeft = '8px';
                                        viewFriendInfoButton.style.marginRight = '0';
                                        viewFriendInfoButton.style.padding = '6px';
                                        viewFriendInfoButton.style.cursor = 'pointer';
                                        viewFriendInfoButton.style.display = 'flex';
                                        viewFriendInfoButton.style.alignItems = 'center';
                                        viewFriendInfoButton.style.justifyContent = 'center';

                                        viewFriendInfoButton.addEventListener('mouseover', () => {
                                            viewFriendInfoButton.style.backgroundColor = '#3b7bce';
                                        });

                                        viewFriendInfoButton.addEventListener('mouseout', () => {
                                            viewFriendInfoButton.style.backgroundColor = 'var(--primary-color)';
                                        });

                                        viewFriendInfoButton.onclick = () => {
                                            const modal = document.getElementById('viewFriendModal');
                                            modal.style.display = 'block';
                                            document.getElementById('friendDisplayName').textContent = friendDisplayName;
                                            document.getElementById('friendEmail').textContent = friendEmail;
                                            document.getElementById('editFriendName').value = friendDisplayName;

                                            document.getElementById('saveFriendName').onclick = () => {
                                                const newFriendName = document.getElementById('editFriendName').value;
                                                if (newFriendName !== friendDisplayName) {
                                                    saveFriendDisplayName(friendEmail, newFriendName);
                                                }
                                                modal.style.display = 'none';
                                            };
                                        };
                                        
                                        // Create the 'Pinned Friends' button
const pinnedFriendsButton = document.createElement('button');
pinnedFriendsButton.innerHTML = `
    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="20" height="20">
        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
        <g id="SVGRepo_iconCarrier"> 
            <path fill-rule="evenodd" clip-rule="evenodd" 
                d="M17.1218 1.87023C15.7573 0.505682 13.4779 0.76575 12.4558 2.40261L9.61062 6.95916C9.61033 6.95965 9.60913 6.96167 9.6038 6.96549C9.59728 6.97016 9.58336 6.97822 9.56001 6.9848C9.50899 6.99916 9.44234 6.99805 9.38281 6.97599C8.41173 6.61599 6.74483 6.22052 5.01389 6.87251C4.08132 7.22378 3.61596 8.03222 3.56525 8.85243C3.51687 9.63502 3.83293 10.4395 4.41425 11.0208L7.94975 14.5563L1.26973 21.2363C0.879206 21.6269 0.879206 22.26 1.26973 22.6506C1.66025 23.0411 2.29342 23.0411 2.68394 22.6506L9.36397 15.9705L12.8995 19.5061C13.4808 20.0874 14.2853 20.4035 15.0679 20.3551C15.8881 20.3044 16.6966 19.839 17.0478 18.9065C17.6998 17.1755 17.3043 15.5086 16.9444 14.5375C16.9223 14.478 16.9212 14.4114 16.9355 14.3603C16.9421 14.337 16.9502 14.3231 16.9549 14.3165C16.9587 14.3112 16.9606 14.31 16.9611 14.3098L21.5177 11.4645C23.1546 10.4424 23.4147 8.16307 22.0501 6.79853L17.1218 1.87023ZM14.1523 3.46191C14.493 2.91629 15.2528 2.8296 15.7076 3.28445L20.6359 8.21274C21.0907 8.66759 21.0041 9.42737 20.4584 9.76806L15.9019 12.6133C14.9572 13.2032 14.7469 14.3637 15.0691 15.2327C15.3549 16.0037 15.5829 17.1217 15.1762 18.2015C15.1484 18.2752 15.1175 18.3018 15.0985 18.3149C15.0743 18.3316 15.0266 18.3538 14.9445 18.3589C14.767 18.3699 14.5135 18.2916 14.3137 18.0919L5.82846 9.6066C5.62872 9.40686 5.55046 9.15333 5.56144 8.97583C5.56651 8.8937 5.58877 8.84605 5.60548 8.82181C5.61855 8.80285 5.64516 8.7719 5.71886 8.74414C6.79869 8.33741 7.91661 8.56545 8.68762 8.85128C9.55668 9.17345 10.7171 8.96318 11.3071 8.01845L14.1523 3.46191Z" 
                fill="#ffffff"></path> 
        </g>
    </svg>
`;

pinnedFriendsButton.style.backgroundColor = 'var(--primary-color)';
pinnedFriendsButton.style.border = 'none';
pinnedFriendsButton.style.borderRadius = '50%';
pinnedFriendsButton.style.marginLeft = '8px';
pinnedFriendsButton.style.marginRight = '0';
pinnedFriendsButton.style.padding = '6px';
pinnedFriendsButton.style.cursor = 'pointer';
pinnedFriendsButton.style.display = 'flex';
pinnedFriendsButton.style.alignItems = 'center';
pinnedFriendsButton.style.justifyContent = 'center';

pinnedFriendsButton.addEventListener('mouseover', () => {
    pinnedFriendsButton.style.backgroundColor = '#3b7bce';
});

pinnedFriendsButton.addEventListener('mouseout', () => {
    pinnedFriendsButton.style.backgroundColor = 'var(--primary-color)';
});

// Add click event to handle pinning functionality
pinnedFriendsButton.onclick = () => {
    const currentUser = firebase.auth().currentUser;
    if (currentUser) {
        const currentUserUID = currentUser.uid;
        const pinnedUserEmail = friendEmail;

        // Reference to the current user's document in the 'pinnedFriends' collection
        const userRef = db.collection('pinnedFriends').doc(currentUserUID);

        // Get the user's pinned friends
        userRef.get()
            .then((doc) => {
                let pinnedFriends = [];
                if (doc.exists) {
                    pinnedFriends = doc.data().pinnedFriends || [];
                } else {
                    // If the document doesn't exist, create it with an empty pinnedFriends array
                    userRef.set({ pinnedFriends: [] });
                }

                // Add the pinned friend's email if not already in the list
                if (!pinnedFriends.includes(pinnedUserEmail)) {
                    pinnedFriends.push(pinnedUserEmail);

                    // Update the user's pinned friends list in Firestore
                    return userRef.update({
                        pinnedFriends: pinnedFriends
                    });
                } else {
                    console.log('This friend is already pinned.');
                }
            })
            .then(() => {
                // Refresh the list of pinned friends after updating Firestore
                loadPinnedFriends();
            })
            .catch((error) => {
                console.error('Error pinning friend: ', error);
            });
    } else {
        console.error('User not authenticated');
    }
};

const onlineFriendsList = document.getElementById('onlineFriends');
if (!onlineFriendsList) {
    console.error("onlineFriends element not found.");
    return;
}

                                        // Add click event to open chat
                                        friendName.onclick = () => openChat(friendEmail);

                                        // Append the friend's name and Unfriend button to the list item
                                        listItem.appendChild(statusIcon);
                                        listItem.appendChild(avatarContainer);
                                        listItem.appendChild(friendName);
                                        listItem.appendChild(pinnedFriendsButton);
                                        listItem.appendChild(viewFriendInfoButton);
                                        listItem.appendChild(unfriendButton);
                                        onlineFriendsList.appendChild(listItem);
                                    }
                                }
                            });
                        });
                }
            })
            .catch((error) => {
                console.error("Error fetching user data for accepted friends: ", error);
            });
    }
}     

function refreshOnlineFriends() {
    loadPinnedFriends(); // Call the loadPinnedFriends function here
}

document.getElementById('refreshPinnedButton').addEventListener('click', () => {
    refreshOnlineFriends();

    // Optional: Add a simple rotation animation
    const button = document.getElementById('refreshPinnedButton');
    button.style.transition = 'transform 0.5s ease-in-out';
    button.style.transform = 'rotate(360deg)';

    setTimeout(() => {
        button.style.transform = 'none';
    }, 500);
});

function loadPinnedFriends() {
    const currentUser = firebase.auth().currentUser;

    if (currentUser) {
        const currentUserUID = currentUser.uid;

        // Fetch the current user's pinned friends
        db.collection('pinnedFriends').doc(currentUserUID).get()
            .then((doc) => {
                if (doc.exists) {
                    const pinnedFriends = doc.data().pinnedFriends || [];
                    const pinnedFriendsList = document.getElementById('pinnedFriends');
                    pinnedFriendsList.innerHTML = ''; // Clear the list before appending new items

                    pinnedFriends.forEach((friendEmail) => {
                        // Fetch friend's information
                        db.collection('users').where('email', '==', friendEmail).get()
                            .then((querySnapshot) => {
                                querySnapshot.forEach((doc) => {
                                    const friend = doc.data();
                                    const friendDisplayName = friend.displayName === 'Anonymous' ? friend.email : friend.displayName;

                                    const listItem = document.createElement('li');
                                    listItem.classList.add('friend-item');

                                    // Create user avatar container
                                    const avatarContainer = document.createElement('div');
                                    avatarContainer.classList.add('user-avatar');
                                    loadFriendProfilePicture(friendEmail, avatarContainer); // Load friend profile picture

                                    // Create a span for the friend's name
                                    const friendName = document.createElement('span');
                                    friendName.textContent = friendDisplayName;
                                    friendName.classList.add('friend-name');
                                    
                                    // Append the friend's name to the list item
                                    listItem.appendChild(avatarContainer);
                                    listItem.appendChild(friendName);

                                    // Create and append Unfriend button
                                    const unfriendButton = createUnfriendButton(friendEmail);
                                    listItem.appendChild(unfriendButton);

                                    // Create the 'View Friend Info' button
                                    const viewFriendInfoButton = document.createElement('button');
                                    viewFriendInfoButton.innerHTML = `
                                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#000000" width="20" height="20">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                            <g id="SVGRepo_iconCarrier">
                                                <defs>
                                                    <style>
                                                        .a,.b{fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:1.5px;}
                                                        .a{stroke-linejoin:round;}
                                                        .b{stroke-linejoin:bevel;}
                                                    </style>
                                                </defs>
                                                <path class="a" d="M3,21.016l.78984-2.87249C5.0964,13.3918,8.5482,10.984,12,10.984"></path>
                                                <circle class="b" cx="12" cy="5.98404" r="5"></circle>
                                                <circle class="a" cx="17" cy="18" r="5"></circle>
                                                <line class="a" x1="17" x2="17" y1="17.34043" y2="20.51064"></line>
                                                <line class="a" x1="17" x2="17" y1="15.59574" y2="15.51064"></line>
                                            </g>
                                        </svg>
                                    `;

                                    viewFriendInfoButton.style.backgroundColor = 'var(--primary-color)';
                                    viewFriendInfoButton.style.border = 'none';
                                    viewFriendInfoButton.style.borderRadius = '50%';
                                    viewFriendInfoButton.style.marginLeft = '8px';
                                    viewFriendInfoButton.style.marginRight = '0';
                                    viewFriendInfoButton.style.padding = '6px';
                                    viewFriendInfoButton.style.cursor = 'pointer';
                                    viewFriendInfoButton.style.display = 'flex';
                                    viewFriendInfoButton.style.alignItems = 'center';
                                    viewFriendInfoButton.style.justifyContent = 'center';

                                    viewFriendInfoButton.addEventListener('mouseover', () => {
                                        viewFriendInfoButton.style.backgroundColor = '#3b7bce';
                                    });

                                    viewFriendInfoButton.addEventListener('mouseout', () => {
                                        viewFriendInfoButton.style.backgroundColor = 'var(--primary-color)';
                                    });

                                    viewFriendInfoButton.onclick = () => {
                                        const modal = document.getElementById('viewFriendModal');
                                        modal.style.display = 'block';
                                        document.getElementById('friendDisplayName').textContent = friendDisplayName;
                                        document.getElementById('friendEmail').textContent = friendEmail;
                                        document.getElementById('editFriendName').value = friendDisplayName;

                                        document.getElementById('saveFriendName').onclick = () => {
                                            const newFriendName = document.getElementById('editFriendName').value;
                                            if (newFriendName !== friendDisplayName) {
                                                saveFriendDisplayName(friendEmail, newFriendName);
                                            }
                                            modal.style.display = 'none';
                                        };
                                    };

// Create the 'Unpin' button
const unpinButton = document.createElement('button');
unpinButton.innerHTML = `
    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="20" height="20">
        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
        <g id="SVGRepo_iconCarrier">
            <path d="M17.1218 1.87023C15.7573 0.505682 13.4779 0.76575 12.4558 2.40261L9.75191 6.73289L11.1969 8.17793C11.2355 8.1273 11.2723 8.07415 11.3071 8.01845L14.1523 3.46191C14.493 2.91629 15.2528 2.8296 15.7076 3.28445L20.6359 8.21274C21.0907 8.66759 21.0041 9.42737 20.4584 9.76806L15.9019 12.6133C15.8462 12.6481 15.793 12.6848 15.7424 12.7234L17.1874 14.1684L21.5177 11.4645C23.1546 10.4424 23.4147 8.16307 22.0501 6.79852L17.1218 1.87023Z" fill="#ffffff"></path>
            <path d="M3.56525 8.85242C3.6015 8.26612 3.84962 7.68582 4.32883 7.27422L5.77735 8.72274C5.75784 8.72967 5.73835 8.7368 5.71886 8.74414C5.64516 8.7719 5.61855 8.80285 5.60548 8.82181C5.58877 8.84604 5.56651 8.8937 5.56144 8.97583C5.55046 9.15333 5.62872 9.40686 5.82846 9.6066L14.3137 18.0919C14.5135 18.2916 14.767 18.3699 14.9445 18.3589C15.0266 18.3538 15.0743 18.3316 15.0985 18.3149C15.1175 18.3018 15.1484 18.2752 15.1762 18.2015C15.1835 18.182 15.1907 18.1625 15.1976 18.143L16.6461 19.5915C16.2345 20.0707 15.6542 20.3188 15.0679 20.3551C14.2853 20.4035 13.4808 20.0874 12.8995 19.5061L9.36397 15.9705L2.68394 22.6506C2.29342 23.0411 1.66025 23.0411 1.26973 22.6506C0.879206 22.26 0.879206 21.6269 1.26973 21.2363L7.94975 14.5563L4.41425 11.0208C3.83293 10.4395 3.51687 9.63502 3.56525 8.85242Z" fill="#ffffff"></path>
            <path d="M2.00789 2.00786C1.61736 2.39838 1.61736 3.03155 2.00789 3.42207L20.5862 22.0004C20.9767 22.3909 21.6099 22.3909 22.0004 22.0004C22.391 21.6099 22.391 20.9767 22.0004 20.5862L3.4221 2.00786C3.03158 1.61733 2.39841 1.61733 2.00789 2.00786Z" fill="#ffffff"></path>
        </g>
    </svg>
`;
unpinButton.style.backgroundColor = 'var(--primary-color)';
unpinButton.style.border = 'none';
unpinButton.style.borderRadius = '50%';
unpinButton.style.marginLeft = '8px';
unpinButton.style.marginRight = '0';
unpinButton.style.padding = '6px';
unpinButton.style.cursor = 'pointer';
unpinButton.style.display = 'flex';
unpinButton.style.alignItems = 'center';
unpinButton.style.justifyContent = 'center';

unpinButton.addEventListener('mouseover', () => {
    unpinButton.style.backgroundColor = '#3b7bce';
});

unpinButton.addEventListener('mouseout', () => {
    unpinButton.style.backgroundColor = 'var(--primary-color)';
});

unpinButton.onclick = () => {
    const currentUser = firebase.auth().currentUser;
    if (currentUser) {
        const currentUserUID = currentUser.uid;
        
        // Get the friend's email to unpin
        const friendEmailToUnpin = friendEmail; // Use the variable for friend's email

        // Fetch the current user's pinned friends
        db.collection('pinnedFriends').doc(currentUserUID).get()
            .then((doc) => {
                if (doc.exists) {
                    let pinnedFriends = doc.data().pinnedFriends || [];
                    
                    // Remove the friend from the pinned friends list
                    pinnedFriends = pinnedFriends.filter(email => email !== friendEmailToUnpin);
                    
                    // Update the pinned friends list in Firestore
                    return db.collection('pinnedFriends').doc(currentUserUID).update({
                        pinnedFriends: pinnedFriends
                    });
                } else {
                    console.log('No pinned friends found');
                }
            })
            .then(() => {
                console.log('Friend unpinned successfully');
                // Optionally, you can refresh the list of pinned friends to reflect changes
                loadPinnedFriends();
            })
            .catch((error) => {
                console.error('Error unpinning friend:', error);
            });
    } else {
        console.log('No current user found');
    }
};


                                        // Add click event to open chat
                                        friendName.onclick = () => openChat(friendEmail);

                                    // Append buttons to the list item
                                    listItem.appendChild(unpinButton);
                                    listItem.appendChild(viewFriendInfoButton);
                                    listItem.appendChild(unfriendButton);


                                    // Append the list item to the pinnedFriendsList
                                    pinnedFriendsList.appendChild(listItem);
                                });
                            });
                    });
                } else {
                    console.log('No pinned friends found');
                }
            })
            .catch((error) => {
                console.error('Error fetching pinned friends:', error);
            });
    }
}

// Ensure this is called initially to load pinned friends on page load
refreshOnlineFriends();

        
function togglePinnedFriend(friendEmail, friendDisplayName, pinnedFriendsSet) {
    const currentUser = firebase.auth().currentUser;

    if (currentUser) {
        const currentUserEmail = currentUser.email;
        const userRef = db.collection('users').doc(currentUserEmail);

        userRef.get()
            .then((doc) => {
                if (doc.exists) {
                    const userData = doc.data();
                    let pinnedFriends = userData.pinnedFriends || [];

                    if (pinnedFriendsSet.has(friendEmail)) {
                        // Unpin friend
                        pinnedFriends = pinnedFriends.filter(email => email !== friendEmail);
                        pinnedFriendsSet.delete(friendEmail);
                    } else {
                        // Pin friend
                        pinnedFriends.push(friendEmail);
                        pinnedFriendsSet.add(friendEmail);
                    }

                    // Update the user's pinned friends list in Firestore
                    return userRef.update({
                        pinnedFriends: pinnedFriends
                    });
                } else {
                    console.error('User document does not exist');
                }
            })
            .then(() => {
                console.log(`${friendDisplayName} has been ${pinnedFriendsSet.has(friendEmail) ? 'pinned' : 'unpinned'}.`);
                refreshOnlineFriends(); // Refresh the friends list
            })
            .catch((error) => {
                console.error('Error updating pinned friends:', error);
            });
    } else {
        console.error('No user is signed in.');
    }
}


function createUnfriendButton(friendEmail) {
    const button = document.createElement('button');
    button.className = 'unfriend-button';
    button.onclick = () => unfriendUser(friendEmail);

    // Create SVG element
    const svgNS = 'http://www.w3.org/2000/svg';
    const svg = document.createElementNS(svgNS, 'svg');
    svg.setAttribute('viewBox', '0 0 24 24');
    svg.setAttribute('xmlns', svgNS);
    svg.setAttribute('fill', 'none');
    svg.setAttribute('stroke', '#ffffff'); // Set stroke color as per the SVG you provided

    // Define paths and shapes with slightly thicker stroke width
    const path = document.createElementNS(svgNS, 'path');
    path.setAttribute('d', 'M2.5,21.02394l.78984-2.87249C4.5964,13.39978,8.0482,10.992,11.5,10.992');
    path.setAttribute('stroke-width', '2'); // Slightly thicker stroke width
    path.setAttribute('class', 'a');

    const circle1 = document.createElementNS(svgNS, 'circle');
    circle1.setAttribute('cx', '11.5');
    circle1.setAttribute('cy', '5.99202');
    circle1.setAttribute('r', '5');
    circle1.setAttribute('stroke-width', '2'); // Slightly thicker stroke width
    circle1.setAttribute('class', 'b');

    const circle2 = document.createElementNS(svgNS, 'circle');
    circle2.setAttribute('cx', '16.5');
    circle2.setAttribute('cy', '18.00798');
    circle2.setAttribute('r', '5');
    circle2.setAttribute('stroke-width', '2'); // Slightly thicker stroke width
    circle2.setAttribute('class', 'a');

    const line = document.createElementNS(svgNS, 'line');
    line.setAttribute('x1', '14.5');
    line.setAttribute('x2', '18.5');
    line.setAttribute('y1', '18.00798');
    line.setAttribute('y2', '18.00798');
    line.setAttribute('stroke-width', '2'); // Slightly thicker stroke width
    line.setAttribute('class', 'a');

    // Append SVG elements to the SVG container
    svg.appendChild(path);
    svg.appendChild(circle1);
    svg.appendChild(circle2);
    svg.appendChild(line);

    // Append SVG to the button
    button.appendChild(svg);

    return button;
}

function createViewFriendInfoButton(friendEmail, friendDisplayName) {
    const button = document.createElement('button');
    button.classList.add('view-friend-info-button');

    // Add SVG directly into the button
    button.innerHTML = `
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><defs><style>.a,.b{fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:1.5px;}.a{stroke-linejoin:round;}.b{stroke-linejoin:bevel;}</style></defs><path class="a" d="M3,21.016l.78984-2.87249C5.0964,13.3918,8.5482,10.984,12,10.984"></path><circle class="b" cx="12" cy="5.98404" r="5"></circle><circle class="a" cx="17" cy="18" r="5"></circle><line class="a" x1="17" x2="17" y1="17.34043" y2="20.51064"></line><line class="a" x1="17" x2="17" y1="15.59574" y2="15.51064"></line></g></svg>
    `;

    button.onclick = () => {
        // Open the modal and display the friend's information
        const modal = document.getElementById('viewFriendModal');
        modal.style.display = 'block';
        document.getElementById('friendDisplayName').textContent = friendDisplayName;
        document.getElementById('friendEmail').textContent = friendEmail;
        document.getElementById('editFriendName').value = friendDisplayName;

        // Save the new friend display name
        document.getElementById('saveFriendName').onclick = () => {
            const newFriendName = document.getElementById('editFriendName').value;
            if (newFriendName !== friendDisplayName && newFriendName.trim() !== "") {
                // Logic to save the new friendDisplayName for the current user only
                saveFriendDisplayName(friendEmail, newFriendName)
                    .then(() => {
                        document.getElementById('friendDisplayName').textContent = newFriendName;
                    })
                    .catch((error) => {
                        console.error("Error saving new friend name: ", error);
                    });
            }
            modal.style.display = 'none';
        };
    };

    return button;
}


// Function to save the edited friendDisplayName for the current user
function saveFriendDisplayName(friendEmail, newFriendName) {
    const currentUser = firebase.auth().currentUser;
    if (currentUser) {
        const currentUserEmail = currentUser.email;
        db.collection('users').where('email', '==', currentUserEmail).get()
            .then((querySnapshot) => {
                if (!querySnapshot.empty) {
                    const userDoc = querySnapshot.docs[0];
                    userDoc.ref.update({
                        [`friendDisplayNames.${friendEmail}`]: newFriendName
                    }).then(() => {
                        console.log('Friend display name updated successfully.');
                    });
                }
            });
    }
}

// Close the modal
document.querySelector('.close-button3').onclick = function() {
    document.getElementById('viewFriendModal').style.display = 'none';
};


function unfriendUser(friendEmail) {
    const currentUser = firebase.auth().currentUser;

    if (currentUser) {
        const currentUserId = currentUser.uid;

        // Fetch the friend's user document
        db.collection('users').where('email', '==', friendEmail).get()
            .then((querySnapshot) => {
                if (!querySnapshot.empty) {
                    const friendDoc = querySnapshot.docs[0];
                    const friendId = friendDoc.id;
                    const friendDisplayName = friendDoc.data().displayName; // Assume displayName is stored in user data

                    // Show confirmation popup
                    const confirmation = confirm(`Are you sure you want to unfriend ${friendDisplayName}?`);

                    if (confirmation) {
                        // Update current user's accepted friends list
                        db.collection('users').doc(currentUserId).update({
                            acceptedFriends: firebase.firestore.FieldValue.arrayRemove(friendEmail)
                        }).catch((error) => {
                            console.error('Error removing from current user’s accepted friends list:', error);
                        });

                        // Update friend's accepted friends list
                        db.collection('users').doc(friendId).update({
                            acceptedFriends: firebase.firestore.FieldValue.arrayRemove(currentUser.email)
                        }).catch((error) => {
                            console.error('Error removing from friend’s accepted friends list:', error);
                        });

                        // Refresh the list of online friends
                        loadOnlineFriends();
                        loadPinnedFriends();
                    }
                }
            })
            .catch((error) => {
                console.error('Error fetching friend data:', error);
            });
    }
}


document.addEventListener("DOMContentLoaded", function() {
    const chatInputElement = document.getElementById('chatInput');
    const sendButton = document.querySelector('.chat-window button');
    const chatMessagesElement = document.getElementById('chatMessages');
    
    let chatId = ''; // Define chatId variable here

    // Function to update chatId based on the current chat
    function updateChatId(userEmail, chatFriend) {
        chatId = getChatId(userEmail, chatFriend);
        setupMessageListener(); // Set up message listener with the new chatId
    }

function sendMessage() {
    const chatInput = chatInputElement.value.trim();
    const currentUser = firebase.auth().currentUser;

    if (!chatInput || !currentUser) return; // Exit if no input or no current user

    if (currentGroupId) {
        // Sending a message to a group
        db.collection('groupchats').doc(currentGroupId).collection('messages').add({
            sender: currentUser.email,
            message: chatInput,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        }).then(() => {
            chatInputElement.value = ''; // Clear the input field after sending
        }).catch((error) => {
            console.error('Error sending group message: ', error);
        });
    } else if (currentChatFriend) {
        // Sending a message to an individual
        if (!chatId) {
            updateChatId(currentUser.email, currentChatFriend); // Ensure chatId is set
            // Wait for chatId to be updated before sending the message
            return; // Exit the function to wait for the chatId update
        }

        db.collection('chats').doc(chatId).collection('messages').add({
            sender: currentUser.email,
            recipient: currentChatFriend,
            message: chatInput,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        }).then(() => {
            chatInputElement.value = ''; // Clear the input field after sending
        }).catch((error) => {
            console.error('Error sending message: ', error);
        });
    } else {
        console.error('No recipient or group chat selected.');
    }
}

function scrollToBottom() {
    chatMessagesElement.scrollTop = chatMessagesElement.scrollHeight;
}

function setupMessageListener() {
    if (chatId) {
        db.collection('chats').doc(chatId).collection('messages')
            .orderBy('timestamp')
            .onSnapshot(snapshot => {
                snapshot.docChanges().forEach(change => {
                    if (change.type === 'added') {
                        // Code to display the message
                        scrollToBottom(); // Scroll to the bottom when a new message is added
                    }
                });
            });
    } else if (currentGroupId) {
        db.collection('groupchats').doc(currentGroupId).collection('messages')
            .orderBy('timestamp')
            .onSnapshot(snapshot => {
                snapshot.docChanges().forEach(change => {
                    if (change.type === 'added') {
                        // Code to display the message
                        scrollToBottom(); // Scroll to the bottom when a new message is added
                    }
                });
            });
    }
}

// Send message when the "Send" button is clicked
sendButton.addEventListener('click', sendMessage);

// Send message when the "Enter" key is pressed
chatInputElement.addEventListener('keydown', function(event) {
    if (event.key === 'Enter') {
        event.preventDefault(); // Prevents the default behavior of the "Enter" key
        sendMessage();
    }
});

// Example function to start or switch chats
function startChat(friendEmail) {
    const currentUser = firebase.auth().currentUser;
    if (currentUser) {
        updateChatId(currentUser.email, friendEmail);
    }
}

    // Use startChat(friendEmail) when starting or switching chats
});

let replies = {};

function openChat(friendEmail) {
    const chatWithSpan = document.getElementById('chatWith');
    const chatWindow = document.getElementById('chatMessages');
    const currentUser = firebase.auth().currentUser;
    const chatId = getChatId(currentUser.email, friendEmail);

    currentChatFriend = friendEmail;

    db.collection('users').where('email', '==', friendEmail).get()
        .then((querySnapshot) => {
            if (!querySnapshot.empty) {
                const friendDoc = querySnapshot.docs[0];
                const friendDisplayName = (friendDoc.data().displayName === 'Anonymous') ? friendEmail : friendDoc.data().displayName;
                chatWithSpan.textContent = friendDisplayName;

                db.collection('chats').doc(chatId).collection('messages')
                    .orderBy('timestamp', 'asc')
                    .onSnapshot((querySnapshot) => {
                        chatWindow.innerHTML = '';
                        querySnapshot.forEach((doc) => {
                            const message = doc.data();
                            const messageId = doc.id;
                            const senderEmail = message.sender;
                            const messageDiv = document.createElement('div');
                            messageDiv.classList.add('message-container');

                            // Sender display name
                            if (senderEmail !== currentUser.email) {
                                db.collection('users').where('email', '==', senderEmail).get()
                                    .then((querySnapshot) => {
                                        const senderDoc = querySnapshot.docs[0];
                                        const senderDisplayName = (senderDoc.data().displayName === 'Anonymous') ? senderEmail : senderDoc.data().displayName;
                                    });
                            }

                            const textElement = document.createElement('span');
                            textElement.classList.add('message-text');
                            textElement.textContent = message.message;
                            messageDiv.appendChild(textElement);

                            if (senderEmail === currentUser.email) {
                                messageDiv.classList.add('message', 'sent');
                            } else {
                                messageDiv.classList.add('message', 'received');
                            }

                            // Add options for reply and reactions
                            const optionsContainer = document.createElement('div');
                            optionsContainer.classList.add('message-options');
                            optionsContainer.style.display = 'none'; // Initially hidden

                            // Reaction options in the specified order
                            const reactions = ['❤️', '👍', '👎', '😆', '‼️', '?'];
                            reactions.forEach(reaction => {
                                const reactionButton = document.createElement('button');
                                reactionButton.textContent = reaction;
                                reactionButton.classList.add('reaction-button');
                                reactionButton.addEventListener('click', () => {
                                    addReactionToMessageV2(chatId, messageId, reaction);
                                });
                                optionsContainer.appendChild(reactionButton);
                            });

                            // Remove Reaction option
                            const removeReactionButton = document.createElement('button');
                            removeReactionButton.textContent = 'Remove'; // Changed from '❌' to 'Remove'
                            removeReactionButton.classList.add('remove-reaction-button');
                            removeReactionButton.addEventListener('click', () => {
                                removeReactionFromMessageV2(chatId, messageId);
                            });
                            optionsContainer.appendChild(removeReactionButton);

                            // Reply option (moved after the remove button)
                            const replyOption = document.createElement('button');
                            replyOption.textContent = 'Reply';
                            replyOption.classList.add('reply-option');
                            replyOption.addEventListener('click', (event) => {
                            event.stopPropagation(); // Prevent the click from affecting the parent elements
                            openReplyModal(chatId, messageId, message.message);
                            });
                            optionsContainer.appendChild(replyOption);

                            messageDiv.appendChild(optionsContainer);

                            messageDiv.addEventListener('click', () => {
                                optionsContainer.style.display = optionsContainer.style.display === 'none' ? 'flex' : 'none';
                            });

                            chatWindow.appendChild(messageDiv);

                            // Load reactions for this message
                            loadReactionsV2(chatId, messageId, messageDiv);

                            // Load replies for this message
                            loadReplies(chatId, messageId, messageDiv);

                            // Scroll to the bottom of the chat window after a new message is added
                            chatWindow.scrollTop = chatWindow.scrollHeight;
                        });
                    });
            }
        })
        .catch((error) => {
            console.error('Error fetching user data:', error);
        });
}


function openReplyModal(chatId, messageId, originalMessage) {
    const modal = document.getElementById('modal4');
    const modalMessage = document.getElementById('modal4Message');
    
    // Clear previous replies
    modalMessage.innerHTML = `<p>Replies to: "${originalMessage}"</p>`;
    
    // Fetch replies from Firestore
    db.collection('replies').where('messageId', '==', messageId).orderBy('timestamp', 'asc').get()
        .then((querySnapshot) => {
            querySnapshot.forEach((doc) => {
                const replyData = doc.data();
                const replyText = replyData.replyText;
                const sender = replyData.sender;

                const replyElement = document.createElement('p');
                replyElement.textContent = `${sender}: ${replyText}`;
                modalMessage.appendChild(replyElement);
            });

            modal.style.display = "block";
        })
        .catch((error) => {
            console.error('Error fetching replies from Firestore:', error);
        });

    const sendReplyButton = document.getElementById('sendReplyButton');
    sendReplyButton.onclick = () => {
        const replyText = document.getElementById('replyInput').value.trim();
        if (replyText) {
            addReplyToMessage(chatId, messageId, replyText);
            document.getElementById('replyInput').value = ''; // Clear the text area
        }
        modal.style.display = "none";
    };

    // Close the modal when clicking anywhere outside the modal content
    window.onclick = (event) => {
        if (event.target === modal) {
            modal.style.display = "none";
        }
    };
}


function addReplyToMessage(chatId, messageId, replyText) {
    const currentUser = firebase.auth().currentUser;
    
    if (!currentUser) {
        console.error('No current user logged in.');
        return;
    }

    // Add the reply to Firestore under the 'replies' collection
    db.collection('replies').add({
        chatId: chatId,
        messageId: messageId,
        sender: currentUser.email,
        replyText: replyText.trim(),
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
    })
    .then(() => {
        console.log('Reply successfully added to Firestore.');
        
        const messageDiv = document.querySelector(`[data-message-id="${messageId}"]`);
        if (messageDiv) {
            // Load and display replies for the updated message
            loadReplies(chatId, messageId, messageDiv); // Refresh replies and reply count
            
            // Fetch the updated count of replies
            db.collection('replies').where('messageId', '==', messageId).get().then((querySnapshot) => {
                const replyCount = querySnapshot.size;
                let replyCountText = messageDiv.querySelector('.reply-count');

                if (replyCountText) {
                    replyCountText.textContent = formatReplyCount(replyCount);
                } else {
                    replyCountText = document.createElement('span');
                    replyCountText.classList.add('reply-count');
                    replyCountText.textContent = formatReplyCount(replyCount);
                    messageDiv.appendChild(replyCountText);

                    // Add an event listener to the reply count to open the modal
                    replyCountText.addEventListener('click', (event) => {
                        event.preventDefault();
                        event.stopPropagation();
                        openReplyModal(chatId, messageId, replyText);
                    });
                }
            }).catch((error) => {
                console.error('Error fetching reply count from Firestore:', error);
            });
        } else {
            console.error('Message div not found for messageId:', messageId);
        }
    })
    .catch((error) => {
        console.error('Error adding reply to Firestore:', error);
    });
}

function formatReplyCount(count) {
    return `${count} repl${count > 1 ? 'ies' : 'y'}`;
}



function createMessageDiv(message, messageId) {
    const messageDiv = document.createElement('div');
    messageDiv.classList.add('message-container-2'); // Use the new class name
    messageDiv.setAttribute('data-message-id', messageId);

    // Create and append other elements like message text and options
    const textElement = document.createElement('span');
    textElement.classList.add('message-text');
    textElement.textContent = message.message;
    messageDiv.appendChild(textElement);

    // Add other elements such as options container, reactions, etc.

    return messageDiv;
}


function loadReplies(chatId, messageId, messageDiv) {
    // Real-time listener for replies of a specific message
    db.collection('replies').where('messageId', '==', messageId)
        .orderBy('timestamp', 'asc')
        .onSnapshot((querySnapshot) => {
            const replyCount = querySnapshot.size;
            let replyCountText = messageDiv.querySelector('.reply-count');

            if (replyCount > 0) {
                const replyText = `${replyCount} repl${replyCount === 1 ? 'y' : 'ies'}`;
                
                // If the reply count element exists, update it
                if (replyCountText) {
                    replyCountText.textContent = replyText;
                } else {
                    // If it doesn't exist, create it and append it to the messageDiv
                    replyCountText = document.createElement('span');
                    replyCountText.classList.add('reply-count');
                    replyCountText.textContent = replyText;
                    messageDiv.appendChild(replyCountText);

                    // Add an event listener to the reply count to open the modal
                    replyCountText.addEventListener('click', () => {
                        openReplyModal(chatId, messageId, messageDiv.querySelector('.message-text').textContent);
                    });
                }
            } else if (replyCountText) {
                // If no replies exist, remove the reply count element
                replyCountText.remove();
            }
        }, (error) => {
            console.error('Error loading replies from Firestore:', error);
        });
}


// Function to remove reaction
function removeReactionFromMessageV2(chatId, messageId) {
    db.collection('chats').doc(chatId).collection('messages').doc(messageId).update({
        reaction: firebase.firestore.FieldValue.delete()
    }).catch(error => {
        console.error("Error removing reaction: ", error);
    });
}

// Load Reactions
function loadReactionsV2(chatId, messageId, messageElement) {
    db.collection('chats').doc(chatId).collection('messages').doc(messageId)
        .onSnapshot((doc) => {
            if (doc.exists && doc.data().reaction) {
                const reaction = doc.data().reaction.reaction; // Only display the reaction emoji
                const currentUser = firebase.auth().currentUser.email; // Get the current user's email
                const sender = doc.data().sender; // Get the sender of the message
                
                const existingReactionIcon = messageElement.querySelector('.message-reaction');
                if (existingReactionIcon) {
                    existingReactionIcon.textContent = reaction; // Update existing reaction
                } else {
                    const reactionIcon = createReactionIconV2(reaction);

                    if (sender === currentUser) {
                        // If the current user sent the message, place the reaction at the top left with accent color
                        reactionIcon.style.position = 'absolute';
                        reactionIcon.style.top = '-8px';
                        reactionIcon.style.left = '-10px';
                        reactionIcon.style.backgroundColor = 'var(--accent-color)';
                    } else {
                        // For other users, keep the reaction on the top right with the primary color
                        reactionIcon.style.position = 'absolute';
                        reactionIcon.style.top = '-8px';
                        reactionIcon.style.right = '-10px';
                        reactionIcon.style.backgroundColor = 'var(--primary-color)';
                    }

                    messageElement.prepend(reactionIcon); // Add the reaction icon to the message element
                }
            }
        });
}

function createReactionIconV2(reaction) {
    const reactionElement = document.createElement('span');
    reactionElement.classList.add('message-reaction');
    reactionElement.textContent = reaction;
    return reactionElement;
}

// Add Reaction to Firestore
function addReactionToMessageV2(chatId, messageId, reaction) {
    db.collection('chats').doc(chatId).collection('messages').doc(messageId).set({
        reaction: {
            user: firebase.auth().currentUser.email,
            reaction: reaction
        }
    }, { merge: true }).catch((error) => {
        console.error('Error adding reaction:', error);
    });
}


function getChatId(userEmail, friendEmail) {
    return [userEmail, friendEmail].sort().join('_');
}

function getUserEmail(userId) {
    return db.collection('users').doc(userId).get().then((doc) => {
        return doc.data().email;
    });
}

let currentGroupId = null;

// Function to add friends to a group
function addToGroup() {
    const groupEmails = document.getElementById("groupEmails").value.trim();
    const emailsArray = groupEmails.split(',').map(email => email.trim()).filter(email => email !== '');

    if (emailsArray.length === 0) {
        alert("Please enter at least one friend's email.");
        return;
    }

    const currentUser = firebase.auth().currentUser;

    if (!currentUser) {
        alert("You need to be logged in to create a group.");
        return;
    }

    const groupName = `Group ${Date.now()}`; // Example default group name

    // Create the group in Firestore
    db.collection('groupchats').add({
        groupName: groupName,
        participants: emailsArray.concat(currentUser.email),
        createdBy: currentUser.email,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
    }).then((docRef) => {
        console.log('Group chat created with ID:', docRef.id);
        loadGroupChats(); // Reload the group chats after adding
    }).catch((error) => {
        console.error('Error creating group chat:', error);
    });

    document.getElementById("groupEmails").value = ""; // Clear the input field
}

function sendGroupMessage(groupId) {
    const messageText = document.getElementById("chatInput").value.trim();
    if (messageText === "") return;

    const currentUser = firebase.auth().currentUser;

    if (!currentUser || !groupId) return;

    // Fetch the group data to get participants
    db.collection('groupchats').doc(groupId).get().then((doc) => {
        if (doc.exists) {
            const group = doc.data();
            const participants = group.participants || [];

            // Store the message in the group's messages collection
            db.collection('groupchats').doc(groupId).collection('messages').add({
                sender: currentUser.email,
                message: messageText,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                document.getElementById("chatInput").value = ""; // Clear the input field
            }).catch((error) => {
                console.error("Error sending message:", error);
            });

            // Display the message in the chat window
            const chatMessages = document.getElementById('chatMessages');
            const messageElement = document.createElement('div');
            messageElement.classList.add('message');

            // Only show the display names of other participants, not the current user
            participants.forEach(email => {
                if (email !== currentUser.email) {
                    const nameElement = document.createElement('span');
                    nameElement.classList.add('message-sender');
                    nameElement.textContent = email;
                    messageElement.appendChild(nameElement);
                }
            });

            const textElement = document.createElement('span');
            textElement.classList.add('message-text');
            textElement.textContent = messageText;

            messageElement.appendChild(textElement);
            chatMessages.appendChild(messageElement);

            // Scroll to the bottom of the chat
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
    }).catch((error) => {
        console.error("Error fetching group data:", error);
    });
}

// Function to load group chats
function loadGroupChats() {
    const currentUser = firebase.auth().currentUser;

    if (!currentUser) return;

    db.collection('groupchats').where('participants', 'array-contains', currentUser.email)
        .onSnapshot((snapshot) => {
            const groupList = document.getElementById('groupList');
            groupList.innerHTML = '';

            snapshot.forEach((doc) => {
                const group = doc.data();
                const groupName = group.groupName || 'Unnamed Group';

                const groupItem = document.createElement('div');
                groupItem.classList.add('group-item');

                const groupNameElement = document.createElement('span');
                groupNameElement.textContent = groupName;
                groupNameElement.classList.add('group-name');
                groupItem.appendChild(groupNameElement);

// Button container
const buttonContainer = document.createElement('div');
buttonContainer.classList.add('buttons');

// View Members button with SVG in a smaller circle
const viewMembersButton = document.createElement('button');
viewMembersButton.innerHTML = `
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#ffffff" width="20" height="20">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M16 6C14.3432 6 13 7.34315 13 9C13 10.6569 14.3432 12 16 12C17.6569 12 19 10.6569 19 9C19 7.34315 17.6569 6 16 6ZM11 9C11 6.23858 13.2386 4 16 4C18.7614 4 21 6.23858 21 9C21 10.3193 20.489 11.5193 19.6542 12.4128C21.4951 13.0124 22.9176 14.1993 23.8264 15.5329C24.1374 15.9893 24.0195 16.6114 23.5631 16.9224C23.1068 17.2334 22.4846 17.1155 22.1736 16.6591C21.1979 15.2273 19.4178 14 17 14C13.166 14 11 17.0742 11 19C11 19.5523 10.5523 20 10 20C9.44773 20 9.00001 19.5523 9.00001 19C9.00001 18.308 9.15848 17.57 9.46082 16.8425C9.38379 16.7931 9.3123 16.7323 9.24889 16.6602C8.42804 15.7262 7.15417 15 5.50001 15C3.84585 15 2.57199 15.7262 1.75114 16.6602C1.38655 17.075 0.754692 17.1157 0.339855 16.7511C-0.0749807 16.3865 -0.115709 15.7547 0.248886 15.3398C0.809035 14.7025 1.51784 14.1364 2.35725 13.7207C1.51989 12.9035 1.00001 11.7625 1.00001 10.5C1.00001 8.01472 3.01473 6 5.50001 6C7.98529 6 10 8.01472 10 10.5C10 11.7625 9.48013 12.9035 8.64278 13.7207C9.36518 14.0785 9.99085 14.5476 10.5083 15.0777C11.152 14.2659 11.9886 13.5382 12.9922 12.9945C11.7822 12.0819 11 10.6323 11 9ZM3.00001 10.5C3.00001 9.11929 4.1193 8 5.50001 8C6.88072 8 8.00001 9.11929 8.00001 10.5C8.00001 11.8807 6.88072 13 5.50001 13C4.1193 13 3.00001 11.8807 3.00001 10.5Z" fill="#ffffff"></path>
    </svg>
`;


// Apply circular style and smaller size
viewMembersButton.style.backgroundColor = 'var(--primary-color)'; // Replace with your accent color variable or hex code
viewMembersButton.style.border = 'none';
viewMembersButton.style.borderRadius = '50%';
viewMembersButton.style.padding = '6px'; // Reduced padding for a smaller circle
viewMembersButton.style.cursor = 'pointer';
viewMembersButton.style.display = 'flex';
viewMembersButton.style.alignItems = 'center';
viewMembersButton.style.justifyContent = 'center';

// Hover effect to change color
viewMembersButton.addEventListener('mouseover', () => {
    viewMembersButton.style.backgroundColor = '#3b7bce';
});

viewMembersButton.addEventListener('mouseout', () => {
    viewMembersButton.style.backgroundColor = 'var(--primary-color)'; // Reset to the original color
});

viewMembersButton.onclick = () => {
    openViewMembersModal(doc.id);
};
buttonContainer.appendChild(viewMembersButton);



// Edit button
const editButton = document.createElement('button');
editButton.classList.add('edit-button');
editButton.innerHTML = `
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="-5.0 -10.0 110.0 135.0" fill="#ffffff" width="20" height="20">
        <path d="m33.332 50v12.5c0 2.3047 1.8672 4.168 4.168 4.168h12.5c1.1055 0 2.1641-0.4375 2.9453-1.2227l32.113-32.113c1.5742-1.5742 2.4414-3.6641 2.4414-5.8906 0-2.2266-0.86719-4.3203-2.4414-5.8906l-6.6094-6.6094c-3.2461-3.25-8.5352-3.25-11.785 0l-32.109 32.113c-0.78125 0.78125-1.2227 1.8398-1.2227 2.9453zm39.227-29.168 6.6094 6.6094-6.25 6.25-6.6094-6.6094zm-30.891 30.895 18.75-18.75 6.6094 6.6094-18.75 18.75h-6.6094zm50-1.7266c0 22.973-18.691 41.668-41.668 41.668s-41.668-18.695-41.668-41.668c0-22.977 18.691-41.668 41.668-41.668 2.3008 0 4.168 1.8672 4.168 4.168s-1.8672 4.168-4.168 4.168c-18.379 0-33.332 14.953-33.332 33.332s14.953 33.332 33.332 33.332 33.332-14.953 33.332-33.332c0-2.3008 1.8633-4.168 4.168-4.168s4.168 1.8672 4.168 4.168z"/>
    </svg>`;
editButton.style.backgroundColor = 'var(--primary-color)';
editButton.style.border = 'none';
editButton.style.borderRadius = '50%';
editButton.style.padding = '6px'; 
editButton.style.cursor = 'pointer';
editButton.style.display = 'flex';
editButton.style.alignItems = 'center';
editButton.style.justifyContent = 'center';
editButton.addEventListener('mouseover', () => {
    editButton.style.backgroundColor = '#2980b9';
});
editButton.addEventListener('mouseout', () => {
    editButton.style.backgroundColor = 'var(--primary-color)';
});
editButton.onclick = () => {
    editGroupChat(doc.id, groupName);
};
buttonContainer.appendChild(editButton);

// Delete button
const deleteButton = document.createElement('button');
deleteButton.classList.add('delete-button');
deleteButton.innerHTML = `
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="-5.0 -10.0 110.0 135.0" fill="#ffffff" width="20" height="20">
        <path d="m27.082 51.043c-1.832 0-3.582-0.33203-5.207-0.91797v31.125c0 5.168 4.207 9.375 9.375 9.375h37.5c5.168 0 9.375-4.207 9.375-9.375v-31.125c-1.625 0.58203-3.375 0.91797-5.207 0.91797zm17.711 23.957c0 1.707-1.418 3.125-3.125 3.125s-3.125-1.418-3.125-3.125v-12.5c0-1.707 1.418-3.125 3.125-3.125s3.125 1.418 3.125 3.125zm16.664 0c0 1.707-1.418 3.125-3.125 3.125s-3.125-1.418-3.125-3.125v-12.5c0-1.707 1.418-3.125 3.125-3.125s3.125 1.418 3.125 3.125zm11.461-53.125h-7.293v-3.125c0-5.168-4.207-9.375-9.375-9.375h-12.5c-5.168 0-9.375 4.207-9.375 9.375v3.125h-7.293c-5.168 0-9.375 4.207-9.375 9.375v4.168c0 5.168 4.207 9.375 9.375 9.375h45.832c5.168 0 9.375-4.207 9.375-9.375v-4.168c0-5.168-4.207-9.375-9.375-9.375zm-32.293-3.125c0-1.7227 1.4023-3.125 3.125-3.125h12.5c1.7227 0 3.125 1.4023 3.125 3.125v3.125h-18.75z"/>
    </svg>`;
deleteButton.style.backgroundColor = 'var(--accent-color)';
deleteButton.style.border = 'none';
deleteButton.style.borderRadius = '50%';
deleteButton.style.padding = '6px';
deleteButton.style.cursor = 'pointer';
deleteButton.style.display = 'flex';
deleteButton.style.alignItems = 'center';
deleteButton.style.justifyContent = 'center';
deleteButton.addEventListener('mouseover', () => {
    deleteButton.style.backgroundColor = '#c0392b';
});
deleteButton.addEventListener('mouseout', () => {
    deleteButton.style.backgroundColor = 'var(--accent-color)';
});
deleteButton.onclick = () => {
    deleteGroupChat(doc.id);
};
buttonContainer.appendChild(deleteButton);



groupItem.appendChild(buttonContainer);
groupList.appendChild(groupItem);


                groupItem.onclick = () => {
                    openGroupChat(doc.id);
                    currentGroupId = doc.id; // Set the current group ID
                };

                groupList.appendChild(groupItem);
            });
        });
}


function openViewMembersModal(groupId) {
    const modal = document.getElementById('viewMembersModal');
    const membersList = document.getElementById('membersList');
    membersList.innerHTML = '';

    db.collection('groupchats').doc(groupId).get().then((doc) => {
        const group = doc.data();
        const participants = group.participants;

        participants.forEach((participantEmail) => {
            db.collection('users').where('email', '==', participantEmail).get()
                .then((querySnapshot) => {
                    querySnapshot.forEach((userDoc) => {
                        const user = userDoc.data();

                        const memberItem = document.createElement('div');
                        memberItem.classList.add('member-item');

                        const nameElement = document.createElement('span');
                        nameElement.textContent = `${user.displayName} (${user.email})`;
                        memberItem.appendChild(nameElement);

                        const removeButton = document.createElement('button');
                        removeButton.classList.add('remove-member-button');
                        removeButton.innerHTML = `<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#000000">
                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                            <g id="SVGRepo_iconCarrier">
                                <defs>
                                    <style>
                                        .a,.b{fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:1.5px;}
                                        .a{stroke-linejoin:round;}
                                        .b{stroke-linejoin:bevel;}
                                    </style>
                                </defs>
                                <path class="a" d="M3,21.016l.78984-2.87249C5.0964,13.3918,8.5482,11.016,12,11.016"></path>
                                <circle class="b" cx="12" cy="5.98404" r="5"></circle>
                                <circle class="a" cx="17" cy="18" r="5"></circle>
                                <line class="a" x1="15.58579" x2="18.41421" y1="16.58579" y2="19.41421"></line>
                                <line class="a" x1="18.41421" x2="15.58579" y1="16.58579" y2="19.41421"></line>
                            </g>
                        </svg>`;
                        removeButton.onclick = () => {
                            removeUserFromGroupChat(groupId, user.email);
                        };
                        memberItem.appendChild(removeButton);

                        membersList.appendChild(memberItem);
                    });
                });
        });

        modal.style.display = 'block';
    });

    const closeBtn = document.querySelector('.modal2 .close');
    closeBtn.onclick = function () {
        modal.style.display = 'none';
    };
}

function removeUserFromGroupChat(groupId, userEmail) {
    db.collection('groupchats').doc(groupId).update({
        participants: firebase.firestore.FieldValue.arrayRemove(userEmail)
    }).then(() => {
        alert(`User ${userEmail} removed from the group chat.`);
        openViewMembersModal(groupId); // Refresh the modal view
    }).catch((error) => {
        console.error("Error removing user: ", error);
    });
}

function editGroupChat(groupId, currentGroupName) {
    const newGroupName = prompt('Enter the new group name:', currentGroupName);
    if (newGroupName && newGroupName.trim() !== '') {
        db.collection('groupchats').doc(groupId).update({
            groupName: newGroupName
        }).then(() => {
            console.log('Group name updated successfully!');
        }).catch((error) => {
            console.error('Error updating group name:', error);
        });
    }
}

function deleteGroupChat(groupId) {
    const confirmation = confirm('Are you sure you want to delete this group chat? This action cannot be undone.');
    if (confirmation) {
        db.collection('groupchats').doc(groupId).collection('messages').get().then((snapshot) => {
            const batch = db.batch();
            snapshot.forEach((doc) => {
                batch.delete(doc.ref);
            });
            return batch.commit();
        }).then(() => {
            return db.collection('groupchats').doc(groupId).delete();
        }).then(() => {
            console.log('Group chat deleted successfully!');
        }).catch((error) => {
            console.error('Error deleting group chat:', error);
        });
    }
}


// Function to open a group chat
function openGroupChat(groupId) {
    db.collection('groupchats').doc(groupId).get().then((doc) => {
        if (doc.exists) {
            const group = doc.data();
            document.getElementById('chatWith').textContent = group.groupName;
            loadGroupMessages(groupId);
        }
    }).catch((error) => {
        console.error('Error opening group chat:', error);
    });
}

function createAddFriendButton(friendEmail) {
    const button = document.createElement('button');
    button.className = 'add-friend-icon-button'; // Update class name
    button.onclick = () => sendFriendRequest(friendEmail);

    // Create SVG element
    const svgNS = 'http://www.w3.org/2000/svg';
    const svg = document.createElementNS(svgNS, 'svg');
    svg.setAttribute('viewBox', '0 0 24 24');
    svg.setAttribute('xmlns', svgNS);
    svg.setAttribute('fill', 'none'); // Set fill to none
    svg.setAttribute('stroke', '#ffffff'); // Set stroke color as per the SVG provided

    // Define styles for the SVG
    const style = document.createElementNS(svgNS, 'style');
    style.textContent = `
        .a, .b {
            fill: none;
            stroke: #ffffff;
            stroke-linecap: round;
            stroke-width: 1.5px;
        }
        .a {
            stroke-linejoin: round;
        }
        .b {
            stroke-linejoin: bevel;
        }
    `;
    svg.appendChild(style);

    // Define paths and shapes with correct stroke width and style
    const path = document.createElementNS(svgNS, 'path');
    path.setAttribute('d', 'M3,21.016l.78984-2.87249C5.0964,13.3918,8.5482,10.984,12,10.984');
    path.setAttribute('class', 'a');

    const circle1 = document.createElementNS(svgNS, 'circle');
    circle1.setAttribute('cx', '12');
    circle1.setAttribute('cy', '5.98404');
    circle1.setAttribute('r', '5');
    circle1.setAttribute('class', 'b');

    const circle2 = document.createElementNS(svgNS, 'circle');
    circle2.setAttribute('cx', '17');
    circle2.setAttribute('cy', '18');
    circle2.setAttribute('r', '5');
    circle2.setAttribute('class', 'a');

    const line1 = document.createElementNS(svgNS, 'line');
    line1.setAttribute('x1', '15');
    line1.setAttribute('x2', '19');
    line1.setAttribute('y1', '18');
    line1.setAttribute('y2', '18');
    line1.setAttribute('class', 'a');

    const line2 = document.createElementNS(svgNS, 'line');
    line2.setAttribute('x1', '17');
    line2.setAttribute('x2', '17');
    line2.setAttribute('y1', '16');
    line2.setAttribute('y2', '20');
    line2.setAttribute('class', 'a');

    // Append SVG elements to the SVG container
    svg.appendChild(path);
    svg.appendChild(circle1);
    svg.appendChild(circle2);
    svg.appendChild(line1);
    svg.appendChild(line2);

    // Append SVG to the button
    button.appendChild(svg);

    return button;
}

function createViewMembersButton() {
    const button = document.createElement('button');
    button.className = 'view-members-button'; // Update class name

    // Create SVG element
    const svgNS = 'http://www.w3.org/2000/svg';
    const svg = document.createElementNS(svgNS, 'svg');
    svg.setAttribute('viewBox', '0 0 24 24');
    svg.setAttribute('xmlns', svgNS);
    svg.setAttribute('fill', 'none'); // Set fill to none
    svg.setAttribute('stroke', '#ffffff'); // Set stroke color as per the SVG provided

    // Define paths and shapes with correct stroke width and style
    const path = document.createElementNS(svgNS, 'path');
    path.setAttribute('d', 'M3,21.016l.78984-2.87249C5.0964,13.3918,8.5482,10.984,12,10.984');
    path.setAttribute('stroke', '#ffffff'); // Ensure path stroke color
    path.setAttribute('stroke-width', '1.5');

    const circle1 = document.createElementNS(svgNS, 'circle');
    circle1.setAttribute('cx', '12');
    circle1.setAttribute('cy', '5.98404');
    circle1.setAttribute('r', '5');
    circle1.setAttribute('stroke', '#ffffff'); // Ensure circle stroke color
    circle1.setAttribute('stroke-width', '1.5');

    const circle2 = document.createElementNS(svgNS, 'circle');
    circle2.setAttribute('cx', '17');
    circle2.setAttribute('cy', '18');
    circle2.setAttribute('r', '5');
    circle2.setAttribute('stroke', '#ffffff'); // Ensure circle stroke color
    circle2.setAttribute('stroke-width', '1.5');

    const circle3 = document.createElementNS(svgNS, 'circle');
    circle3.setAttribute('cx', '17');
    circle3.setAttribute('cy', '18');
    circle3.setAttribute('r', '0.20745');
    circle3.setAttribute('stroke', '#ffffff'); // Ensure circle stroke color
    circle3.setAttribute('stroke-width', '1.5');

    const circle4 = document.createElementNS(svgNS, 'circle');
    circle4.setAttribute('cx', '14.35106');
    circle4.setAttribute('cy', '18');
    circle4.setAttribute('r', '0.20745');
    circle4.setAttribute('stroke', '#ffffff'); // Ensure circle stroke color
    circle4.setAttribute('stroke-width', '1.5');

    const circle5 = document.createElementNS(svgNS, 'circle');
    circle5.setAttribute('cx', '19.47832');
    circle5.setAttribute('cy', '18');
    circle5.setAttribute('r', '0.20745');
    circle5.setAttribute('stroke', '#ffffff'); // Ensure circle stroke color
    circle5.setAttribute('stroke-width', '1.5');

    // Append SVG elements to the SVG container
    svg.appendChild(path);
    svg.appendChild(circle1);
    svg.appendChild(circle2);
    svg.appendChild(circle3);
    svg.appendChild(circle4);
    svg.appendChild(circle5);

    // Append SVG to the button
    button.appendChild(svg);

    return button;
}


function sendFriendRequest(friendEmail) {
    const currentUser = firebase.auth().currentUser;

    if (currentUser) {
        const userId = currentUser.uid;

        db.collection('users').where('email', '==', friendEmail).get()
            .then((querySnapshot) => {
                if (querySnapshot.empty) {
                    console.error('User with this email does not exist.');
                    return;
                }

                const recipientDoc = querySnapshot.docs[0];
                const recipientId = recipientDoc.id;

                db.collection('friendRequests').add({
                    senderId: userId,
                    recipientId: recipientId,
                    status: 'pending',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                }).then(() => {
                    console.log('Friend request sent!');
                    alert('Friend request sent!');
                }).catch((error) => {
                    console.error('Error sending friend request:', error);
                });
            })
            .catch((error) => {
                console.error('Error fetching user data:', error);
            });
    }
}


function loadGroupMessages(groupId) {
    db.collection('groupchats').doc(groupId).collection('messages')
        .orderBy('timestamp')
        .onSnapshot((snapshot) => {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = ''; // Clear the chat window

            const messages = snapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));

            const fetchDisplayNamesPromises = messages.map(async (message) => {
                if (message.sender === firebase.auth().currentUser.email) {
                    return { ...message, senderDisplayName: null };
                } else {
                    const userSnapshot = await db.collection('users')
                        .where('email', '==', message.sender)
                        .get();

                    const senderDisplayName = !userSnapshot.empty 
                        ? userSnapshot.docs[0].data().displayName || message.sender 
                        : message.sender;

                    return { ...message, senderDisplayName };
                }
            });

            Promise.all(fetchDisplayNamesPromises).then(messagesWithDisplayNames => {
                messagesWithDisplayNames.forEach(message => {
                    const messageElement = document.createElement('div');
                    messageElement.classList.add('message-container');

                    if (message.senderDisplayName) {
                        const senderElement = document.createElement('span');
                        senderElement.classList.add('message-sender');
                        senderElement.textContent = `${message.senderDisplayName}: `;
                        messageElement.appendChild(senderElement);

                                                // Check if user is not friends with the sender
                        const currentUser = firebase.auth().currentUser;
                        db.collection('users').where('email', '==', message.sender).get()
                            .then((snapshot) => {
                                if (!snapshot.empty) {
                                    const friendData = snapshot.docs[0].data();
                                    if (friendData.acceptedFriends && !friendData.acceptedFriends.includes(currentUser.email)) {
                                        const addFriendButton = createAddFriendButton(message.sender);
                                        messageElement.appendChild(addFriendButton); // Append button to message container
                                    }
                                }
                            })
                            .catch((error) => {
                                console.error('Error checking friend status:', error);
                            });

                    }

                    const textElement = document.createElement('span');
                    textElement.classList.add('message-text');
                    textElement.textContent = message.message;
                    messageElement.appendChild(textElement);

                    if (message.sender === firebase.auth().currentUser.email) {
                        messageElement.classList.add('message', 'sent');
                    } else {
                        messageElement.classList.add('message', 'received');
                    }

                    const optionsContainer = document.createElement('div');
                    optionsContainer.classList.add('message-options');
                    optionsContainer.style.display = 'none'; // Initially hidden

                    // Reaction options
                    const reactions = ['👍', '👎', '❤️', '‼', '?'];
                    reactions.forEach(reaction => {
                        const reactionButton = document.createElement('button');
                        reactionButton.textContent = reaction;
                        reactionButton.classList.add('reaction-button');
                        reactionButton.addEventListener('click', () => {
                            addReactionToMessage(groupId, message.id, reaction);
                        });
                        optionsContainer.appendChild(reactionButton);
                    });

                    // Remove Reaction option
                    const removeReactionButton = document.createElement('button');
                    removeReactionButton.textContent = 'Remove';
                    removeReactionButton.classList.add('remove-reaction-button');
                    removeReactionButton.addEventListener('click', () => {
                        removeReactionFromMessage(groupId, message.id);
                    });
                    optionsContainer.appendChild(removeReactionButton);

                    messageElement.appendChild(optionsContainer);

                    messageElement.addEventListener('click', () => {
                        optionsContainer.style.display = optionsContainer.style.display === 'none' ? 'flex' : 'none';
                    });

                    chatMessages.appendChild(messageElement);

                    // Load reactions for this message
                    loadReactions(groupId, message.id, messageElement);
                });

                // Scroll to the bottom of the chat
                chatMessages.scrollTop = chatMessages.scrollHeight;
            });
        });
}

// Function to remove reaction
function removeReactionFromMessage(groupId, messageId) {
    db.collection('groupchats').doc(groupId).collection('messages').doc(messageId).update({
        reaction: firebase.firestore.FieldValue.delete()
    }).catch(error => {
        console.error("Error removing reaction: ", error);
    });
}

// Load Reactions
function loadReactions(groupId, messageId, messageElement) {
    db.collection('groupchats').doc(groupId).collection('messages').doc(messageId)
        .onSnapshot((doc) => {
            if (doc.exists && doc.data().reaction) {
                const reaction = doc.data().reaction.reaction; // Only display the reaction emoji
                const currentUser = firebase.auth().currentUser.email; // Get the current user's email
                const sender = doc.data().sender; // Get the sender of the message
                
                const existingReactionIcon = messageElement.querySelector('.message-reaction');
                if (existingReactionIcon) {
                    existingReactionIcon.textContent = reaction; // Update existing reaction
                } else {
                    const reactionIcon = createReactionIcon(reaction);

                    if (sender === currentUser) {
                        // If the current user sent the message, place the reaction at the top left with accent color
                        reactionIcon.style.position = 'absolute';
                        reactionIcon.style.top = '-8px';
                        reactionIcon.style.left = '-10px';
                        reactionIcon.style.backgroundColor = 'var(--accent-color)';
                    } else {
                        // For other users, keep the reaction on the top right with the primary color
                        reactionIcon.style.position = 'absolute';
                        reactionIcon.style.top = '-8px';
                        reactionIcon.style.right = '-10px';
                        reactionIcon.style.backgroundColor = 'var(--primary-color)';
                    }

                    messageElement.prepend(reactionIcon); // Add the reaction icon to the message element
                }
            }
        });
}

function createReactionIcon(reaction) {
    const reactionElement = document.createElement('span');
    reactionElement.classList.add('message-reaction');
    reactionElement.textContent = reaction;
    return reactionElement;
}

// Add Reaction to Firestore
function addReactionToMessage(groupId, messageId, reaction) {
    db.collection('groupchats').doc(groupId).collection('messages').doc(messageId).set({
        reaction: {
            user: firebase.auth().currentUser.email,
            reaction: reaction
        }
    }, { merge: true }).catch((error) => {
        console.error('Error adding reaction:', error);
    });
}

// Call this function after user logs in to load existing group chats
firebase.auth().onAuthStateChanged(user => {
    if (user) {
        loadGroupChats();
    }
});

document.getElementById('refreshButton').addEventListener('click', loadOnlineFriends);

</script>


<script>
    async function toggleNightMode() {
        document.body.classList.toggle('night-mode');
        const isNightMode = document.body.classList.contains('night-mode');

        // Update localStorage
        localStorage.setItem('nightMode', isNightMode ? 'enabled' : 'disabled');

        // Save the theme preference to Firestore
            try {
                const user = firebase.auth().currentUser;
                if (user) {
                    const userId = user.uid;
                    await db.collection('users').doc(userId).set({
                        nightMode: isNightMode ? 'enabled' : 'disabled'
                    }, { merge: true });
                } else {
                    console.error('No user is signed in');
                }
            } catch (error) {
                console.error('Error updating Firestore:', error);
            }

            // Update theme icon
            updateThemeIcon(isNightMode ? 'moon' : 'sun');
        }
    function updateThemeIcon(state) {
        const themeIcon = document.getElementById('theme-icon');
        const themeContainer = document.querySelector('.theme-icon');

        // Animation effect
        themeContainer.classList.add('active');

        setTimeout(() => {
            if (state === 'moon') {
                themeIcon.innerHTML = `<path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>`;
                themeIcon.dataset.state = 'sun';
            } else {
                themeIcon.innerHTML = `<path d="M14.5739 1.11056L13.7826 2.69316C13.7632 2.73186 13.7319 2.76325 13.6932 2.7826L12.1106 3.5739C11.9631 3.64761 11.9631 3.85797 12.1106 3.93167L13.6932 4.72297C13.7319 4.74233 13.7632 4.77371 13.7826 4.81241L14.5739 6.39502C14.6476 6.54243 14.858 6.54243 14.9317 6.39502L15.723 4.81241C15.7423 4.77371 15.7737 4.74232 15.8124 4.72297L17.395 3.93167C17.5424 3.85797 17.5424 3.64761 17.395 3.5739L15.8124 2.7826C15.7737 2.76325 15.7423 2.73186 15.723 2.69316L14.9317 1.11056C14.858 0.963147 14.6476 0.963148 14.5739 1.11056Z" fill="#FFFFFF"></path> <path d="M19.2419 5.07223L18.4633 7.40815C18.4434 7.46787 18.3965 7.51474 18.3368 7.53464L16.0009 8.31328C15.8185 8.37406 15.8185 8.63198 16.0009 8.69276L18.3368 9.4714C18.3965 9.4913 18.4434 9.53817 18.4633 9.59789L19.2419 11.9338C19.3027 12.1161 19.5606 12.1161 19.6214 11.9338L20.4 9.59789C20.42 9.53817 20.4668 9.4913 20.5265 9.4714L22.8625 8.69276C23.0448 8.63198 23.0448 8.37406 22.8625 8.31328L20.5265 7.53464C20.4668 7.51474 20.42 7.46787 20.4 7.40815L19.6214 5.07223C19.5606 4.88989 19.3027 4.88989 19.2419 5.07223Z" fill="#FFFFFF"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M10.4075 13.6642C13.2348 16.4915 17.6517 16.7363 20.6641 14.3703C20.7014 14.341 20.7385 14.3113 20.7754 14.2812C20.9148 14.1674 21.051 14.0479 21.1837 13.9226C21.2376 13.8718 21.2909 13.8201 21.3436 13.7674C21.8557 13.2552 22.9064 13.5578 22.7517 14.2653C22.6983 14.5098 22.6365 14.7517 22.5667 14.9905C22.5253 15.1321 22.4811 15.2727 22.4341 15.4122C22.4213 15.4502 22.4082 15.4883 22.395 15.5262C20.8977 19.8142 16.7886 23.0003 12 23.0003C5.92487 23.0003 1 18.0754 1 12.0003C1 7.13315 4.29086 2.98258 8.66889 1.54252L8.72248 1.52504C8.8185 1.49401 8.91503 1.46428 9.01205 1.43587C9.26959 1.36046 9.5306 1.29438 9.79466 1.23801C10.5379 1.07934 10.8418 2.19074 10.3043 2.72815C10.251 2.78147 10.1987 2.83539 10.1473 2.88989C10.0456 2.99777 9.94766 3.10794 9.8535 3.22023C9.83286 3.24485 9.8124 3.26957 9.79212 3.29439C7.32966 6.30844 7.54457 10.8012 10.4075 13.6642ZM8.99331 15.0784C11.7248 17.8099 15.6724 18.6299 19.0872 17.4693C17.4281 19.6024 14.85 21.0003 12 21.0003C7.02944 21.0003 3 16.9709 3 12.0003C3 9.09163 4.45653 6.47161 6.66058 4.81846C5.41569 8.27071 6.2174 12.3025 8.99331 15.0784Z" fill="#FFFFFF"></path>`;
                themeIcon.dataset.state = 'moon';
            }
            themeContainer.classList.remove('active');
        }, 500); // Duration matches the CSS animation duration
    }

        // Check Firestore for night mode preference
        document.addEventListener('DOMContentLoaded', async (event) => {
            try {
                firebase.auth().onAuthStateChanged(async (user) => {
                    if (user) {
                        const userId = user.uid;
                        try {
                            const doc = await db.collection('users').doc(userId).get();
                            const nightMode = doc.exists ? doc.data().nightMode : null;
                            if (nightMode === 'enabled') {
                                document.body.classList.add('night-mode');
                                updateThemeIcon('moon');
                            } else {
                                updateThemeIcon('sun');
                            }
                        } catch (error) {
                            console.error('Error fetching Firestore document:', error);
                        }

                        // Event listener for toggle button
                        document.getElementById('toggleNightMode').addEventListener('click', toggleNightMode);
                    } else {
                        console.error('No user is signed in');
                    }
                });
            } catch (error) {
                console.error('Error initializing Firebase Authentication:', error);
            }
        });

    // Event listener for toggle button
    document.getElementById('toggleNightMode').addEventListener('click', toggleNightMode);

</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const modal = document.getElementById('bugModal');
    const closeModalBtn = document.getElementById('closeModal');
    const disableModalBtn = document.getElementById('disableModal');

    // Check if the modal should be shown
    if (localStorage.getItem('modalDisabled') === 'true') {
        modal.style.display = 'none';
    } else {
        modal.style.display = 'flex'; // Display the modal by default
    }

    // Close modal
    closeModalBtn.addEventListener('click', function() {
        modal.style.display = 'none';
    });

    // Disable modal for current user
    disableModalBtn.addEventListener('click', function() {
        // Set a flag in localStorage to remember the user's preference
        localStorage.setItem('modalDisabled', 'true');
        modal.style.display = 'none';
    });
});
</script>

<script>
document.getElementById('refreshButton').addEventListener('click', () => {
    const button = document.getElementById('refreshButton');
    button.style.transition = 'transform 0.5s ease-in-out';
    button.style.transform = 'rotate(360deg)';

    // Reset the transform after the animation is done
    setTimeout(() => {
        button.style.transform = 'none';
    }, 500);
});
</script>


<script>
function loadSmallProfilePicture() {
    const currentUser = firebase.auth().currentUser;
    const avatarContainer = document.getElementById('smallProfilePictureContainer');
    const defaultAvatar = document.getElementById('defaultAvatar');

    if (currentUser) {
        const uid = currentUser.uid;
        const userDocRef = firestore.collection('users').doc(uid);

        userDocRef.get().then(doc => {
            if (doc.exists) {
                const data = doc.data();
                const profilePictureUrl = data.profilePicture;

                if (profilePictureUrl) {
                    // Create and append the new profile picture
                    const img = document.createElement('img');
                    img.src = profilePictureUrl;
                    img.alt = 'Profile Picture';
                    img.style.width = '40px'; // Ensure the image has the same size as the SVG
                    img.style.height = '40px';
                    img.style.borderRadius = '50%';

                    // Replace the SVG with the new image
                    avatarContainer.innerHTML = '';  // Clear the current content
                    avatarContainer.appendChild(img);
                } else {
                    console.log("No profile picture set for user.");
                }
            } else {
                console.error("No user document found.");
            }
        }).catch(error => {
            console.error("Error loading profile picture: ", error);
        });
    } else {
        console.error("User is not authenticated.");
    }
}

// Call the function when the page loads
document.addEventListener('DOMContentLoaded', function() {
    firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
            loadSmallProfilePicture();
        }
    });
});

</script>
    
<script>
function loadFriendProfilePicture(friendEmail, avatarContainer) {
    const defaultAvatar = document.getElementById('defaultAvatar');

    // Fetch the friend's document based on their email
    db.collection('users').where('email', '==', friendEmail).get()
        .then((querySnapshot) => {
            if (!querySnapshot.empty) {
                const friendDoc = querySnapshot.docs[0];
                const data = friendDoc.data();
                const profilePictureUrl = data.profilePicture;

                if (profilePictureUrl) {
                    // Create and append the new profile picture
                    const img = document.createElement('img');
                    img.src = profilePictureUrl;
                    img.alt = 'Friend Profile Picture';
                    img.style.width = '40px'; // Ensure the image has the same size as the SVG
                    img.style.height = '40px';
                    img.style.borderRadius = '50%';

                    // Replace the SVG with the new image
                    avatarContainer.innerHTML = '';  // Clear the current content
                    avatarContainer.appendChild(img);
                } else {
                    // Use default avatar if no profile picture is set
                    const defaultAvatarClone = defaultAvatar.cloneNode(true);
                    avatarContainer.innerHTML = ''; // Clear the current content
                    avatarContainer.appendChild(defaultAvatarClone);
                }
            } else {
                console.error("No document found for friend with email: ", friendEmail);
                // Use default avatar if no document is found
                const defaultAvatarClone = defaultAvatar.cloneNode(true);
                avatarContainer.innerHTML = ''; // Clear the current content
                avatarContainer.appendChild(defaultAvatarClone);
            }
        }).catch(error => {
            console.error("Error loading friend's profile picture: ", error);
            // Use default avatar on error
            const defaultAvatarClone = defaultAvatar.cloneNode(true);
            avatarContainer.innerHTML = ''; // Clear the current content
            avatarContainer.appendChild(defaultAvatarClone);
        });
}

</script>

<script>
    document.querySelector('.sidebar-toggle').addEventListener('click', () => {
        document.querySelector('.sidebar').classList.toggle('active');
    });
</script>


</body>
</html>

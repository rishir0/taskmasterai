<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="theme.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <style>
     :root {
        --primary-color: #6C63FF;
            --secondary-color: #3F3D56;
            --accent-color: #F50057;
            --text-color: #F8F9FA;
            --bg-color: #121212;
            --card-bg: #1E1E1E;
    --glass-bg: rgba(255, 255, 255, 0.1); /* Frosted Glass Effect */
    --hover-bg: rgba(255, 255, 255, 0.1); /* Slightly Darker Hover Background */
    --border-radius: 15px;
}


* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Poppins', sans-serif;
    line-height: 1.6;
    color: var(--text-color);
    background-color: var(--bg-color); /* Solid dark background */
    backdrop-filter: blur(10px); /* Optional: keeps the frosted glass effect */
}


body.night-mode {
    background-color: #333333;
    primary-color: #121212; /* Darker background */
    secondary-color: #1E1E1E; /* Darker grayish background */
    accent-color: #009bf5; /* Adjust if necessary */
    text-color: #e0e0e0; /* Lighter text color for dark mode */
    --bg-color: rgba(18, 18, 18, 0.8); /* Darker background */
   --card-bg: #1E1E1E;
    --glass-bg: rgba(18, 18, 18, 0.8); /* Darker frosted glass effect */
    --hover-bg: rgba(30, 30, 30, 0.9); /* Darker hover background */
}
}

.menu-item {
    display: flex;
    align-items: center;
    cursor: pointer;
    padding: 8px 16px;
    border-radius: 4px;
    transition: background-color 0.3s;
}

.menu-item:hover {
    
}

.theme-icon {
    margin-right: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
}

.theme-icon.active {
    animation: rotate 0.5s ease-in-out;
}

@keyframes rotate {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(360deg);
    }
}



.container {
    display: flex;
    height: 100vh;
}

.sidebar {
    width: 250px;
    min-width: 250px; /* Ensure minimum width is always maintained */
    max-width: 250px; /* Ensure maximum width is always maintained */
    background: inherit;
    padding: 20px;
    display: flex;
    flex-direction: column;
    height: 100%;
    border-radius: var(--border-radius);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
}

.sidebar h1 {
    font-size: 24px;
    margin-bottom: 20px;
}

.sidebar ul {
    list-style: none;
    padding: 0;
}

.sidebar ul li {
    margin-bottom: 20px;
}

.sidebar ul li a {
    text-decoration: none;
    color: var(--secondary-color);
    font-size: 18px;
    transition: color 0.3s ease;
}

.sidebar ul li a:hover {
    color: var(--primary-color);
}

.logo {
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--primary-color);
    display: flex;
    align-items: center;
    margin-bottom: 30px;
}

.logo svg {
    width: 30px;
    height: 30px;
    margin-right: 10px;
}

.menu-item {
    margin-bottom: 15px;
    color: var(--text-color);
    cursor: pointer;
    transition: color 0.3s ease;
    display: flex;
    align-items: center;
    transition: transform 0.3s ease;
}

.menu-item svg {
    width: 20px;
    height: 20px;
    margin-right: 10px;
}

.menu-item:hover {
    
    transform: scale(1.1);
}

.upgrade-btn {
    background: linear-gradient(45deg, var(--accent-color), #FF1493);
    color: var(--text-color);
    border: none;
    padding: 10px 20px;
    border-radius: 50px;
    cursor: pointer;
    margin-top: 20px;
    font-weight: 600;
    display: flex;
    align-items: center;
    transition: background-color 0.3s ease, transform 0.3s ease;
    backdrop-filter: blur(10px);
    background-color: rgba(255, 255, 255, 0.1);
}

.upgrade-btn svg {
    width: 20px;
    height: 20px;
    margin-right: 10px;
}

.upgrade-btn:hover {
    transform: scale(1.05);
}

.main-content {
    flex-grow: 1;
    padding: 20px;
    overflow-y: auto;
    background: transparent;
}

.dashboard-header {
    margin-bottom: 30px;
}

.dashboard-header h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
}

.create-new {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.item {
    background-color: var(--glass-bg);
    padding: 15px;
    border-radius: var(--border-radius);
    margin-bottom: 10px;
    transition: background-color 0.3s ease, transform 0.3s ease;
    display: flex;
    justify-content: space-between;
    align-items: center;
    backdrop-filter: blur(10px);
}

.item:hover {
    background-color: var(--hover-bg);
    transform: scale(1.05);
    backdrop-filter: blur(10px);
}

.user-profile {
    display: flex;
    align-items: center;
    margin-top: auto;
    padding-top: 20px;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--primary-color);
    margin-right: 10px;
    transition: transform 0.3s ease, background-color 0.3s ease;
}

.user-avatar:hover {
    transform: scale(1.1);
    color: var(--text-color);
}

.account-button {
    background: none;
    border: none;
    color: var(--text-color);
    cursor: pointer;
    display: flex;
    align-items: center;
    padding: 0;
    transition: color 0.3s ease, transform 0.3s ease, background-color 0.3s ease;
}

.account-button:hover {
    transform: scale(1.05);
}

.account-button:focus {
    outline: none;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--accent-color); /* Initial color is accent color */
    margin-right: 10px;
    transition: transform 0.3s ease, background-color 0.3s ease;
}

.user-avatar:hover {
    transform: scale(1.1);
}

/* Existing styles */
.sidebar-toggle {
    display: none;
    position: fixed;
    top: 20px;
    right: 20px;
    background-color: var(--hover-bg);
    color: var(--text-color);
    border: none;
    padding: 10px;
    border-radius: 5px;
    cursor: pointer;
    z-index: 1000;
}

.sidebar-toggle svg {
    width: 24px;
    height: 24px;
}

/* Mobile styles */
@media (max-width: 768px) {
    .sidebar {
        display: none;
        position: fixed;
        left: 0;
        top: 0;
        height: 100%;
        width: 250px; /* Adjust width as needed */
        background-color: #333; /* Solid color, adjust as needed */
        color: var(--text-color);
        padding: 20px; /* Adjust padding as needed */
        z-index: 1000;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2); /* Optional shadow for better depth */
        border-radius: 0; /* No rounded corners */
    }
    .sidebar.active {
        display: flex;
    }
    .sidebar-toggle {
        display: block;
    }
    .main-content {
        padding-left: 20px;
        margin-left: 0;
    }
}

/* Animation for SVG */
@keyframes rotateIcon {
    0% {
        transform: rotate(0deg);
    }
    50% {
        transform: rotate(180deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

.theme-icon {
    display: inline-block;
    transition: transform 0.5s;
}

.theme-icon svg {
    transition: fill 0.5s;
}

.theme-icon.active svg {
    animation: rotateIcon 0.5s;
}

        .notes-dashboard-container {
            display: flex;
            align-items: center;
        }

.beta-tag {
    background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
    background-size: 200% 200%;
    color: var(--text-color);
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 600;
    margin-left: 10px;
    animation: swish-gradient 3s infinite ease-in-out;
}

@keyframes swish-gradient {
    0% {
        background-position: 0% 50%;
    }
    50% {
        background-position: 100% 50%;
    }
    100% {
        background-position: 0% 50%;
    }
}





/* General container styling */
.main-content {
    padding: 20px;
}

/* Main headings */
.main-heading {
    font-size: 2.5rem; /* Ensure this is the size of the text */
    margin-bottom: 10px;
    color: var(--heading-color, #ffffff);
    display: flex;
    align-items: center;
}

/* Mobile styles */
@media (max-width: 768px) {

    .main-heading {
        font-size: 1.8rem; /* Decrease font size for smaller screens */
        flex-direction: column; /* Stack items vertically if needed */
        word-wrap: break-word; /* Allow text to wrap */
        text-align: center; /* Center align text for better appearance */
        margin-bottom: 25px;

    }
    
/* Adjusting .svg-icon */
.svg-icon {
    width: 2.5rem; /* Decrease size for smaller screens */
    height: 2.5rem;
    margin-bottom: 10px; /* Add vertical space between the icon and text */
}


    /* Adjusting .sub-heading */
    .sub-heading {
        font-size: 1.2rem; /* Reduce font size for mobile */
        margin-bottom: 0; /* Remove negative margin for better spacing */
        margin-left: 0; /* Reset margin-left to align properly */
        text-align: center; /* Center align text for better appearance */
        word-wrap: break-word; /* Allow text to wrap */
        flex-direction: column; /* Stack items vertically if needed */
        width: 125%; /* Ensure it doesn’t overflow */
        max-width: 290%; /* Prevents horizontal overflow */
    }


    

    /* Adjusting .beta-tag */
    .beta-tag {
        font-size: 0.65rem; /* Slightly smaller font size for mobile */
        padding: 2px 6px; /* Adjust padding for better fit */
        margin-left: 5px; /* Reduce left margin for better spacing */
        margin-bottom: -10px; /* Adjust margin for better alignment */
    }
}


/* SVG icon */
.svg-icon {
    width: 3.3rem; /* Match the font size of the heading */
    height: 3.3rem;
    margin-right: 10px;
    display: inline-block;
    margin-bottom: -20px;
    
}

.svg-icon svg {
    fill: #ffffff !important; /* Make the SVG white */  
    width: 100%;
    height: 100%;
}



.sub-heading {
    font-size: 1.5rem;
    color: var(--sub-heading-color, #666);
    margin-bottom: -60px;
    margin-left: -412px;
    font-weight: normal !important; /* Set font weight to normal and apply !important */
}


/* Cards for note options */
.note-options-container {
    display: flex;
    gap: 20px;
    margin-bottom: 40px;
}

.note-option-card {
    background-color: var(--card-bg, #f5f5f5);
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    flex: 1;
    transition: transform 0.3s ease, background-color 0.3s ease;
    cursor: pointer;
    margin-top: 20px;
    position: relative;
    display: flex;
    justify-content: space-between; /* Align text and SVG */
    align-items: center;
}

.svg-container {
    display: flex;
    align-items: center;
    justify-content: flex-end;
}

.arrow-icon {
    width: 54px;
    height: 54px;
    fill: #777777; /* Ensure the arrow icon is white */
    margin-bottom: -10px;
}

.unavailable-tag {
    background-color: var(--danger-hover-color, #c9302c);
    color: var(--text-color, #fff);
    padding: 2px 6px;
    border-radius: var(--border-radius, 8px);
    font-size: 0.8rem;
    display: inline-flex;
    align-items: center;
    position: absolute; /* Change to absolute positioning */
    bottom: 10px; /* Distance from the bottom */
    right: 10px; /* Distance from the right */
    margin-left: 0; /* Reset margin */
    margin-right: 0; /* Reset margin */
}

.unavailable-icon {
    width: 16px; /* Smaller icon size */
    height: 16px; /* Maintain aspect ratio */
    margin-left: 4px; /* Space between text and icon */
}

.card-content {
    display: flex;
    align-items: center;
}

.icon-container {
    margin-right: 15px;
    display: flex;
    align-items: center;
}

.text-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
}



.audio-icon {
    fill: var(--accent-color, #6823ff); /* Audio icon color */
}

.pdf-icon {
    fill: var(--accent-color, #6517FF); /* PDF icon color */
}

.note-option-card h4,
.note-option-card p {
    margin: 0;
}

.note-option-card:hover {
    transform: translateY(-8px);
    
}

.note-option-card h4 {
    font-size: 1.25rem;
    margin-bottom: 5px;
    color: var(--text-color, #333);
}

.note-option-card p {
    font-size: 1rem;
    color: var(--sub-text-color, #777);
}

/* Add mobile styles */
@media (max-width: 768px) {
    .note-options-container {
        flex-direction: column; /* Stack cards vertically */
        gap: 10px; /* Reduced gap between cards */
    }

    .note-option-card {
        width: 100%; /* Full width for cards */
        margin-top: 0; /* Remove top margin for stacked layout */
    }
    
    .unavailable-tag {
        bottom: 5px; /* Adjust position */
        right: 5px; /* Adjust position */
        font-size: 0.7rem; /* Smaller font size */
    }

    .note-option-card h4 {
        font-size: 1.1rem; /* Adjust heading size */
    }

    .note-option-card p {
        font-size: 0.9rem; /* Adjust paragraph size */
    }
}

.all-notes-section {
    display: flex; /* Use flexbox for alignment */
    align-items: center; /* Center align the items vertically */
}

.section-heading {
    font-size: 2rem;
    color: var(--heading-color, #ffffff);
    margin-right: 10px; /* Reduced margin to bring the button closer */
}

.create-note-btn {
    background-color: var(--primary-color, #f5f5f5); /* Changed to card-bg color */
    color: var(--text-color, #fff);
    border: none;
    padding: 5px 5px; /* Increased padding for a bigger button */
    border-radius: 50px; /* Made it round */
    cursor: pointer;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    margin-left: 0; /* Align to the left, adjust if needed */
    display: inline-flex; /* Makes it easier to align with the SVG */
    align-items: center; /* Vertically centers content within the button */
    
}



.create-note-btn:hover {
    background-color: var(--accent-color, #0056b3);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}


/* Notes list styling */
#notes-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

/* Manual notes section */
.note-card {
    background-color: var(--card-bg, #f5f5f5);
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
}

.note-card textarea {
    width: 100%;
    padding: 10px;
    border-radius: 5px;
    border: 1px solid var(--input-border, #ccc);
    margin-bottom: 10px;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

.note-card textarea:focus {
    border-color: var(--accent-color, #0056b3);
    box-shadow: 0 0 5px rgba(0, 86, 179, 0.3);
}

.create-manual-note-btn {
    background-color: var(--primary-color, #007BFF);
    color: var(--text-color, #fff);
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
}

.create-manual-note-btn:hover {
    background-color: var(--accent-color, #0056b3);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}



.dev-tag {
    background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
    color: #ffffff;
    padding: 2px 4px;
    font-size: 0.75em;
    border-radius: 3px;
    margin-left: 5px;
}

.basic-tag {
    background: var(--primary-color);
    color: #ffffff;
    padding: 2px 4px;
    font-size: 0.75em;
    border-radius: 3px;
    margin-left: 5px;
    font-weight: 600; /* Semi-bold */
}

.note-icon {
    width: 44px; /* Adjust width as needed */
    height: 44px; /* Adjust height as needed */
    margin-right: 3px; /* Space between the icon and text */
    vertical-align: middle; /* Aligns the icon vertically with the text */
    display: inline-block; /* Ensures it behaves as an inline element */
}


/* Modal styling */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgba(0, 0, 0, 0.7); /* Black w/ opacity */
    justify-content: center; /* Center horizontally */
    align-items: center; /* Center vertically */
}

.modal-content {
    background-color: var(--card-bg, #f5f5f5); /* Card background color */
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    width: 80%; /* Could be more or less, depending on screen size */
    max-width: 600px; /* Max width for larger screens */
    text-align: center; /* Center text and content */
}

.close {
    color: #aaa;
    float: right; /* Align to the right */
    font-size: 28px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: black; /* Change color on hover */
    text-decoration: none;
    cursor: pointer;
}

h6 {
    color: var(--text-color, #333);
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 20px;
}

.or-text {
    font-size: 18px;
    color: var(--text-color, #666);
    margin: 15px 0;
}

.create-manual-note-btn {
    background-color: var(--primary-color, #f5f5f5);
    color: var(--text-color, #333);
    border: none;
    padding: 10px 20px;
    border-radius: 50px;
    cursor: pointer;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    margin: 10px 0;
    display: block;
    width: 80%;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
}

.create-manual-note-btn:hover {
    background-color: var(--accent-color, #0056b3);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}


/* Modal styling */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgba(0, 0, 0, 0.7); /* Black w/ opacity */
}

.modal-content {
    background-color: var(--card-bg, #f5f5f5); /* Card background color */
    margin: 15% auto; /* 15% from the top and centered */
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    width: 80%; /* Could be more or less, depending on screen size */
    max-width: 600px; /* Max width for larger screens */
    text-align: center;
}

.close {
    color: #aaa;
    float: right; /* Align to the right */
    font-size: 28px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: black; /* Change color on hover */
    text-decoration: none;
    cursor: pointer;
}

/* Heading styles */
h6 {
    color: var(--text-color, #333); /* Use a variable or default text color */
    font-size: 24px; /* Font size */
    font-weight: bold; /* Bold font */
    margin-bottom: 20px;
}

/* Paragraph styles */
p {
    color: var(--text-color, #666); /* Text color */
    margin: 5px 0 15px; /* Space above and below */
    line-height: 1.5; /* Improve readability */
}

/* Textarea */
textarea {
    width: 100%;
    padding: 10px;
    border-radius: 10px; /* Slightly rounded corners */
    border: 3px solid var(--primary-color, #ccc);
    background-color: var(--card-bg, #f5f5f5); /* Match card background */
    margin-bottom: 20px;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
    resize: none; /* Prevent resizing */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Subtle shadow */
}

textarea:focus {
    border-color: var(--accent-color, #0056b3);
    box-shadow: 0 0 5px rgba(0, 86, 179, 0.3);
}

/* Button styling */
.create-manual-note-btn {
    background-color: var(--primary-color, #f5f5f5); /* Use card background color */
    color: var(--text-color, #333);
    border: none;
    padding: 10px 20px;
    border-radius: 50px; /* Make buttons round */
    cursor: pointer;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    margin-top: 10px; /* Space above button */
    margin-bottom: 10px;
}

.create-manual-note-btn:hover {
    background-color: var(--accent-color, #0056b3);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

/* Modal 3 styling */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgba(0, 0, 0, 0.7); /* Black w/ opacity */
}

.modal-content {
    background-color: var(--card-bg, #f5f5f5); /* Card background color */
    margin: 15% auto; /* 15% from the top and centered */
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    width: 80%; /* Could be more or less, depending on screen size */
    max-width: 600px; /* Max width for larger screens */
    text-align: center;
}

.close {
    color: #aaa;
    float: right; /* Align to the right */
    font-size: 28px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: black; /* Change color on hover */
    text-decoration: none;
    cursor: pointer;
}

/* Heading styles for modal 3 */
h6 {
    color: var(--text-color, #333); /* Use a variable or default text color */
    font-size: 24px; /* Font size */
    font-weight: bold; /* Bold font */
    margin-bottom: 20px;
}

/* Paragraph and input styles for modal 3 */
p {
    color: var(--text-color, #666); /* Text color */
    margin: 5px 0 15px; /* Space above and below */
    line-height: 1.5; /* Improve readability */
}

input[type="text"], input[type="date"] {
    width: 100%;
    padding: 10px;
    margin-bottom: 15px;
    border-radius: 10px;
    border: 2px solid var(--primary-color, #ccc);
    background-color: var(--card-bg, #f5f5f5);
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

input[type="text"]:focus, input[type="date"]:focus {
    border-color: var(--accent-color, #0056b3);
    box-shadow: 0 0 5px rgba(0, 86, 179, 0.3);
}

/* Textarea for modal 3 */
#personalTextarea3 {
    width: 100%;
    padding: 10px;
    border-radius: 10px; /* Slightly rounded corners */
    border: 3px solid var(--primary-color, #ccc);
    background-color: var(--card-bg, #f5f5f5); /* Match card background */
    margin-bottom: 20px;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
    resize: none; /* Prevent resizing */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Subtle shadow */
}

#personalTextarea3:focus {
    border-color: var(--accent-color, #0056b3);
    box-shadow: 0 0 5px rgba(0, 86, 179, 0.3);
}

/* Button styling for modal 3 */
#createPersonalNoteBtn3 {
    background-color: var(--primary-color, #f5f5f5); /* Use card background color */
    color: var(--text-color, #333);
    border: none;
    padding: 10px 20px;
    border-radius: 50px; /* Make buttons round */
    cursor: pointer;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    margin-top: 10px; /* Space above button */
    margin-bottom: 10px;
}

#createPersonalNoteBtn3:hover {
    background-color: var(--accent-color, #0056b3);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

/* Styles for note items */
.note-item {
    background-color: var(--card-bg, #f5f5f5); /* Card background color */
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    margin-top: 20px;
}

/* Title styling */
.note-item strong {
    font-size: 1.5rem; /* Title size */
    color: var(--text-color, #fffff); /* Title color */
    display: inline; /* Keep title inline */
    margin-right: 10px; /* Space between title and date */
}

/* Title styling */
.note-item strong2 {
    font-size: 1.3rem; /* Title size */
    color: var(--primary-color, #fffff); /* Title color */
    display: inline; /* Keep title inline */
    margin-right: 10px; /* Space between title and date */
    font-weight: bold; /* Make the title bold */
}


/* Date styling */
.note-item span.date {
    font-size: 0.9rem; /* Date size */
    color: var(--sub-heading-color, #666); /* Date color */
    display: inline; /* Keep date inline */
}

/* Note text styling */
.note-item p.note-text {
    font-size: 1rem; /* Note text size */
    color: var(--sub-text-color, #777); /* Note text color */
    margin: 5px 0 0 0; /* Space above note text */
}

/* Button container styling */
.button-container {
    display: flex; /* Flexbox for button layout */
    gap: 10px; /* Space between buttons */
    margin-top: 10px; /* Space above buttons */
}

/* Edit and Delete button styling */
.button-container button {
    background-color: var(--primary-color, #007BFF); /* Button background */
    color: var(--text-color, #fff); /* Button text color */
    border: none; /* Remove border */
    padding: 8px 12px; /* Padding for buttons */
    border-radius: 5px; /* Rounded corners */
    cursor: pointer; /* Pointer cursor on hover */
    transition: background-color 0.3s ease, box-shadow 0.3s ease; /* Transition effects */
}

.button-container button:hover {
    background-color: var(--accent-color, #0056b3); /* Button hover background */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Shadow on hover */
}

/* Specific styles for Edit button */
.button-container button.edit {
    background-color: var(--edit-button-color, #28a745); /* Edit button color */
}

.button-container button.edit:hover {
    background-color: var(--edit-button-hover-color, #218838); /* Edit button hover color */
}

/* Specific styles for Delete button */
.button-container button.delete {
    background-color: var(--delete-button-color, #dc3545); /* Delete button color */
}

.button-container button.delete:hover {
    background-color: var(--delete-button-hover-color, #c82333); /* Delete button hover color */
}

/* Styles for note items */
.note-item {
    background-color: var(--card-bg, #f5f5f5); /* Card background color */
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    margin-top: 20px;
    position: relative; /* To position the AI Generated tag */
}

/* Styles for AI Generated tag */
.ai-generated-tag {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background-color: #007bff; /* Blue background color */
    color: #ffffff; /* White text color */
    padding: 5px 10px;  
    border-radius: 5px;
    font-size: 0.8em;
    font-weight: bold;
    text-align: center;
    display: flex;
    align-items: center; /* Vertically center the icon and text */
    justify-content: center; /* Horizontally center them */
}

.ai-generated-tag .icon {
    width: 2em;  /* Keep the icon size */
    height: 2em; /* Keep the icon size */
    fill: white; /* Set the SVG color to white */
    margin-right: -2px; /* Space between icon and text */
}


/* Bullet point (ul and li) styling */
.note-item ul {
    list-style-type: disc; /* Use bullet points */
    padding-left: 20px; /* Indent bullet points */
    margin-bottom: 10px; /* Add some spacing after bullet points */
}

.note-item ul li {
    margin-bottom: 5px; /* Space between each bullet point */
    font-size: 1rem; /* Adjust size to match note text */
    color: var(--sub-text-color, #fffff); /* Use consistent text color */
}

/* Button container styling */
.note-item .button-container {
    display: flex; /* Flexbox for button layout */
    gap: 10px; /* Space between buttons */
    margin-top: 10px; /* Space above buttons */
    justify-content: flex-start; /* Align buttons to the start */
}

/* Edit and Delete button styling */
.note-item .button-container button {
    background-color: var(--primary-color, #007BFF); /* Button background */
    color: var(--text-color, #fff); /* Button text color */
    border: none; /* Remove border */
    padding: 8px 12px; /* Padding for buttons */
    border-radius: 5px; /* Rounded corners */
    cursor: pointer; /* Pointer cursor on hover */
    transition: background-color 0.3s ease, box-shadow 0.3s ease; /* Transition effects */
}

.note-item .button-container button:hover {
    background-color: var(--accent-color, #0056b3); /* Button hover background */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Shadow on hover */
}

/* Specific styles for Edit button */
.note-item .button-container button.edit {
    background-color: var(--edit-button-color, #28a745); /* Edit button color */
}

.note-item .button-container button.edit:hover {
    background-color: var(--edit-button-hover-color, #218838); /* Edit button hover color */
}

/* Specific styles for Delete button */
.note-item .button-container button.delete {
    background-color: var(--delete-button-color, #dc3545); /* Delete button color */
}

.note-item .button-container button.delete:hover {
    background-color: var(--delete-button-hover-color, #c82333); /* Delete button hover color */
}

input,
textarea {
    color: white; /* Set the text color to white */
}

input::placeholder,
textarea::placeholder {
    color: rgba(255, 255, 255, 0.7); /* Optional: Lighter white for placeholder text */
}

.modal-content {
    padding: 20px;
    text-align: center;
}

/* Updated Progress Bar Styling */
.progress-bar {
    width: 100%;
    height: 40px; /* Increase the height for a more prominent look */
    background-color: #8D8AAF;
    border-radius: 20px; /* Make the progress bar rounder */
    overflow: hidden;
    margin-top: 20px; /* Increase the spacing for a cleaner look */
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); /* Add subtle shadow for depth */
    position: relative;
    padding: 2px; /* Add some inner padding for a sleek border effect */
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #007bff, #00b8ff);
    border-radius: 18px; /* Ensure the fill follows the rounded edges */
    transition: width 1.5s ease-out; /* Smooth, slightly faster transition */
    position: relative;
    box-shadow: 0 3px 10px rgba(0, 123, 255, 0.3); /* Soft shadow for the progress fill */
}


.progress-fill .progress-percent {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    color: #fff;
    font-size: 20px; /* Slightly increase the percentage text size */
    font-weight: bold;
    letter-spacing: 0.05em; /* Add slight letter spacing for readability */
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2); /* Add subtle text shadow for clarity */
}

/* Ellipsis animation for "Generating Note..." */
@keyframes ellipsis {
    0% { content: ""; }
    25% { content: "."; }
    50% { content: ".."; }
    75% { content: "..."; }
    100% { content: ""; }
}

#ellipsis::after {
    content: "";
    animation: ellipsis 1.5s infinite;
    font-size: 20px; /* Match ellipsis size with the text */
    font-weight: bold;
    color: white; /* Make the ellipsis prominent */
}

/* Ellipsis animation for "Generating Note..." */
@keyframes ellipsis2 {
    0% { content: ""; }
    25% { content: "."; }
    50% { content: ".."; }
    75% { content: "..."; }
    100% { content: ""; }
}

#ellipsis2::after {
    content: "";
    animation: ellipsis 1.5s infinite;
    font-size: 20px; /* Match ellipsis size with the text */
    color: white; /* Make the ellipsis prominent */
}

/* Error Message Styling */
.error-message {
    color: #dc3545; /* Use a red color for the error message */
    font-size: 16px; /* Error message size */
    font-weight: bold;
    text-align: center;
    margin-top: 10px;
}


/* Modal4 base styles */
.modal4 {
    display: none; /* Hidden by default */
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6); /* Background overlay */
    justify-content: center;
    align-items: center;
}

.modal4 .modal-content {
    background-color: var(--card-bg);
    padding: 20px;
    border-radius: var(--border-radius);
    width: 450px;
    text-align: center;
    position: relative;
}

.modal4 .close-button {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 24px;
    cursor: pointer;
}

.pdf-icon-container {
    display: flex;
    justify-content: center;
    margin-bottom: 10px;
}

.modal4 h3.modal-header {
    color: var(--text-color);
    font-size: 1.25rem;
    margin-bottom: 15px;
}

.pdf-drag-area {
    border: 2px dashed var(--accent-color);
    padding: 20px;
    background-color: var(--glass-bg);
    color: var(--text-color);
    cursor: pointer;
    border-radius: var(--border-radius);
}

.pdf-drag-area:hover {
    background-color: rgba(255, 255, 255, 0.2);
}

.pdf-drag-area p {
    margin: 0;
    font-size: 1rem;
}

.pdf-drag-area .file-select {
    color: white;
    cursor: pointer;
    text-decoration: underline;
}

.upload-progress {
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 10px;
}

/* Progress container */
.progress-container {
    position: relative;
    width: 100%;
}

/* Main progress bar container */
#progressBar2 {
    width: 100%; /* Full width */
    height: 40px; /* Height of the bar */
    background-color: #8D8AAF;
    border-radius: 20px; /* Rounded corners */
    overflow: hidden; /* Prevent overflow */
    margin-top: 20px; /* Spacing above the progress bar */
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); /* Subtle shadow */
    position: relative; /* Needed for absolute positioning of the percentage text */
    padding: -2; /* Remove padding to prevent extra space */
}

/* Progress percentage styling (inside the bar) */
.progress-percentage {
    position: absolute;
    left: 50%; /* Center horizontally */
    top: 50%; /* Center vertically */
    transform: translate(-50%, -50%); /* Adjust position to be centered */
    color: #fff; /* White color for contrast */
    font-size: 20px; /* Font size */
    font-weight: bold; /* Bold text for emphasis */
    letter-spacing: 0.05em; /* Slight letter spacing */
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2); /* Text shadow for readability */
    pointer-events: none; /* Ensure text is not selectable/clickable */
}

/* Adjusting the top property to position text better vertically */
.progress-percentage {
    top: calc(50% - -8px); /* Adjust this value to move text down */
}



/* Progress bar fill */
#progressBar2::-webkit-progress-value {
    height: 100%;
    width: 100%;
    background: linear-gradient(90deg, #007bff, #00b8ff); /* Gradient fill */
    border-radius: 18px; /* Rounded corners */
    transition: width 1.5s ease-out; /* Smooth transition */
    box-shadow: 0 3px 10px rgba(0, 123, 255, 0.3); /* Soft shadow */
}



#summaryContainer {
    margin-top: 20px;
}

/* Hide scrollbar on WebKit browsers (Chrome, Safari, Edge) */
::-webkit-scrollbar {
    width: 0; /* Hide scrollbar */
    height: 0; /* For horizontal scrollbars */
}

::-webkit-scrollbar-thumb {
    background-color: transparent; /* Make the scrollbar transparent */
}

::-webkit-scrollbar-track {
    background-color: transparent; /* Make the track transparent */
}

/* For Firefox */
* {
    scrollbar-width: thin; /* Minimal scrollbar width */
    scrollbar-color: transparent transparent; /* Scrollbar and track colors both transparent */
}

/* Show scrollbar only while scrolling */
.container {
    overflow: auto;
    scrollbar-width: thin; /* Show thinner scrollbars */
    scrollbar-color: #333 #1E1E1E; /* Custom colors for Firefox */
}

/* Scrollbar styles when actively scrolling (WebKit browsers) */
.container::-webkit-scrollbar {
    width: 12px;
    height: 12px;
}

.container::-webkit-scrollbar-thumb {
    background-color: #333;
    border-radius: 6px;
}

.container::-webkit-scrollbar-track {
    background-color: #1E1E1E;
}


.disclaimer {
    margin: 10px 0; /* Add spacing above and below */
    color: #666; /* Set text color to gray */
    font-size: 0.9rem; /* Adjust font size if needed */
}

/* Progress bar fill for the error state */
.error-progress::-webkit-progress-value {
    background: linear-gradient(90deg, #c9302c, #c9302c); /* Gradient fill */
}

    .top-right-svg {
        position: absolute;
        top: 10px;
        right: 10px;
    }



.ellipsis-container {
    position: absolute;
    bottom: 10px; /* Move down slightly */
    right: 5px; /* Align all the way to the right */
    display: flex;
    justify-content: center;
    align-items: center;
}

.ellipsis-button {
    background-color: var(--accent-color); /* Button background color */
    border-radius: 24px; /* Oval shape */
    width: 48px; /* Button width */
    height: 64px; /* Increase height for oval effect */
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Optional shadow for effect */
}

.ellipsis-button:hover {
    background-color: #3b7bce; /* Change background on hover */
}



.quiz-btn {
    width: 48px;
    height: 48px;
    background-color: var(--primary-color);
    border-radius: 50%; /* Makes the button round */
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    position: absolute;
    top: 10px;
    right: 70px; /* This places the new button 60px to the left of the right button */
}

.quiz-btn:hover {
    background-color: #3b7bce; /* Change background on hover */
}

.quiz-icon {
    width: 34px;
    height: 44px;
}


/* Modal Content with ID, black background, wider and white text */
#QuizModalContent {
    background-color: #000; /* Set modal background to black */
    color: #fff; /* Set text color to white */
    margin: 5% auto;
    padding: 40px;
    border-radius: 10px;
    width: 90vw; /* Set modal width to 90% of viewport width */
    max-width: 1200px; /* Set a max width for large screens */
    box-shadow: 0 4px 8px rgba(255, 255, 255, 0.2);
    position: relative;
}

/* Close button in the top-right corner */
.quiz-button-close {
    position: absolute;
    top: 10px;
    right: 20px;
    background: none;
    border: none;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    color: #fff;
    transition: color 0.3s ease;
}

.quiz-button-close:hover {
    color: #999;
}

/* Heading text - Quiz Question - Bigger and bolder */
h9 {
    font-size: 36px; /* Bigger font size for "Quiz Question" */
    font-weight: bold; /* Bold text for heading */
    margin-bottom: 20px;
    text-align: left;
}

/* Quiz Question with SVG */
h9 {
    display: flex;
    align-items: center;
    font-size: 32px; /* Increase font size for the question heading */
    font-weight: bold;
    margin-bottom: 30px;
}

h9 svg {
    width: 40px; /* Adjust the width of the SVG */
    height: 40px; /* Adjust the height of the SVG */
    margin-right: 10px; /* Add space between the SVG and text */
}

/* Actual quiz question text - Bigger, but not as big as the heading */
#quiz-question {
    font-size: 28px; /* Bigger font size for quiz question */
    font-weight: bold; /* Bold text for question */
    margin-bottom: 30px; /* Space between question and options */
    text-align: left; /* Align question to the left */
}

/* Quiz Options aligned to the left */
.quiz-options {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-top: 30px;
    align-items: flex-start; /* Align options to the left */
}

/* Card styling - Wider cards */
.quiz-card {
    padding: 30px;
    background-color: var(--card-bg, #1a1a1a); /* Darker card background */
    border-radius: 10px;
    text-align: left; /* Align text inside the card to the left */
    font-size: 20px; /* Increased font size for option letters */
    cursor: pointer;
    transition: background-color 0.3s ease;
    color: #fff; /* White text inside cards */
    box-shadow: 0 4px 6px rgba(255, 255, 255, 0.1); /* White shadow for contrast */
    width: 100%; /* Set the card to take full width */
    display: flex; /* Flexbox for letter and text */
    align-items: center; /* Vertically center letter and text */
}

/* Styling for the Choice Letter (A, B, C, D) */
.quiz-option-letter {
    font-weight: bold; /* Bold letter */
    font-size: 24px; /* Bigger font size for letters */
    margin-right: 10px; /* Add space between the letter and text */
}



/* Hover effect for cards */
.quiz-card:hover {
    background-color: #333; /* Darker hover effect */
}

/* Styling for the Next button */
#next-button {
    background-color: var(--primary-color, #007bff); /* Primary color or default blue */
    color: #fff; /* White text color */
    padding: 15px 30px; /* Increase padding for a rounder appearance */
    border: none;
    border-radius: 50px; /* Make the button round */
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s ease;
    text-align: center;
}

#next-button:hover {
    background-color: #0056b3; /* Darker shade on hover */
}

.quiz-letter svg {
    width: 40px;  /* Increase the size of the SVG */
    height: 40px; /* Make sure it's the same height */
}

.quiz-option-text {
    font-size: 18px; /* Ensure the text is a good size relative to the SVG */
    line-height: 1.5; /* For better vertical alignment with SVG */
    font-weight: normal; /* Non-bold text after the letter */
}


.round-button {
    display: flex;          /* Use flexbox for centering */
    justify-content: center; /* Center horizontally */
    align-items: center;    /* Center vertically */
    width: 60px;           /* Set button width */
    height: 60px;          /* Set button height */
    border-radius: 50%;    /* Make it round */
    background-color: #007bff; /* Example background color */
    border: none;          /* Remove border */
    cursor: pointer;       /* Pointer cursor on hover */
}


.round-button svg {
    width: 40px;  /* Adjust width here */
    height: 40px; /* Adjust height here */
    fill: #ffffff; /* White color for SVG */    
}



    </style>
</head>
<body>
    <button class="sidebar-toggle" onclick="document.querySelector('.sidebar').classList.toggle('active');">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 12H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M3 6H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </button>
    <div class="container">
        <div class="sidebar">
            <div class="logo" onclick="window.location.href='index.html'">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                    <path d="M16.19 2H7.81C4.17 2 2 4.17 2 7.81V16.19C2 19.83 4.17 22 7.81 22H16.19C19.83 22 22 19.83 22 16.19V7.81C22 4.17 19.83 2 16.19 2ZM9.97 14.9L7.72 17.15C7.57 17.3 7.38 17.37 7.19 17.37C7 17.37 6.8 17.3 6.66 17.15L5.91 16.4C5.61 16.11 5.61 15.63 5.91 15.34C6.2 15.05 6.67 15.05 6.97 15.34L7.19 15.56L8.91 13.84C9.2 13.55 9.67 13.55 9.97 13.84C10.26 14.13 10.26 14.61 9.97 14.9ZM9.97 7.9L7.72 10.15C7.57 10.3 7.38 10.37 7.19 10.37C7 10.37 6.8 10.3 6.66 10.15L5.91 9.4C5.61 9.11 5.61 8.63 5.91 8.34C6.2 8.05 6.67 8.05 6.97 8.34L7.19 8.56L8.91 6.84C9.2 6.55 9.67 6.55 9.97 6.84C10.26 7.13 10.26 7.61 9.97 7.9ZM17.56 16.62H12.31C11.9 16.62 11.56 16.28 11.56 15.87C11.56 15.46 11.9 15.12 12.31 15.12H17.56C17.98 15.12 18.31 15.46 18.31 15.87C18.31 16.28 17.98 16.62 17.56 16.62ZM17.56 9.62H12.31C11.9 9.62 11.56 9.28 11.56 8.87C11.56 8.46 11.9 8.12 12.31 8.12H17.56C17.98 8.12 18.31 8.46 18.31 8.87C18.31 9.28 17.98 9.62 17.56 9.62Z" fill="currentColor"></path>
                </g>
            </svg>
                TaskMaster AI
            </div>
             <div class="menu-item" onclick="window.location.href='dashboard.html'">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M9 22V12H15V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Dashboard
            </div>
             <div class="menu-item" onclick="window.location.href='account.html'">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9C13.6569 9 15 10.3431 15 12Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M12.9046 3.06005C12.6988 3 12.4659 3 12 3C11.5341 3 11.3012 3 11.0954 3.06005C10.7942 3.14794 10.5281 3.32808 10.3346 3.57511C10.2024 3.74388 10.1159 3.96016 9.94291 4.39272C9.69419 5.01452 9.00393 5.33471 8.36857 5.123L7.79779 4.93281C7.3929 4.79785 7.19045 4.73036 6.99196 4.7188C6.70039 4.70181 6.4102 4.77032 6.15701 4.9159C5.98465 5.01501 5.83376 5.16591 5.53197 5.4677C5.21122 5.78845 5.05084 5.94882 4.94896 6.13189C4.79927 6.40084 4.73595 6.70934 4.76759 7.01551C4.78912 7.2239 4.87335 7.43449 5.04182 7.85566C5.30565 8.51523 5.05184 9.26878 4.44272 9.63433L4.16521 9.80087C3.74031 10.0558 3.52786 10.1833 3.37354 10.3588C3.23698 10.5141 3.13401 10.696 3.07109 10.893C3 11.1156 3 11.3658 3 11.8663C3 12.4589 3 12.7551 3.09462 13.0088C3.17823 13.2329 3.31422 13.4337 3.49124 13.5946C3.69158 13.7766 3.96395 13.8856 4.50866 14.1035C5.06534 14.3261 5.35196 14.9441 5.16236 15.5129L4.94721 16.1584C4.79819 16.6054 4.72367 16.829 4.7169 17.0486C4.70875 17.3127 4.77049 17.5742 4.89587 17.8067C5.00015 18.0002 5.16678 18.1668 5.5 18.5C5.83323 18.8332 5.99985 18.9998 6.19325 19.1041C6.4258 19.2295 6.68733 19.2913 6.9514 19.2831C7.17102 19.2763 7.39456 19.2018 7.84164 19.0528L8.36862 18.8771C9.00393 18.6654 9.6942 18.9855 9.94291 19.6073C10.1159 20.0398 10.2024 20.2561 10.3346 20.4249C10.5281 20.6719 10.7942 20.8521 11.0954 20.94C11.3012 21 11.5341 21 12 21C12.4659 21 12.6988 21 12.9046 20.94C13.2058 20.8521 13.4719 20.6719 13.6654 20.4249C13.7976 20.2561 13.8841 20.0398 14.0571 19.6073C14.3058 18.9855 14.9961 18.6654 15.6313 18.8773L16.1579 19.0529C16.605 19.2019 16.8286 19.2764 17.0482 19.2832C17.3123 19.2913 17.5738 19.2296 17.8063 19.1042C17.9997 18.9999 18.1664 18.8333 18.4996 18.5001C18.8328 18.1669 18.9994 18.0002 19.1037 17.8068C19.2291 17.5743 19.2908 17.3127 19.2827 17.0487C19.2759 16.8291 19.2014 16.6055 19.0524 16.1584L18.8374 15.5134C18.6477 14.9444 18.9344 14.3262 19.4913 14.1035C20.036 13.8856 20.3084 13.7766 20.5088 13.5946C20.6858 13.4337 20.8218 13.2329 20.9054 13.0088C21 12.7551 21 12.4589 21 11.8663C21 11.3658 21 11.1156 20.9289 10.893C20.866 10.696 20.763 10.5141 20.6265 10.3588C20.4721 10.1833 20.2597 10.0558 19.8348 9.80087L19.5569 9.63416C18.9478 9.26867 18.6939 8.51514 18.9578 7.85558C19.1262 7.43443 19.2105 7.22383 19.232 7.01543C19.2636 6.70926 19.2003 6.40077 19.0506 6.13181C18.9487 5.94875 18.7884 5.78837 18.4676 5.46762C18.1658 5.16584 18.0149 5.01494 17.8426 4.91583C17.5894 4.77024 17.2992 4.70174 17.0076 4.71872C16.8091 4.73029 16.6067 4.79777 16.2018 4.93273L15.6314 5.12287C14.9961 5.33464 14.3058 5.0145 14.0571 4.39272C13.8841 3.96016 13.7976 3.74388 13.6654 3.57511C13.4719 3.32808 13.2058 3.14794 12.9046 3.06005Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                Settings
            </div>
            <div class="menu-item toggle-night-mode" onclick="toggleNightMode()">
                <div class="theme-icon">
                    <svg id="theme-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                </div>
                Theme
            </div>
             <div class="menu-item" onclick="window.location.href='notes.html'">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M20 14V7C20 5.34315 18.6569 4 17 4H12M20 14L13.5 20M20 14H15.5C14.3954 14 13.5 14.8954 13.5 16V20M13.5 20H7C5.34315 20 4 18.6569 4 17V12" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M7 4V7M7 10V7M7 7H4M7 7H10" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                Notes
            </div>
            <div class="menu-item" onclick="window.location.href='calendar.html'">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M3 9H21M7 3V5M17 3V5M6 12H8M11 12H13M16 12H18M6 15H8M11 15H13M16 15H18M6 18H8M11 18H13M16 18H18M6.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4802 21 18.9201 21 17.8V8.2C21 7.07989 21 6.51984 20.782 6.09202C20.5903 5.71569 20.2843 5.40973 19.908 5.21799C19.4802 5 18.9201 5 17.8 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V17.8C3 18.9201 3 19.4802 3.21799 19.908C3.40973 20.2843 3.71569 20.5903 4.09202 20.782C4.51984 21 5.07989 21 6.2 21Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round"></path> </g></svg>
                Calendar
            </div>
            <div class="menu-item" onclick="window.location.href='friends.html'">
                <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" stroke-width="4.672" stroke="#ffffff" fill="none"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><circle cx="29.22" cy="16.28" r="11.14"></circle><path d="M41.32,35.69c-2.69-1.95-8.34-3.25-12.1-3.25h0A22.55,22.55,0,0,0,6.67,55h29.9"></path><circle cx="45.38" cy="46.92" r="11.94"></circle><line x1="45.98" y1="39.8" x2="45.98" y2="53.8"></line><line x1="38.98" y1="46.8" x2="52.98" y2="46.8"></line></g></svg>
                Friends
            </div>
            <div class="menu-item" onclick="window.location.href='coming-soon.html'">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 164 164" x="0px" y="0px" fill="#ffffff" width="74" height="74" style="margin-right: 8px;">
    <g transform="scale(2.75)"> <!-- Scaling the actual SVG content -->
        <path d="M11.63,37.02A20.1565,20.1565,0,0,1,11.04,32.82H22.59A56.55887,56.55887,0,0,0,22.97,38.8,25.89175,25.89175,0,0,0,18.58,40.53,6.1486,6.1486,0,0,0,11.63,37.02ZM19.11,42.45a5.88844,5.88844,0,0,1-.3,2.67A9.91165,9.91165,0,0,1,22.5,50.7a20.04038,20.04038,0,0,0,4.83,1.75c-1.85-2.58-3.3-6.68005-4.09-11.67A22.112,22.112,0,0,0,19.11,42.45Zm8.22-30.9a20.9854,20.9854,0,0,0-11.78,7.44,18.31507,18.31507,0,0,0,7.69,4.23C24.03,18.23,25.48,14.13,27.33,11.55ZM22.97,25.2a21.16733,21.16733,0,0,1-8.56-4.62A20.757,20.757,0,0,0,11.06,30.82H22.59C22.63,28.86,22.76,26.98,22.97,25.2ZM32,24.45a31.61622,31.61622,0,0,0,6.82-.73c-2.701-17.05245-10.94371-17.03506-13.64,0A31.61622,31.61622,0,0,0,32,24.45Zm9.28-1.39a9.848,9.848,0,0,1,3.91-6.95,5.00891,5.00891,0,0,1-.17-.55,20.71311,20.71311,0,0,0-8.35-4.01c1.85,2.58,3.3,6.68,4.09,11.67C40.94,23.17,41.11,23.11,41.28,23.06Zm-2.2,2.64a34.10132,34.10132,0,0,1-14.16,0c-.18,1.61-.29,3.32-.33,5.12H39.41C39.37,29.02,39.26,27.31,39.08,25.7Zm2.33,5.12H52.94A20.53863,20.53863,0,0,0,52.37,26.96H44.24A3.00339,3.00339,0,0,1,41.45,25.07c-.14.04-.28.09-.42.13C41.24,26.98,41.37,28.86,41.41,30.82ZM24.92,38.3a34.10132,34.10132,0,0,1,14.16,0c.19-1.71.31-3.55.33-5.48H24.59C24.61,34.75,24.73,36.59,24.92,38.3ZM32,39.55a31.62006,31.62006,0,0,0-6.82.73c2.70094,17.05249,10.94373,17.0351,13.64,0A31.62006,31.62006,0,0,0,32,39.55Zm4.67,12.9a20.9854,20.9854,0,0,0,11.78-7.44,18.31512,18.31512,0,0,0-7.69-4.23C39.97,45.77,38.52,49.87,36.67,52.45ZM41.03,38.8a21.16726,21.16726,0,0,1,8.56,4.62,20.8109,20.8109,0,0,0,3.37-10.6H41.41A56.55887,56.55887,0,0,1,41.03,38.8ZM58.77,23.96a1.00291,1.00291,0,0,1-1,1H52.04c-2.17352.001-5.73834-.01069-7.8,0a.99286.99286,0,0,1-.89015-.56c-.52331-3.122,1.75543-6.38334,4.60017-7.57C45.431,14.26381,47.58273,9.77221,51,9.89A4.17084,4.17084,0,0,1,54.07,16.83,7.77635,7.77635,0,0,1,58.77,23.96ZM50.99991,16.2c2.95419.00217,2.72218-4.65995-.24991-4.29A2.15468,2.15468,0,0,0,50.99991,16.2ZM56.69,22.96c-1.14169-6.4101-10.38395-6.08342-11.36,0Zm-35.92,30a1.00291,1.00291,0,0,1-1,1c-1.58735.00006-6.43744,0-7.94,0H6.24a1.00291,1.00291,0,0,1-1-1,7.76949,7.76949,0,0,1,4.71-7.13,4.17685,4.17685,0,0,1,2.24992-6.87986c3.75273-.81649,6.53182,3.9936,3.95009,6.77988C18.77011,47.238,20.85191,49.76531,20.77,52.96ZM13,45.2c2.76954-.0062,2.8617-4.28654,0-4.31A2.15516,2.15516,0,0,0,13,45.2Zm5.69,6.76c-1.15159-6.29025-10.24749-6.25506-11.36,0Z"></path>
    </g>
</svg>

                Community
            </div>
            <div class="menu-item" onclick="window.location.href='features.html'">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                  </svg>
                Distraction Control
            </div>
            <div class="menu-item" onclick="window.location.href='workschedule.html'">
    <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" fill="#ffffff" stroke="none">
        <g id="SVGRepo_bgCarrier" stroke-width="0" fill="none"></g>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
        <g id="SVGRepo_iconCarrier" fill="#ffffff">
            <title>ai</title>
            <g id="Layer_2" data-name="Layer 2">
                <g id="invisible_box" data-name="invisible box">
                    <rect width="48" height="48" fill="none"></rect>
                </g>
                <g id="Q3_icons" data-name="Q3 icons">
                    <g>
                        <path d="M45.6,18.7,41,14.9V7.5a1,1,0,0,0-.6-.9L30.5,2.1h-.4l-.6.2L24,5.9,18.5,2.2,17.9,2h-.4L7.6,6.6a1,1,0,0,0-.6.9v7.4L2.4,18.7a.8.8,0,0,0-.4.8v9H2a.8.8,0,0,0,.4.8L7,33.1v7.4a1,1,0,0,0,.6.9l9.9,4.5h.4l.6-.2L24,42.1l5.5,3.7.6.2h.4l9.9-4.5a1,1,0,0,0,.6-.9V33.1l4.6-3.8a.8.8,0,0,0,.4-.7V19.4h0A.8.8,0,0,0,45.6,18.7Zm-5.1,6.8H42v1.6l-3.5,2.8-.4.3-.4-.2a1.4,1.4,0,0,0-2,.7,1.5,1.5,0,0,0,.6,2l.7.3h0v5.4l-6.6,3.1-4.2-2.8-.7-.5V25.5H27a1.5,1.5,0,0,0,0-3H25.5V9.7l.7-.5,4.2-2.8L37,9.5v5.4h0l-.7.3a1.5,1.5,0,0,0-.6,2,1.4,1.4,0,0,0,1.3.9l.7-.2.4-.2.4.3L42,20.9v1.6H40.5a1.5,1.5,0,0,0,0,3ZM21,25.5h1.5V38.3l-.7.5-4.2,2.8L11,38.5V33.1h0l.7-.3a1.5,1.5,0,0,0,.6-2,1.4,1.4,0,0,0-2-.7l-.4.2-.4-.3L6,27.1V25.5H7.5a1.5,1.5,0,0,0,0-3H6V20.9l3.5-2.8.4-.3.4.2.7.2a1.4,1.4,0,0,0,1.3-.9,1.5,1.5,0,0,0-.6-2L11,15h0V9.5l6.6-3.1,4.2,2.8.7.5V22.5H21a1.5,1.5,0,0,0,0,3Z"></path>
                        <path d="M13.9,9.9a1.8,1.8,0,0,0,0,2.2l2.6,2.5v2.8l-4,4v5.2l4,4v2.8l-2.6,2.5a1.8,1.8,0,0,0,0,2.2,1.5,1.5,0,0,0,1.1.4,1.5,1.5,0,0,0,1.1-.4l3.4-3.5V29.4l-4-4V22.6l4-4V13.4L16.1,9.9A1.8,1.8,0,0,0,13.9,9.9Z"></path>
                        <path d="M31.5,14.6l2.6-2.5a1.8,1.8,0,0,0,0-2.2,1.8,1.8,0,0,0-2.2,0l-3.4,3.5v5.2l4,4v2.8l-4,4v5.2l3.4,3.5a1.7,1.7,0,0,0,2.2,0,1.8,1.8,0,0,0,0-2.2l-2.6-2.5V30.6l4-4V21.4l-4-4Z"></path>
                    </g>
                </g>
            </g>
        </g>
    </svg>
    AI Chat Bot
</div>

            <button class="upgrade-btn" onclick="window.location.href='pricing.html'">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M2 8l10 14L22 8l-4-6H6L2 8z"/>
                    <path d="M2 8h20"/>
                    <path d="M12 2v20"/>
                  </svg>
                Upgrade to Premium
            </button>
<div class="user-profile" onclick="window.location.href='account.html'">
    <button class="account-button">
        <div class="user-avatar" id="smallProfilePictureContainer">
            <!-- SVG will be replaced with the profile picture -->
            <svg id="defaultAvatar" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 4C14.21 4 16 5.79 16 8C16 10.21 14.21 12 12 12C9.79 12 8 10.21 8 8C8 5.79 9.79 4 12 4ZM12 20C9.33 20 6.34 18.87 4.63 16.74C5.91 15.43 8.39 14.5 12 14.5C15.61 14.5 18.09 15.43 19.37 16.74C17.66 18.87 14.67 20 12 20Z" fill="currentColor"/>
            </svg>
        </div>
                <div id="username">User Name</div>
                <div class="menu-dots">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12C11 12.5523 11.4477 13 12 13Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M19 13C19.5523 13 20 12.5523 20 12C20 11.4477 19.5523 11 19 11C18.4477 11 18 11.4477 18 12C18 12.5523 18.4477 13 19 13Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M5 13C5.55228 13 6 12.5523 6 12C6 11.4477 5.55228 11 5 11C4.44772 11 4 11.4477 4 12C4 12.5523 4.44772 13 5 13Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </div>
        </div>
        <div class="main-content">
            <!-- Main heading and subheading -->
            <div class="notes-dashboard-container">
                <h1 class="main-heading">
                    <span class="svg-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                            <g id="SVGRepo_iconCarrier">
                                <path opacity="0.9" d="M21.6602 10.44L20.6802 14.62C19.8402 18.23 18.1802 19.69 15.0602 19.39C14.5602 19.35 14.0202 19.26 13.4402 19.12L11.7602 18.72C7.59018 17.73 6.30018 15.67 7.28018 11.49L8.26018 7.30001C8.46018 6.45001 8.70018 5.71001 9.00018 5.10001C10.1702 2.68001 12.1602 2.03001 15.5002 2.82001L17.1702 3.21001C21.3602 4.19001 22.6402 6.26001 21.6602 10.44Z" fill="var(--primary-color)"></path>
                                <path d="M15.0603 19.3901C14.4403 19.8101 13.6603 20.1601 12.7103 20.4701L11.1303 20.9901C7.16034 22.2701 5.07034 21.2001 3.78034 17.2301L2.50034 13.2801C1.22034 9.3101 2.28034 7.2101 6.25034 5.9301L7.83034 5.4101C8.24034 5.2801 8.63034 5.1701 9.00034 5.1001C8.70034 5.7101 8.46034 6.4501 8.26034 7.3001L7.28034 11.4901C6.30034 15.6701 7.59034 17.7301 11.7603 18.7201L13.4403 19.1201C14.0203 19.2601 14.5603 19.3501 15.0603 19.3901Z" fill="var(--accent-color)"></path>
                                <path d="M17.4894 10.51C17.4294 10.51 17.3694 10.5 17.2994 10.49L12.4494 9.26002C12.0494 9.16002 11.8094 8.75002 11.9094 8.35002C12.0094 7.95002 12.4194 7.71002 12.8194 7.81002L17.6694 9.04002C18.0694 9.14002 18.3094 9.55002 18.2094 9.95002C18.1294 10.28 17.8194 10.51 17.4894 10.51Z" fill="#FFFFFF"></path>
                                <path d="M14.5592 13.8899C14.4992 13.8899 14.4392 13.8799 14.3692 13.8699L11.4592 13.1299C11.0592 13.0299 10.8192 12.6199 10.9192 12.2199C11.0192 11.8199 11.4292 11.5799 11.8292 11.6799L14.7392 12.4199C15.1392 12.5199 15.3792 12.9299 15.2792 13.3299C15.1992 13.6699 14.8992 13.8899 14.5592 13.8899Z" fill="#FFFFFF"></path>
                            </g>
                        </svg>
                    </span>
                    Notes Dashboard
                </h1>
                <span class="beta-tag">BETA</span>
                <h3 class="sub-heading">Create new notes</h3>
            </div>
        
<!-- Cards section for note creation options -->
<div class="note-options-container">
    <div class="note-option-card">
        <div class="card-content">
            <div class="icon-container">
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 512 512" class="note-icon audio-icon"><g><path fill="var(--accent-color)" fill-rule="evenodd" d="M256 512c140.997 0 256-115.003 256-256S396.997 0 256 0 0 115.003 0 256s115.003 256 256 256z" clip-rule="evenodd"></path><path fill="#ffffff" d="M188.231 254.918V153.756c0-37.36 30.409-67.756 67.776-67.756s67.762 30.396 67.762 67.756v101.162c0 37.373-30.395 67.776-67.762 67.776s-67.776-30.403-67.776-67.776zm169.286-69.21c-5.899 0-10.699 4.807-10.699 10.705v58.504c0 24.149-9.476 46.925-26.688 64.13-17.205 17.205-39.975 26.675-64.124 26.675-24.148 0-46.925-9.47-64.13-26.675-17.198-17.198-26.675-39.975-26.675-64.13v-58.504c0-5.899-4.8-10.705-10.699-10.705-5.912 0-10.726 4.807-10.726 10.705v58.504c0 58.268 44.637 106.3 101.511 111.715v31.928h-40.931c-7.565 0-13.723 6.152-13.723 13.723V426h130.753v-13.716c0-7.572-6.158-13.723-13.723-13.723h-40.951v-31.927c56.874-5.409 101.511-53.443 101.511-111.716v-58.504c0-5.899-4.8-10.706-10.706-10.706z" opacity="1"></path></g></svg>
            </div>
            <div class="text-container">
                <h4>Record or Upload Audio</h4>
                <p>Upload an audio file</p>
            </div>
        </div>
            <span class="unavailable-tag">
        UNAVAILABLE
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="unavailable-icon">
            <g clip-path="url(#clip0_429_11057)">
                <path d="M5.63604 5.63598C4.00736 7.26466 3 9.51466 3 11.9999C3 16.9705 7.02944 20.9999 12 20.9999C14.4853 20.9999 16.7353 19.9926 18.364 18.3639M5.63604 5.63598C7.26472 4.0073 9.51472 2.99994 12 2.99994C16.9706 2.99994 21 7.02938 21 11.9999C21 14.4852 19.9926 16.7352 18.364 18.3639M5.63604 5.63598L18.364 18.3639" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </g>
            <defs>
                <clipPath id="clip0_429_11057">
                    <rect width="24" height="24" fill="white"></rect>
                </clipPath>
            </defs>
        </svg>
    </span>
    </div>
    <div class="note-option-card">
        <div class="card-content">
            <div class="icon-container">
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="42" height="42" viewBox="0 0 176 176" style="enable-background:new 0 0 512 512" xml:space="preserve" class="">
                    <g>
                        <g data-name="Layer 2">
                            <g data-name="02.youtube">
                                <path fill="#e60000" d="M144.52 173a532.59 532.59 0 0 1-113 0A32.07 32.07 0 0 1 3 144.52a532.59 532.59 0 0 1 0-113A32.07 32.07 0 0 1 31.48 3a532.59 532.59 0 0 1 113 0A32.07 32.07 0 0 1 173 31.48a532.59 532.59 0 0 1 0 113A32.07 32.07 0 0 1 144.52 173z" data-original="#e60000" class=""></path>
                                <path fill="#ffffff" d="M140.43 61.54c-2.2-6.77-9.48-10.87-16.18-11.81a343.16 343.16 0 0 0-72.5 0c-6.7.94-14 5-16.18 11.81a137.42 137.42 0 0 0 0 52.93c2.2 6.76 9.48 10.87 16.18 11.81a343.16 343.16 0 0 0 72.5 0c6.7-.94 14-5 16.18-11.81a137.42 137.42 0 0 0 0-52.93zm-65.59 47.54V66.92L109.16 88c-11.57 7.11-22.8 14-34.32 21.08z" data-original="#ffffff"></path>
                            </g>
                        </g>
                    </g>
                </svg>
            </div>
            <div class="text-container">
                <h4>YouTube Video</h4>
                <p>Paste a YouTube link</p>
            </div>
        </div>
            <span class="unavailable-tag">
        UNAVAILABLE
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="unavailable-icon">
            <g clip-path="url(#clip0_429_11057)">
                <path d="M5.63604 5.63598C4.00736 7.26466 3 9.51466 3 11.9999C3 16.9705 7.02944 20.9999 12 20.9999C14.4853 20.9999 16.7353 19.9926 18.364 18.3639M5.63604 5.63598C7.26472 4.0073 9.51472 2.99994 12 2.99994C16.9706 2.99994 21 7.02938 21 11.9999C21 14.4852 19.9926 16.7352 18.364 18.3639M5.63604 5.63598L18.364 18.3639" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </g>
            <defs>
                <clipPath id="clip0_429_11057">
                    <rect width="24" height="24" fill="white"></rect>
                </clipPath>
            </defs>
        </svg>
    </span>
    </div>    
    <div class="note-option-card" onclick="openPdfUploadModal()">
        <div class="card-content" >
            <div class="icon-container">
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 791.454 791.454" class="note-icon pdf-icon"><g><path fill="var(--accent-color)" fill-rule="evenodd" d="M202.808 0h264.609l224.265 233.758v454.661c0 56.956-46.079 103.035-102.838 103.035H202.808c-56.956 0-103.035-46.079-103.035-103.035V103.035C99.772 46.079 145.851 0 202.808 0z" clip-rule="evenodd" ></path><g fill="#fff"><path fill-rule="evenodd" d="M467.219 0v231.978h224.463z" clip-rule="evenodd" opacity=".302" fill="#ffffff" ></path><path d="M214.278 590.525V445.959h61.505c15.228 0 27.292 4.153 36.389 12.657 9.097 8.306 13.646 19.579 13.646 33.62s-4.549 25.314-13.646 33.62c-9.097 8.504-21.161 12.657-36.389 12.657H251.26v52.012zm36.982-83.456h20.37c5.537 0 9.888-1.187 12.855-3.955 2.966-2.571 4.549-6.131 4.549-10.877s-1.582-8.306-4.549-10.877c-2.966-2.769-7.317-3.955-12.855-3.955h-20.37zm89.785 83.456V445.959h51.221c10.086 0 19.579 1.384 28.478 4.351 8.899 2.966 17.008 7.12 24.127 12.855 7.12 5.537 12.855 13.052 17.008 22.545 3.955 9.493 6.131 20.37 6.131 32.631 0 12.064-2.175 22.941-6.131 32.433-4.153 9.493-9.888 17.008-17.008 22.545-7.12 5.735-15.228 9.888-24.127 12.855-8.899 2.966-18.392 4.351-28.478 4.351zm36.191-31.444h10.679c5.735 0 11.075-.593 16.019-1.978 4.746-1.384 9.295-3.56 13.646-6.526 4.153-2.966 7.515-7.12 9.888-12.657s3.56-12.064 3.56-19.579c0-7.713-1.187-14.239-3.56-19.776s-5.735-9.69-9.888-12.657c-4.351-2.966-8.899-5.142-13.646-6.526-4.944-1.384-10.284-1.978-16.019-1.978h-10.679zM486.6 590.525V445.959h102.838v31.445h-65.856v23.138h52.605v31.247h-52.605v58.736z" fill="#ffffff" ></path></g></g></svg>
            </div>
            <div class="text-container">
                <h4>PDF Upload</h4>
                <p>Upload a PDF file</p>
            </div>
        </div>
        <div class="svg-container">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8.46667 10.583334" version="1.1" x="0px" y="0px" class="arrow-icon">
                <g transform="translate(-97.70311,-66.241243)">
                    <path style="color:#777777;" d="m 101.66462,70.010065 -1.87996,-1.731969 c -0.22794,-0.154323 -0.29782,-0.4804 -0.15617,-0.728516 0.0678,-0.119109 0.17626,-0.204098 0.30157,-0.236328 v 0 -4e-6 c 0.1259,-0.03196 0.25831,-0.0081 0.36798,0.06641 l 3.78895,2.644531 c 0.15379,0.103413 0.2307,0.276805 0.2307,0.450292 0,0.173487 -0.0769,0.346879 -0.2307,0.450292 l -3.78895,2.644531 c -0.10967,0.07447 -0.24208,0.09837 -0.36798,0.06641 v -4e-6 0 c -0.12531,-0.03223 -0.23377,-0.117219 -0.30157,-0.236328 -0.14165,-0.248116 -0.0718,-0.574193 0.15617,-0.728516 l 1.87996,-1.731969 c 0.12996,-0.119723 0.20389,-0.288156 0.20395,-0.464416 -6e-5,-0.17626 -0.074,-0.344693 -0.20395,-0.464416 z" fill="#777777" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round"/>
                </g>
            </svg>            
        </div>
    </div>
</div>
        
<div class="all-notes-section">
    <h2 class="section-heading">All Notes</h2>
    <button class="create-note-btn" onclick="openModal()">
        <svg class="note-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
                <path d="M20 14V7C20 5.34315 18.6569 4 17 4H12M20 14L13.5 20M20 14H15.5C14.3954 14 13.5 14.8954 13.5 16V20M13.5 20H7C5.34315 20 4 18.6569 4 17V12" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M7 4V7M7 10V7M7 7H4M7 7H10" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </g>
        </svg>
    </button>
</div>
            

<!-- Dynamically generated notes list -->
<div id="notes-list"></div>

<!-- Modal 1: Choose an Option Modal -->
<div class="modal" id="noteModal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h6>Choose an option below</h6>
        <button class="create-manual-note-btn" onclick="openModal2()">Generate Note</button>
        <p class="or-text">or</p>
        <button class="create-manual-note-btn" onclick="openModal3()">Create Personal Note</button>
    </div>
</div>

<!-- Modal 2: Generate Note Modal -->
<div class="modal" id="noteModal2">
    <div class="modal-content">
        <span class="close" onclick="closeModal2()">&times;</span>
        <h6>Generate Note</h6>
        <p class="disclaimer">Please refrain from asking questions or incorporating mathematical elements, as these may disrupt the generation process. Thank you for your understanding.</p>
        <p>Enter text below to generate a note.</p>
        <textarea placeholder="Enter text here..." rows="4"></textarea>
        <button class="create-manual-note-btn" onclick="createNote()">Generate Note</button>
    </div>
</div>

<!-- Quiz Modal -->
<div class="modal" id="QuizModal">
    <div class="modal-content" id="QuizModalContent">
        <button class="quiz-button-close" onclick="closeQuizModal()">×</button>

        <!-- Quiz Question with SVG Icon -->
        <h9>
            <!-- Original SVG before "Quiz Question" -->
            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path style="fill:#509FE8;" d="M427.023,503.983H84.977c-9.446,0-17.102-7.656-17.102-17.102V84.977 c0-9.446,7.656-17.102,17.102-17.102h342.046c9.446,0,17.102,7.656,17.102,17.102v401.904 C444.125,496.327,436.469,503.983,427.023,503.983z"></path> <path style="fill:#4D8CCF;" d="M84.977,486.881V84.977c0-9.445,7.656-17.102,17.102-17.102H84.977 c-9.446,0-17.102,7.658-17.102,17.102v401.904c0,9.445,7.656,17.102,17.102,17.102h17.102 C92.634,503.983,84.977,496.326,84.977,486.881z"></path> <rect x="110.63" y="67.875" style="fill:#F6F6F7;" width="290.739" height="393.353"></rect> <path style="fill:#D9DCDF;" d="M152.852,110.63h206.296c4.427,0,8.017-3.589,8.017-8.017V67.875h-222.33v34.739 C144.835,107.041,148.424,110.63,152.852,110.63z"></path> <path style="fill:#FFC44F;" d="M350.063,93.528V59.324c0-9.446-7.656-17.102-17.102-17.102h-42.756 c0-18.891-15.314-34.205-34.205-34.205s-34.205,15.314-34.205,34.205H179.04c-9.446,0-17.102,7.656-17.102,17.102v34.205H350.063z"></path> <path style="fill:#FFD791;" d="M332.96,42.221h-17.102c9.446,0,17.102,7.658,17.102,17.102v34.205h17.102V59.324 C350.063,49.879,342.406,42.221,332.96,42.221z"></path> <path style="fill:#F7AB49;" d="M196.142,42.221H179.04c-9.446,0-17.102,7.658-17.102,17.102v34.205h17.102V59.324 C179.04,49.879,186.696,42.221,196.142,42.221z"></path> <path style="fill:#FF8C78;" d="M356.808,316.761l-85.512-171.023c-2.897-5.794-8.818-9.454-15.297-9.454 c-6.479,0-12.4,3.66-15.297,9.454l-85.511,171.023c-4.224,8.447-0.8,18.721,7.649,22.945c8.445,4.223,18.721,0.799,22.945-7.649 l33.754-67.506h72.923l33.754,67.506c2.996,5.993,9.035,9.459,15.31,9.458c2.57,0,5.18-0.581,7.635-1.809 C357.608,335.482,361.033,325.209,356.808,316.761z M236.64,230.347L256,191.628l19.36,38.719H236.64z"></path> </g></svg>

            <!-- Quiz Question Text -->
            Quiz Question

            <!-- New Round Button with Updated SVG -->
            <button class="round-button">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="-5.0 -10.0 110.0 135.0">
 <g>
  <path d="m50.422 33.258 1.5703 4.3594c1.7422 4.8398 5.5547 8.6484 10.395 10.395l4.3594 1.5703c0.39453 0.14062 0.39453 0.69922 0 0.83984l-4.3594 1.5703c-4.8398 1.7422-8.6484 5.5547-10.395 10.395l-1.5703 4.3594c-0.14062 0.39453-0.69922 0.39453-0.83984 0l-1.5703-4.3594c-1.7422-4.8398-5.5547-8.6484-10.395-10.395l-4.3594-1.5703c-0.39453-0.14062-0.39453-0.69922 0-0.83984l4.3594-1.5703c4.8398-1.7422 8.6484-5.5547 10.395-10.395l1.5703-4.3594c0.14062-0.39453 0.69531-0.39453 0.83984 0z"/>
  <path d="m85.629 28.539c-0.89453-1.4766-2.8125-1.9375-4.293-1.0547-1.4766 0.89453-1.9453 2.8164-1.0547 4.293 3.3203 5.4766 5.0703 11.777 5.0703 18.227 0 19.492-15.859 35.352-35.352 35.352-3.3398 0-6.5977-0.48828-9.7422-1.3906l3.1016-1.4922c1.5547-0.74609 2.2109-2.6172 1.4609-4.1719-0.74219-1.5547-2.6172-2.2109-4.1719-1.4609l-9.7656 4.6953c-0.78125 0.37891-1.3711 1.0625-1.6289 1.8906-0.25391 0.83203-0.15234 1.7266 0.27734 2.4805l5.3984 9.3984c0.57812 1.0078 1.6289 1.5703 2.7148 1.5703 0.52734 0 1.0625-0.13281 1.5547-0.41406 1.4961-0.85938 2.0156-2.7734 1.1523-4.2656l-1.1875-2.0703c3.5078 0.94922 7.1328 1.4766 10.84 1.4766 22.941 0 41.602-18.664 41.602-41.602-0.003907-7.5859-2.0664-15.012-5.9766-21.461z"/>
  <path d="m49.996 14.648c3.3398 0 6.6016 0.48828 9.7422 1.3906l-3.1016 1.4922c-1.5547 0.74609-2.2109 2.6172-1.4609 4.1719 0.53906 1.1172 1.6523 1.7695 2.8203 1.7695 0.45703 0 0.91406-0.097656 1.3516-0.30859l9.7656-4.6953c0.78125-0.37891 1.3711-1.0625 1.6289-1.8906 0.25781-0.82812 0.16016-1.7266-0.27344-2.4805l-5.3984-9.3984c-0.85547-1.4961-2.7656-2.0117-4.2656-1.1523-1.4961 0.85938-2.0156 2.7734-1.1523 4.2656l1.1875 2.0703c-3.5078-0.94922-7.1328-1.4766-10.84-1.4766-22.941 0-41.602 18.664-41.602 41.602 0 7.5898 2.0664 15.016 5.9766 21.465 0.58594 0.96875 1.6211 1.5039 2.6758 1.5039 0.55469 0 1.1094-0.14844 1.6172-0.45312 1.4766-0.89453 1.9453-2.8164 1.0547-4.293-3.3203-5.4766-5.0703-11.777-5.0703-18.227-0.003906-19.496 15.855-35.355 35.344-35.355z"/>
 </g>
</svg>
            </button>
        </h9>

        <p id="quiz-question">What is the question?</p>

        <div class="quiz-options">
            <div class="quiz-card" id="optionA">A</div>
            <div class="quiz-card" id="optionB">B</div>
            <div class="quiz-card" id="optionC">C</div>
            <div class="quiz-card" id="optionD">D</div>
        </div>

        <!-- Next button, hidden initially -->
        <button id="next-button" onclick="nextQuestion()" style="display: none; margin-top: 20px;">Next</button>
    </div>
</div>






<!-- Modal 3: Personal Note Modal -->
<div class="modal" id="personalNoteModal3">
    <div class="modal-content" id="modalContent3">
        <span class="close" id="closeModal3" onclick="closeModal3()">&times;</span>
        <h6>Personal Note</h6>
        <p>Title:</p>
        <input type="text" id="personalNoteTitle3" placeholder="Enter title here..." />
        <p>Date:</p>
        <input type="date" id="personalNoteDate3" />
        <p>Enter text below to create a personal note.</p>
        <textarea id="personalTextarea3" placeholder="Enter text here..." rows="4"></textarea>
        <button class="create-manual-note-btn" id="createPersonalNoteBtn3" onclick="createManualNote()">Create Personal Note</button>
    </div>
</div>


<!-- Progress Bar Modal -->
<div class="modal" id="progressModal" style="display: none;">
    <div class="modal-content">
        <h6 id="progress-text">Generating Note<span id="ellipsis"></span></h6>
        <div class="progress-bar">
            <div class="progress-fill" style="width: 0%;">
                <span class="progress-percent">0%</span> <!-- Percentage inside the progress bar -->
            </div>
        </div>
        <p id="error-message" style="display: none; color: red; text-align: center;">Please try again.</p> <!-- Error message -->
    </div>
</div>



<!-- PDF Upload Modal -->
<div class="modal4" id="pdfUploadModal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <div class="pdf-upload-container">
            <div class="pdf-icon-container">
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="64" height="64" viewBox="0 0 791.454 791.454" class="note-icon pdf-icon">
                    <g>
                        <path fill="var(--accent-color)" fill-rule="evenodd" d="M202.808 0h264.609l224.265 233.758v454.661c0 56.956-46.079 103.035-102.838 103.035H202.808c-56.956 0-103.035-46.079-103.035-103.035V103.035C99.772 46.079 145.851 0 202.808 0z" clip-rule="evenodd" ></path>
                        <g fill="#fff">
                            <path fill-rule="evenodd" d="M467.219 0v231.978h224.463z" clip-rule="evenodd" opacity=".302" fill="#ffffff" ></path>
                            <path d="M214.278 590.525V445.959h61.505c15.228 0 27.292 4.153 36.389 12.657 9.097 8.306 13.646 19.579 13.646 33.62s-4.549 25.314-13.646 33.62c-9.097 8.504-21.161 12.657-36.389 12.657H251.26v52.012zm36.982-83.456h20.37c5.537 0 9.888-1.187 12.855-3.955 2.966-2.571 4.549-6.131 4.549-10.877s-1.582-8.306-4.549-10.877c-2.966-2.769-7.317-3.955-12.855-3.955h-20.37zm89.785 83.456V445.959h51.221c10.086 0 19.579 1.384 28.478 4.351 8.899 2.966 17.008 7.12 24.127 12.855 7.12 5.537 12.855 13.052 17.008 22.545 3.955 9.493 6.131 20.37 6.131 32.631 0 12.064-2.175 22.941-6.131 32.433-4.153 9.493-9.888 17.008-17.008 22.545-7.12 5.735-15.228 9.888-24.127 12.855-8.899 2.966-18.392 4.351-28.478 4.351zm36.191-31.444h10.679c5.735 0 11.075-.593 16.019-1.978 4.746-1.384 9.295-3.56 13.646-6.526 4.153-2.966 7.515-7.12 9.888-12.657s3.56-12.064 3.56-19.579c0-7.713-1.187-14.239-3.56-19.776s-5.735-9.69-9.888-12.657c-4.351-2.966-8.899-5.142-13.646-6.526-4.944-1.384-10.284-1.978-16.019-1.978h-10.679zM486.6 590.525V445.959h102.838v31.445h-65.856v23.138h52.605v31.247h-52.605v58.736z" fill="#ffffff" ></path>
                        </g>
                    </g>
                </svg>
            </div>
            <h3 class="modal-header">PDF Upload</h3>
            <div class="pdf-drag-area" id="pdfDragArea">
                <p>Drag PDF file here, or <span class="file-select">click to select</span></p>
                <input type="file" id="pdfFileInput" accept=".pdf" style="display:none">
            </div>
<!-- Progress bar -->
<div class="upload-progress" style="display: none;">
    <p id="uploading-text">
        Uploading<span id="ellipsis2"></span> <!-- Ellipsis here -->
    </p>
    <p style="color: gray; font-size: 0.9em;">
        Please wait a few moments to process large PDFs. If the file is too large, the operation may fail. Consider trying a smaller file if you encounter issues.
    </p>
    
    <div class="progress-container" style="position: relative; width: 100%; max-width: 500px;">
        <progress id="progressBar2" value="" max="100"></progress> <!-- Progress bar element -->
        <span class="progress-percentage" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #000;">0%</span> <!-- Centered percentage display -->
    </div>
    
    <!-- Estimated time remaining display -->
    <p id="estimated-time" style="color: gray; font-size: 0.9em; margin-top: 10px; display: none;">
        Estimated time remaining: <span id="time-remaining">Calculating...</span>
    </p>
</div>





        </div>
    </div>
</div>


    </body>
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>

    <script>
        // Firebase project configuration
        var firebaseConfig = {
            apiKey: "AIzaSyDaMAlQRMXiDsZ4P0b06P18id3y5xBiZ1k",
            authDomain: "deepworkai-c3419.firebaseapp.com",
            projectId: "deepworkai-c3419",
            storageBucket: "deepworkai-c3419.appspot.com",
            messagingSenderId: "367439182644",
            appId: "1:367439182644:web:304216430df97eff68c361"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        // Initialize Firestore
        const db = firebase.firestore();
        var auth = firebase.auth();
        const firestore = firebase.firestore();

        document.addEventListener('DOMContentLoaded', function() {
            firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                    const username = user.displayName || user.email;
                    document.getElementById('username').textContent = username;
                    document.getElementById('displayName').textContent = username;
                    loadNotes();        // Load AI note
                    loadManualNotes();  // Load manual note
                } else {
                    // No user is signed in.
                    window.location.href = "login.html"; // Redirect to login page
                }
            });
        });

document.addEventListener('DOMContentLoaded', function() {
    auth.onAuthStateChanged(function(user) {
        if (user) {
            const devEmails = ['srinibaj10@gmail.com', 'fugegate@gmail.com', 'draco77654@gmail.com', 'bajinsrinivasr@lexington1.net'];

            // Fetch the current user's data from Firestore
            db.collection('users').doc(user.uid).get()
                .then((doc) => {
                    if (doc.exists) {
                        const userData = doc.data();
                        const userEmail = user.email;
                        const isDev = devEmails.includes(userEmail);
                        let displayName = user.displayName || user.email;

                        // Create the updated display name with "DEV" or "BASIC" tag if necessary
                        let newDisplayName = displayName;
                        let shouldUpdateFirestore = false;

                        if (isDev && !displayName.includes('<span class="dev-tag">DEV</span>')) {
                            newDisplayName += ' <span class="dev-tag">DEV</span>';
                            shouldUpdateFirestore = true;  // Mark to update Firestore
                        } else if (!isDev && !displayName.includes('<span class="basic-tag">Basic</span>')) {
                            newDisplayName += ' <span class="basic-tag">Basic</span>';
                        }

                        // Update the UI with the user's display name (safely with innerHTML)
                        document.getElementById('username').innerHTML = newDisplayName;

                        // Optionally update the Firestore document if the "DEV" tag was added or updated
                        if (shouldUpdateFirestore) {
                            return db.collection('users').doc(user.uid).update({
                                displayName: newDisplayName
                            }).then(() => {
                                console.log("Display name updated to include 'DEV' tag successfully!");
                            });
                        }
                    }
                })
                .catch((error) => {
                    console.error("Error fetching user data:", error);
                });
        }
    });
});



// Helper function to calculate and display the estimated time remaining
function updateEstimatedTime(startTime, currentProgress, totalProgress) {
    const elapsedTime = Date.now() - startTime; // Time passed in milliseconds

    if (currentProgress === 0) {
        return 'Calculating...'; // If no progress is made yet
    }

    // Calculate the estimated total time
    const estimatedTotalTime = (elapsedTime / currentProgress) * totalProgress; // total time = elapsed time / progress made * total progress
    const remainingTime = estimatedTotalTime - elapsedTime; // Time remaining

    const secondsRemaining = Math.max(Math.floor(remainingTime / 1000), 1); // Ensure at least 1 second

    // Format as minutes and seconds (if applicable)
    const minutes = Math.floor(secondsRemaining / 60);
    const seconds = secondsRemaining % 60;

    if (minutes > 0) {
        return `Estimated time remaining: ${minutes}m ${seconds}s`;
    } else {
        return `Estimated time remaining: ${seconds}s`;
    }
}



async function handleFileUpload(file) {
    console.log('File upload started...');
    
    const progressBar = document.getElementById('progressBar2');
    const percentageDisplay = document.createElement('span');
    const uploadingText = document.getElementById('uploading-text');
    const errorMessage = document.querySelector('.error-message2');
    const estimatedTimeDisplay = document.getElementById('estimated-time'); // Get the element for estimated time

    if (errorMessage) {
        errorMessage.innerText = ''; // Clear any existing error message
        errorMessage.style = ''; // Clear inline styles
    }

    // Show progress bar and estimated time display
    progressContainer.style.display = 'block';
    progressBar.value = 0;
    percentageDisplay.innerText = '';
    percentageDisplay.style = '';
    estimatedTimeDisplay.style.display = 'block'; // Make sure it's visible

    // Change "Uploading" to "Generating Note"
    uploadingText.innerHTML = 'Uploading<span id="ellipsis2"></span>';

    const startTime = Date.now(); // Capture the start time

    // Read PDF file
    const reader = new FileReader();
    reader.readAsArrayBuffer(file);

    reader.onload = async function () {
        try {
            console.log('PDF file read successfully, processing PDF...');
            const pdfData = new Uint8Array(reader.result);
            const pdf = await pdfjsLib.getDocument({ data: pdfData }).promise;

            let textContent = '';
            const totalPages = pdf.numPages; // Total number of pages for progress tracking

            const estimatedTimeDisplay = document.getElementById('estimated-time'); // Get the element for estimated time


            // Process each page and update progress
            for (let pageNum = 1; pageNum <= totalPages; pageNum++) {
                console.log(`Processing page ${pageNum} of ${pdf.numPages}...`);
                const page = await pdf.getPage(pageNum);
                const text = await page.getTextContent();
                textContent += text.items.map(item => item.str).join(' ');

                // Update progress bar and estimated time after each page is processed
                const progress = (pageNum / totalPages) * 100;
                const percentageDisplay = document.createElement('span');
                progressBar.value = progress;
                percentageDisplay.innerText = `${Math.round(progress)}%`;
                estimatedTimeDisplay.innerText = updateEstimatedTime(startTime, pageNum, totalPages);
                percentageDisplay.style.color = 'white'; // Ensure the text color is white if needed
                // Ensure the percentage display is positioned at the center of the progress bar
                percentageDisplay.style.position = 'absolute'; // Set positioning to absolute
                percentageDisplay.style.top = '50%'; // Center vertically
                percentageDisplay.style.left = '50%'; // Center horizontally
                percentageDisplay.style.transform = 'translate(-50%, -50%)'; // Offset for proper centering

            }

            console.log('Extracted text:', textContent); // Log extracted text

            if (!textContent) {
                throw new Error('No text extracted from PDF.');
            }

            console.log('PDF text extraction complete.');

            // Change "Uploading" to "Generating Note"
            uploadingText.innerHTML = 'Processing PDF<span id="ellipsis2"></span>';

            // Simulate real-time upload progress
            await simulateRealTimeUploadProgress2();

            let progress = 0;



try {
    // Generate overview and key points
    const { overview, keyPoints } = await generateSummary(textContent);
    console.log('Overview and key points generation complete.');

    // Generate questions based on key points
    const { questions, rawResponses } = await generateQuestions(keyPoints); // Extract questions and raw responses
    console.log('Generated Questions:', questions);

    // Save overview, key points, and raw questions to Firestore
   await saveToFirestore2(file.name, overview, keyPoints, questions);
    console.log('Overview, key points, and questions saved to Firestore.');
    

            closePdfUploadModal();
            loadAllNotes();
                
                // Hide progress bar after everything is done
                progressContainer.style.display = 'none';
                progressBar.value = 0;


            } catch (error) {

                summaryContainer.style.display = 'block';
                console.error('Error during summary generation: ' + error.message);


// Create the percentage display element
const percentageDisplay = document.createElement('span');
percentageDisplay.className = 'progress-percentage'; // Ensure it has the same styling
percentageDisplay.innerText = 'Failed'; // Set the text to "Failed"

// Set the background to match the progress bar fill
percentageDisplay.style.background = 'linear-gradient(90deg, #c9302c, #c9302c)'; // Error color gradient
percentageDisplay.style.color = '#fff'; // Set text color for better contrast
percentageDisplay.style.padding = '5px 10px'; // Add padding
percentageDisplay.style.borderRadius = '18px'; // Match rounded corners of progress bar
percentageDisplay.style.boxShadow = '0 3px 10px rgba(201, 48, 44, 0.3)'; // Match shadow to error gradient
percentageDisplay.style.display = 'inline-block'; // Ensure it's inline to fit the flow
percentageDisplay.style.transition = 'width 1.5s ease-out'; // Smooth transition, just like the progress bar
percentageDisplay.style.width = '410px'; // Set a longer width, adjust as needed

// Clear existing percentage display, if any, before adding
const existingPercentageDisplay = document.querySelector('.progress-percentage');
if (existingPercentageDisplay) {
    existingPercentageDisplay.remove();
}

// Append the "Failed" text to the progress bar
progressBar.parentNode.insertBefore(percentageDisplay, progressBar.nextSibling);

const uploadingText = document.getElementById('uploading-text'); // Get the "Uploading" text element
// Change "Uploading" to "Eror"
uploadingText.innerHTML = '⚠️ Error';

const estimatedTimeDisplay = document.getElementById('estimated-time'); // Get the element for estimated time

estimatedTimeDisplay.style.display = 'none'; // Make sure it's not visible

// Create the "Please try again" error message
const errorMessage = document.createElement('span');
errorMessage.innerText = 'Please try again.'; // Set the error text
errorMessage.style.color = '#dc3545'; // Set the text color to red
errorMessage.style.fontSize = '14px'; // Set a suitable font size
errorMessage.style.display = 'block'; // Ensure it's displayed underneath

// Apply absolute positioning to the error message
errorMessage.style.position = 'absolute'; // Make it absolute so it doesn't interfere with layout
errorMessage.style.left = '50%'; // Center it horizontally
errorMessage.style.transform = 'translateX(-50%)'; // Adjust for proper centering
errorMessage.style.top = '105%'; // Adjust the top position to move it closer to the "Failed" text

// Ensure the parent element has relative positioning to anchor the absolute position correctly
progressBar.parentNode.style.position = 'relative';

// Clear existing error message, if any, before adding
const existingErrorMessage = document.querySelector('.error-message2');
if (existingErrorMessage) {
    existingErrorMessage.remove();
}
errorMessage.className = 'error-message2'; // Add class for future reference

// Append the "Please try again" message below the progress bar
progressBar.parentNode.appendChild(errorMessage);







            }
        } catch (error) {
            console.error('Error processing PDF: ' + error.message);

// Create the percentage display element
const percentageDisplay = document.createElement('span');
percentageDisplay.className = 'progress-percentage'; // Ensure it has the same styling
percentageDisplay.innerText = 'Failed'; // Set the text to "Failed"

// Set the background to match the progress bar fill
percentageDisplay.style.background = 'linear-gradient(90deg, #c9302c, #c9302c)'; // Error color gradient
percentageDisplay.style.color = '#fff'; // Set text color for better contrast
percentageDisplay.style.padding = '5px 10px'; // Add padding
percentageDisplay.style.borderRadius = '18px'; // Match rounded corners of progress bar
percentageDisplay.style.boxShadow = '0 3px 10px rgba(201, 48, 44, 0.3)'; // Match shadow to error gradient
percentageDisplay.style.display = 'inline-block'; // Ensure it's inline to fit the flow
percentageDisplay.style.transition = 'width 1.5s ease-out'; // Smooth transition, just like the progress bar
percentageDisplay.style.width = '410px'; // Set a longer width, adjust as needed

// Clear existing percentage display, if any, before adding
const existingPercentageDisplay = document.querySelector('.progress-percentage');
if (existingPercentageDisplay) {
    existingPercentageDisplay.remove();
}

// Append the "Failed" text to the progress bar
progressBar.parentNode.insertBefore(percentageDisplay, progressBar.nextSibling);

const uploadingText = document.getElementById('uploading-text'); // Get the "Uploading" text element
// Change "Uploading" to "Generating Note"
uploadingText.innerHTML = '⚠️ Error';

const estimatedTimeDisplay = document.getElementById('estimated-time'); // Get the element for estimated time

estimatedTimeDisplay.style.display = 'none'; // Make sure it's not visible

// Create the "Please try again" error message
const errorMessage = document.createElement('span');
errorMessage.innerText = 'Please try again.'; // Set the error text
errorMessage.style.color = '#dc3545'; // Set the text color to red
errorMessage.style.fontSize = '14px'; // Set a suitable font size
errorMessage.style.display = 'block'; // Ensure it's displayed underneath

// Apply absolute positioning to the error message
errorMessage.style.position = 'absolute'; // Make it absolute so it doesn't interfere with layout
errorMessage.style.left = '50%'; // Center it horizontally
errorMessage.style.transform = 'translateX(-50%)'; // Adjust for proper centering
errorMessage.style.top = '105%'; // Adjust the top position to move it closer to the "Failed" text

// Ensure the parent element has relative positioning to anchor the absolute position correctly
progressBar.parentNode.style.position = 'relative';

// Clear existing error message, if any, before adding
const existingErrorMessage = document.querySelector('.error-message2');
if (existingErrorMessage) {
    existingErrorMessage.remove();
}
errorMessage.className = 'error-message2'; // Add class for future reference

// Append the "Please try again" message below the progress bar
progressBar.parentNode.appendChild(errorMessage);



        }
    };

    reader.onerror = function () {
        console.error('Failed to read PDF file: ' + reader.error);


// Create the percentage display element
const percentageDisplay = document.createElement('span');
percentageDisplay.className = 'progress-percentage'; // Ensure it has the same styling
percentageDisplay.innerText = 'Failed'; // Set the text to "Failed"

// Set the background to match the progress bar fill
percentageDisplay.style.background = 'linear-gradient(90deg, #c9302c, #c9302c)'; // Error color gradient
percentageDisplay.style.color = '#fff'; // Set text color for better contrast
percentageDisplay.style.padding = '5px 10px'; // Add padding
percentageDisplay.style.borderRadius = '18px'; // Match rounded corners of progress bar
percentageDisplay.style.boxShadow = '0 3px 10px rgba(201, 48, 44, 0.3)'; // Match shadow to error gradient
percentageDisplay.style.display = 'inline-block'; // Ensure it's inline to fit the flow
percentageDisplay.style.transition = 'width 1.5s ease-out'; // Smooth transition, just like the progress bar
percentageDisplay.style.width = '410px'; // Set a longer width, adjust as needed

// Clear existing percentage display, if any, before adding
const existingPercentageDisplay = document.querySelector('.progress-percentage');
if (existingPercentageDisplay) {
    existingPercentageDisplay.remove();
}

// Append the "Failed" text to the progress bar
progressBar.parentNode.insertBefore(percentageDisplay, progressBar.nextSibling);

const uploadingText = document.getElementById('uploading-text'); // Get the "Uploading" text element
// Change "Uploading" to "Generating Note"
uploadingText.innerHTML = '⚠️ Error';

const estimatedTimeDisplay = document.getElementById('estimated-time'); // Get the element for estimated time

estimatedTimeDisplay.style.display = 'none'; // Make sure it's not visible

// Create the "Please try again" error message
const errorMessage = document.createElement('span');
errorMessage.innerText = 'Please try again.'; // Set the error text
errorMessage.style.color = '#dc3545'; // Set the text color to red
errorMessage.style.fontSize = '14px'; // Set a suitable font size
errorMessage.style.display = 'block'; // Ensure it's displayed underneath

// Apply absolute positioning to the error message
errorMessage.style.position = 'absolute'; // Make it absolute so it doesn't interfere with layout
errorMessage.style.left = '50%'; // Center it horizontally
errorMessage.style.transform = 'translateX(-50%)'; // Adjust for proper centering
errorMessage.style.top = '105%'; // Adjust the top position to move it closer to the "Failed" text

// Ensure the parent element has relative positioning to anchor the absolute position correctly
progressBar.parentNode.style.position = 'relative';

// Clear existing error message, if any, before adding
const existingErrorMessage = document.querySelector('.error-message2');
if (existingErrorMessage) {
    existingErrorMessage.remove();
}
errorMessage.className = 'error-message2'; // Add class for future reference

// Append the "Please try again" message below the progress bar
progressBar.parentNode.appendChild(errorMessage);



    };
}

// Helper function for real-time upload progress
async function simulateRealTimeUploadProgress() {
    const progressBar = document.getElementById('progressBar2');
    const percentageDisplay = document.querySelector('.progress-percentage');
    let startTime = Date.now(); // Record the start time

    let progress = 0;
    let estimatedUploadTime = 8000; // Initial estimated time for the entire process (e.g., 8 seconds)

    return new Promise((resolve) => {
        const uploadInterval = setInterval(() => {
            const elapsedTime = Date.now() - startTime; // Time elapsed since start
            const estimatedTotalTime = (elapsedTime / progress) * 100 || estimatedUploadTime; // Recalculate estimated total time
            const remainingTime = estimatedTotalTime - elapsedTime; // Time remaining

            progress = Math.min((elapsedTime / estimatedUploadTime) * 100, 100); // Calculate percentage based on time
            
            progressBar.value = progress; // Update progress bar fill
            percentageDisplay.innerText = `${Math.floor(progress)}%`; // Update percentage display

            if (progress >= 100) {
                clearInterval(uploadInterval); // Stop updating once 100% is reached
                resolve();
            }
        }, 100); // Update progress every 100ms for smoother transitions
    });
}

// Helper function for real-time upload progress
async function simulateRealTimeUploadProgress2() {
    const progressBar = document.getElementById('progressBar2');
    const percentageDisplay = document.querySelector('.progress-percentage');
    let startTime = Date.now(); // Record the start time

    const estimatedUploadTime = 8000; // Estimated time for the entire process (8 seconds)
    let progress = 0;

    return new Promise((resolve) => {
        const uploadInterval = setInterval(() => {
            const elapsedTime = Date.now() - startTime;
            progress = Math.min((elapsedTime / estimatedUploadTime) * 100, 100); // Calculate percentage based on time

            progressBar.value = progress; // Update progress bar fill
            percentageDisplay.style = ''; // Clear inline styles
            percentageDisplay.innerText = `${Math.floor(progress)}%`; // Update percentage display

            
            

            if (progress >= 100) {
                clearInterval(uploadInterval); // Stop updating once 100% is reached
                resolve();
            }
        }, 100); // Update progress every 100ms for smoother transitions
    });
}

// Hugging Face API setup
const huggingFaceApiKey = "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";
const modelEndpoint = "https://api-inference.huggingface.co/models/facebook/bart-large-cnn";

// File input and progress bar elements
const pdfFileInput = document.getElementById('pdfFileInput');
const pdfDragArea = document.getElementById('pdfDragArea');
const progressBar = document.getElementById('progressBar2');
const progressContainer = document.querySelector('.upload-progress');
const summaryContainer = document.getElementById('summaryContainer');
const pdfSummary = document.getElementById('pdfSummary');
// Get modal and elements
const pdfModal = document.getElementById("pdfUploadModal");
const closeButton = document.querySelector(".close-button");
// Function to open the modal
function openPdfUploadModal() {
    pdfModal.style.display = "flex";
}

// Function to close the modal
function closePdfUploadModal() {
    pdfModal.style.display = "none";
}

// Close modal when clicking outside the modal content
window.onclick = (event) => {
    if (event.target === pdfModal) {
        closePdfUploadModal();
    }
};

// Close modal when clicking the close button
closeButton.onclick = closePdfUploadModal;

// File input click handler
pdfDragArea.addEventListener('click', () => {
    console.log('File input clicked.');
    pdfFileInput.click();
});

// Handle file selection
pdfFileInput.addEventListener('change', () => {
    if (pdfFileInput.files.length > 0) {
        console.log('File selected: ' + pdfFileInput.files[0].name);
        handleFileUpload(pdfFileInput.files[0]);
    } else {
        console.warn('No file selected.');
    }
});

// Drag-and-drop support
pdfDragArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    pdfDragArea.classList.add('dragover');
    console.log('File is being dragged over the area.');
});

pdfDragArea.addEventListener('dragleave', () => {
    pdfDragArea.classList.remove('dragover');
    console.log('File drag left the area.');
});

pdfDragArea.addEventListener('drop', (e) => {
    e.preventDefault();
    pdfDragArea.classList.remove('dragover');
    console.log('File dropped onto the area.');

    if (e.dataTransfer.files.length > 0) {
        console.log('File selected via drag-and-drop: ' + e.dataTransfer.files[0].name);
        handleFileUpload(e.dataTransfer.files[0]);
    } else {
        console.warn('No file dropped.');
    }
});

// Set PDF.js worker source
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

// Helper function to wait for a certain amount of time (in ms)
function delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

// Helper function to split text into chunks by character limit
function splitTextIntoChunks(text, maxLength = 2000) {
    console.log('Splitting text into chunks...');
    const chunks = [];
    let start = 0;
    while (start < text.length) {
        const end = start + maxLength;
        chunks.push(text.slice(start, end));
        start = end;
    }
    console.log(`Text split into ${chunks.length} chunk(s).`);
    return chunks;
}

async function generateSummary(text, maxRetries = 5, delayInterval = 5000) {
    console.log('Generating summary and key points...');
    const chunks = splitTextIntoChunks(text);
    const summaries = [];
    const keyPoints = [];
    const totalChunks = chunks.length; // Total number of chunks
    const startTime = Date.now(); // Capture the start time

    // Ensure this is defined before the loop
    const estimatedTimeDisplay = document.getElementById('estimated-time'); // Get the element for estimated time
    const progressBar = document.getElementById('progressBar2'); // Get the progress bar element
    const percentageDisplay = document.querySelector('.progress-percentage'); // Get the percentage display element

    const uploadingText = document.getElementById('uploading-text');
    uploadingText.innerHTML = 'Generating Note<span id="ellipsis2"></span>';

    // Start simulating progress
    await simulateRealTimeUploadProgress();

    for (let i = 0; i < totalChunks; i++) {
        let chunk = chunks[i];
        let attempt = 0;

        while (attempt < maxRetries) {
            try {
                console.log('Sending chunk to Hugging Face API...');
                const response = await fetch(modelEndpoint, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${huggingFaceApiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ inputs: chunk })
                });

                if (response.ok) {
                    const result = await response.json();
                    const summary = result[0].summary_text;
                    summaries.push(summary);

                    // Generate key points based on the summary
                    const sentences = summary.split('. ');
                    keyPoints.push(...sentences.map(sentence => sentence.trim() + '.')); // Ensure full sentences

                    console.log('Received summary for chunk.');

                    // Update the estimated time and progress after processing each chunk
                    const currentProgress = (i + 1) / totalChunks * 100; // Calculate percentage based on chunks processed
                    const elapsedTime = Date.now() - startTime;
                    const estimatedTotalTime = (elapsedTime / (i + 1)) * totalChunks; // Recalculate estimated total time
                    const remainingTime = estimatedTotalTime - elapsedTime;

                    // Update progress bar and percentage display
                    progressBar.value = currentProgress;
                    percentageDisplay.innerText = `${Math.floor(currentProgress)}%`;

// Update the display for estimated time remaining
if (estimatedTimeDisplay) {
    const minutes = Math.floor(remainingTime / 60000); // Get minutes
    const seconds = Math.floor((remainingTime % 60000) / 1000); // Get remaining seconds

    const formattedRemainingTime = `${minutes}m ${seconds}s`; // Format as "Xm Ys"
    estimatedTimeDisplay.innerText = `Estimated time remaining: ${formattedRemainingTime}`;
}


                    break; // Exit retry loop after successful response

                } else {
                    const errorDetails = await response.json();

                    if (errorDetails.error && errorDetails.error.includes('loading')) {
                        console.log(`Attempt ${attempt + 1}: Model is still loading. Retrying in ${delayInterval / 1000} seconds...`);
                        await delay(delayInterval); // Wait and retry
                        attempt++;
                    } else {
                        console.error(`Error from Hugging Face API: ${errorDetails.error}`);
                        throw new Error(`Error generating summary: ${errorDetails.error}`);
                    }
                }
            } catch (error) {
                console.error(`Failed to generate summary: ${error.message}`);
                if (attempt < maxRetries - 1) {
                    console.log(`Retrying in ${delayInterval / 1000} seconds...`);
                    await delay(delayInterval);
                    attempt++;
                } else {
                    throw error;
                }
            }
        }
    }

    console.log('Summary generation complete.');

    // Combine summaries and limit overview to a maximum of 4 sentences
    const combinedOverview = summaries.join(' ');
    const overviewSentences = combinedOverview.split('. ').slice(0, 4).join('. '); // Limit to 4 sentences

    return {
        overview: overviewSentences, // Final overview limited to 4 sentences
        keyPoints
    };
}




async function generateQuestions(keyPoints, maxRetries = 5, delayInterval = 5000) {
    console.log('Generating questions...');
    const maxQuestions = Math.min(keyPoints.length, 15); // Limit to max 5 questions
    const questions = []; // To store the final questions
    const rawResponses = []; // To store the full raw API responses

    for (let i = 0; i < maxQuestions; i++) {
        let keyPoint = keyPoints[i];
        let attempt = 0;
        let successful = false; // Track if we successfully parsed the question

        const prompt = `
Create a multiple-choice question based on the following key point:

Key Point: "${keyPoint}"

Please generate the output in this exact format:

Question: (Provide a clear, complete question based on the key point)

Answer Choices:
A. (Provide the first answer choice)
B. (Provide the second answer choice)
C. (Provide the third answer choice)
D. (Provide the fourth answer choice)

Correct Answer: (Indicate the correct answer by its letter: A, B, C, or D)

Important:
- Ensure there is exactly one correct answer.
- The question and answer choices should be clearly written and directly related to the key point.
- Each choice should be on its own line with a newline separating "Answer Choices" and "Correct Answer".
- Avoid any incomplete or malformed responses. Do not include any additional text or explanations outside the specified format.
`;

        while (attempt < maxRetries && !successful) {
            try {
                console.log(`Sending prompt to Hugging Face API for key point ${i + 1}...`);
                const response = await fetch("https://api-inference.huggingface.co/models/meta-llama/Llama-3.2-11B-Vision-Instruct", {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${huggingFaceApiKey}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ inputs: prompt })
                });

                if (response.ok) {
                    const result = await response.json();
                    rawResponses.push(result); // Save the raw response

                    const generatedText = result[0]?.generated_text || ""; // Ensure result[0] exists
                    console.log(`Generated text for key point ${i + 1}:`, generatedText); // Log the generated text

                    // Handle the case where the response is incomplete or incorrectly formatted
                    if (!generatedText.includes('Question:') || !generatedText.includes('Answer Choices:') || !generatedText.includes('Correct Answer:')) {
                        console.error(`Malformed response for key point ${i + 1}:`, generatedText);
                        break; // Skip this key point if it's malformed
                    }

                    // Extract question and answer choices parts
                    const questionPart = generatedText.split("Answer Choices:")[0].replace("Question:", "").trim();
                    const choicesPart = generatedText.split("Answer Choices:")[1].split("Correct Answer:")[0].trim();
                    const correctAnswerText = generatedText.split("Correct Answer:")[1]?.trim();

                    // Parse the question
                    const question = questionPart.trim();

                    // Split and clean up choices, ensuring no extra text
                    const choicesArray = choicesPart.split(/^[A-D]\./m).slice(1).map(choice => choice.trim());

                    // Ensure choices array has exactly 4 options
                    if (choicesArray.length !== 4) {
                        console.error(`Failed to parse exactly 4 choices for key point ${i + 1}`);
                        break; // Skip if we do not have exactly 4 choices
                    }

                    // Parse the correct answer letter, tolerate extra whitespace or unexpected text
                    const correctAnswerMatch = correctAnswerText && /^[A-D]/.exec(correctAnswerText);
                    const correctAnswer = correctAnswerMatch ? correctAnswerMatch[0] : null;

                    if (!correctAnswer) {
                        console.error(`Failed to parse correct answer for key point ${i + 1}:`, correctAnswerText);
                        break; // Skip this key point if the correct answer is malformed
                    }

                    // Save the successfully generated question
                    const generatedQuestion = {
                        keyPoint: keyPoint,
                        question: question,
                        choices: choicesArray,
                        correctAnswer: correctAnswer
                    };

                    questions.push(generatedQuestion); // Add the generated question to the list
                    console.log(`Successfully generated question for key point ${i + 1}.`);
                    successful = true; // Mark this key point as successfully processed

                } else {
                    const errorDetails = await response.json();
                    console.error(`Error generating question for key point ${i + 1}:`, errorDetails);

                    if (errorDetails.error && errorDetails.error.includes('loading')) {
                        console.log(`Attempt ${attempt + 1}: Model is still loading. Retrying in ${delayInterval / 1000} seconds...`);
                        await delay(delayInterval); // Wait and retry
                        attempt++;
                    } else {
                        throw new Error(`Error generating question: ${errorDetails.error}`);
                    }
                }
            } catch (error) {
                console.error(`Failed to generate question for key point ${i + 1}: ${error.message}`);
                if (attempt < maxRetries - 1) {
                    console.log(`Retrying in ${delayInterval / 1000} seconds...`);
                    await delay(delayInterval);
                    attempt++;
                } else {
                    break; // Skip this key point if all retries fail
                }
            }
        }
    }

    // Return the successfully generated questions and the raw API responses
    console.log('Question generation complete.');
    return {
        questions,    // List of successfully generated questions
        rawResponses  // Raw API responses (including failed ones)
    };
}

















// Clean up and flatten questions array
function flattenQuestions(questions) {
    return questions.map(q => {
        const generatedText = q.generatedText || ""; // Access raw generated text

        // Extracting question and choices from generatedText
        const questionMatch = generatedText.match(/Question:\s*(.*?)\n\s*- Choices:/);
        const choicesMatch = generatedText.match(/- Choices:\s*((?:\s*\d+\.\s.*?)+)/);
        const correctAnswerMatch = generatedText.match(/The required format of the answer is:\s*(\d)/);

        // Clean and assign values
        const question = questionMatch ? questionMatch[1].trim() : "No question provided";

        const choicesText = choicesMatch ? choicesMatch[1].trim() : "";
        const choicesArray = choicesText.split('\n').map(choice => choice.trim()).slice(0, 4);

        // Ensure choices array has exactly 4 elements
        const finalChoices = choicesArray.length >= 4 ? choicesArray : Array(4).fill("No option");

        // Get the correct answer
        const correctAnswer = correctAnswerMatch ? parseInt(correctAnswerMatch[1]) : 1; // Default to 1 if not found

        // Ensure correct answer is between 1 and 4
        const validCorrectAnswer = (correctAnswer >= 1 && correctAnswer <= 4) ? correctAnswer : 1;

        return {
            question: question,
            choices: finalChoices,
            correctAnswer: validCorrectAnswer
        };
    });
}

// Function to save overview, key points, and raw questions to Firestore
async function saveToFirestore2(fileName, overview, keyPoints, rawGeneratedTexts) {
    const userId = firebase.auth().currentUser?.uid;
    if (!userId) {
        console.error("User not authenticated yet");
        return;
    }

    try {
        // Add the PDF data to Firestore in the 'generatedpdfs' collection
        await db.collection('generatedpdfs').add({
            userId: userId,
            fileName: fileName,             // Store the file name
            overview: overview,             // Store the generated overview
            keyPoints: keyPoints,           // Store the array of key points
            rawQuestions: rawGeneratedTexts, // Store the array of raw generated texts (full responses)
            timestamp: firebase.firestore.FieldValue.serverTimestamp() // Add timestamp
        });
        console.log(`Overview, key points, and questions for ${fileName} saved successfully.`);
    } catch (error) {
        console.error("Error saving to Firestore: ", error);
    }
}







function loadAllNotes() {
    const userId = firebase.auth().currentUser?.uid; // Get current user's ID
    const notesList = document.getElementById('notes-list');
    notesList.innerHTML = ''; // Clear the list before adding notes

    if (!userId) {
        console.error("User not authenticated yet");
        return;
    }

    // Load manual and generated notes together
    loadManualNotes();
    loadGeneratedNotes();
    loadGeneratedPDFs();
    
}


function loadManualNotes() {
    db.collection('manualnotes')
        .where('userId', '==', firebase.auth().currentUser.uid)
        .orderBy('createdAt')
        .onSnapshot(snapshot => {
            // Clear only manual notes
            const manualNotes = document.querySelectorAll("[data-type='manualnote']");
            manualNotes.forEach(note => note.remove());

            snapshot.forEach(doc => {
                const note = doc.data();
                const noteDiv = document.createElement('div');
                noteDiv.className = 'note-item';
                noteDiv.setAttribute('data-id', doc.id); // Set data-id for easy reference
                noteDiv.setAttribute('data-type', 'manualnote'); // Set data-type attribute

                noteDiv.innerHTML = `
                    <strong>${note.title}</strong> - ${note.date}<br/>
                    ${note.note}
                `;

                const buttonContainer = createButtonContainer();
                buttonContainer.appendChild(createEditButton(doc.id, 'manualnotes'));
                buttonContainer.appendChild(createDeleteButton(doc.id, 'manualnotes'));

                noteDiv.appendChild(buttonContainer);
                document.getElementById('notes-list').appendChild(noteDiv);
            });
        });
}


function loadGeneratedNotes() {
    const userId = firebase.auth().currentUser?.uid;

    if (!userId) {
        console.error("User not authenticated yet");
        return;
    }

    db.collection('generatednotes')
        .where('userId', '==', userId)
        .orderBy('timestamp', 'desc')
        .onSnapshot(snapshot => {
            const notesList = document.getElementById('notes-list');

            snapshot.docChanges().forEach(change => {
                const noteData = change.doc.data();
                const noteId = change.doc.id;

                // Extract title, overview, key points, and timestamp
                const title = noteData.title || "Untitled"; 
                const overview = noteData.overview || "No overview available.";
                const keyPoints = noteData.keyPoints || [];
                const timestamp = noteData.timestamp?.toDate();
                const dateCreated = timestamp ? timestamp.toLocaleDateString() + ' ' + timestamp.toLocaleTimeString() : "Unknown Date";

                if (change.type === "added" || change.type === "modified") {
                    let noteDiv = document.querySelector(`[data-id='${noteId}']`);
                    if (!noteDiv) {
                        noteDiv = document.createElement('div');
                        noteDiv.className = 'note-item';
                        noteDiv.setAttribute('data-id', noteId);
                        noteDiv.setAttribute('data-type', 'generatednote');
                    } else {
                        noteDiv.innerHTML = ''; 
                    }

                    // Format the key points as a list
                    const formattedKeyPoints = keyPoints.length > 0 
                        ? keyPoints.map(point => `<li>${point.trim()}</li>`).join('')
                        : "<li>No key points available.</li>";

                    // Set the innerHTML including the title, overview, key points, and date (questions section removed)
                    noteDiv.innerHTML = `
                        <strong>${title}</strong> <span class="date">${dateCreated}</span> <!-- Title and Date -->
                        <p><span class="overview-label"><strong2>Overview:</strong2></span> ${overview}</p> <!-- Display PDF Overview -->
                        <p><span class="key-points-label"><strong2>Key Points:</strong2></span></p> <!-- Display PDF Key Points -->
                        <ul>${formattedKeyPoints}</ul> <!-- Display PDF Key Points as a list -->
                        <div class="button-container">
                            <button class="edit" onclick="editItem('${noteId}', 'generatednotes')">Edit</button>
                            <button class="delete" onclick="deleteItem('${noteId}', 'generatednotes')">Delete</button>
                        </div>
                        <div class="ai-generated-tag">
                            <svg class="icon" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="-5.0 -10.0 110.0 135.0">
                                <path d="m74.773 57.645c-17.676 5.8398-23.562 11.727-29.402 29.402-0.48047 1.4531-2.5352 1.4531-3.0156 0-5.8398-17.676-11.727-23.562-29.402-29.402-1.4531-0.48047-1.4531-2.5352 0-3.0156 17.676-5.8398 23.562-11.727 29.402-29.402 0.48047-1.4531 2.5352-1.4531 3.0156 0 5.8398 17.676 11.727 23.562 29.402 29.402 1.4531 0.48047 1.4531 2.5352 0 3.0156z"/>
                                <path d="m87.594 28.617c-8.8359 2.918-11.781 5.8633-14.703 14.703-0.23828 0.72656-1.2656 0.72656-1.5078 0-2.918-8.8359-5.8633-11.781-14.703-14.703-0.72656-0.23828-0.72656-1.2656 0-1.5078 8.8359-2.918 11.781-5.8633 14.703-14.703 0.23828-0.72656 1.2656-0.72656 1.5078 0 2.918 8.8359 5.8633 11.781 14.703 14.703 0.72656 0.23828 0.72656 1.2656 0 1.5078z"/>
                            </svg>
                            <span>AI Generated</span>
                        </div>
<div class="quiz-btn" onclick="toggleNewAction()">
    <svg class="quiz-icon" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" fill="none">
        <g>
            <path d="M17.644 19.0181H21.3545L19.4984 14.5241L17.644 19.0181Z" fill="white"></path>
            <path d="M11.25 6C8.3505 6 6 8.35051 6 11.25V36.75C6 39.6495 8.35051 42 11.25 42H24.5187C23.2251 39.9794 22.4751 37.5773 22.4751 35C22.4751 33.4165 22.7582 31.899 23.2766 30.4956H11.25C10.5596 30.4956 10 29.936 10 29.2456C10 28.5553 10.5596 27.9956 11.25 27.9956H24.5215C26.8322 24.3897 30.8745 22 35.4751 22C37.8533 22 40.0823 22.6386 42 23.7536V11.25C42 8.3505 39.6495 6 36.75 6H11.25ZM10 35.25C10 34.5596 10.5596 34 11.25 34H19.2581C19.9484 34 20.5081 34.5596 20.5081 35.25C20.5081 35.9404 19.9484 36.5 19.2581 36.5H11.25C10.5596 36.5 10 35.9404 10 35.25ZM19.4977 9.99829C20.0039 9.99821 20.4601 10.3033 20.6533 10.7711L25.4053 22.2771C25.6688 22.9152 25.3652 23.6461 24.7271 23.9096C24.089 24.1732 23.3581 23.8695 23.0946 23.2315L22.387 21.5181H16.6123L15.9054 23.2311C15.6421 23.8693 14.9113 24.1731 14.2731 23.9098C13.635 23.6465 13.3311 22.9156 13.5945 22.2775L18.3424 10.7715C18.5355 10.3036 18.9916 9.99837 19.4977 9.99829ZM31.7476 9.99811C32.4379 9.99811 32.9976 10.5578 32.9976 11.2481V14H35.7501C36.4405 14 37.0001 14.5596 37.0001 15.25C37.0001 15.9404 36.4405 16.5 35.7501 16.5H32.9976V19.2483C32.9976 19.9386 32.4379 20.4983 31.7476 20.4983C31.0572 20.4983 30.4976 19.9386 30.4976 19.2483V16.5H27.75C27.0596 16.5 26.5 15.9404 26.5 15.25C26.5 14.5596 27.0596 14 27.75 14H30.4976V11.2481C30.4976 10.5578 31.0572 9.99811 31.7476 9.99811Z" fill="white"></path>
            <path d="M46.4751 35C46.4751 41.0751 41.5502 46 35.4751 46C29.4 46 24.4751 41.0751 24.4751 35C24.4751 28.9249 29.4 24 35.4751 24C41.5502 24 46.4751 28.9249 46.4751 35ZM36.4751 28C36.4751 27.4477 36.0274 27 35.4751 27C34.9228 27 34.4751 27.4477 34.4751 28V34H28.4751C27.9228 34 27.4751 34.4477 27.4751 35C27.4751 35.5523 27.9228 36 28.4751 36H34.4751V42C34.4751 42.5523 34.9228 43 35.4751 43C36.0274 43 36.4751 42.5523 36.4751 42V36H42.4751C43.0274 36 43.4751 35.5523 43.4751 35C43.4751 34.4477 43.0274 34 42.4751 34H36.4751V28Z" fill="white"></path>
        </g>
    </svg>
</div>

                        <div class="top-right-svg" onclick="toggleNoteView('${noteId}')">
                            <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" preserveAspectRatio="xMidYMid meet">
                                <g>
                                    <circle cx="10" cy="10" r="10" fill="var(--primary-color)"/> 
                                    <path fill="white" d="M13.098 8H6.902c-.751 0-1.172.754-.708 1.268L9.292 12.7c.36.399 1.055.399 1.416 0l3.098-3.433C14.27 8.754 13.849 8 13.098 8Z"></path>
                                </g>
                            </svg>
                        </div>
                    `;

                    // Append the note to the list if it's new
                    if (!notesList.contains(noteDiv)) {
                        notesList.appendChild(noteDiv);
                    }

                    // Check localStorage to see if this note should be collapsed or expanded
                    const savedState = localStorage.getItem(`note-${noteId}`);
                    if (savedState === 'collapsed') {
                        toggleNoteView(noteId); // Ensure it's collapsed
                    }
                } else if (change.type === "removed") {
                    const noteDiv = document.querySelector(`[data-id='${noteId}']`);
                    if (noteDiv) {
                        notesList.removeChild(noteDiv);
                    }
                }
            });
        }, error => {
            console.error('Error loading notes: ', error);
        });
}

function toggleNoteView(noteId) {
    const noteDiv = document.querySelector(`[data-id='${noteId}']`);
    const noteTitle = noteDiv.querySelector('strong'); // The note title is within a <strong> tag
    const dateSpan = noteDiv.querySelector('.date');
    const overview = noteDiv.querySelector('p:nth-of-type(1)'); // Assuming first <p> is the overview
    const keyPointsLabel = noteDiv.querySelector('.key-points-label'); // "Key Points" label
    const keyPoints = noteDiv.querySelector('ul'); // The list of key points
    const aiGeneratedTag = noteDiv.querySelector('.ai-generated-tag');
    const buttonContainer = noteDiv.querySelector('.button-container'); // Edit/Delete buttons
    let ellipsisContainer = noteDiv.querySelector('.ellipsis-container'); // Ellipsis container




// Define the updated SVG code
const svgIcon = `
    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: middle; margin-right: 8px;">
        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
        <g id="SVGRepo_iconCarrier">
            <path d="M16 4.25C16 5.49 14.99 6.5 13.75 6.5H10.25C9.63 6.5 9.07 6.25 8.66 5.84C8.25 5.43 8 4.87 8 4.25C8 3.01 9.01 2 10.25 2H13.75C14.37 2 14.93 2.25 15.34 2.66C15.75 3.07 16 3.63 16 4.25Z" fill="var(--primary-color)"></path>
            <path d="M18.83 5.02874C18.6 4.83874 18.34 4.68874 18.06 4.57874C17.77 4.46874 17.48 4.69874 17.42 4.99874C17.08 6.70874 15.57 7.99874 13.75 7.99874H10.25C9.25 7.99874 8.31 7.60874 7.6 6.89874C7.08 6.37874 6.72 5.71874 6.58 5.00874C6.52 4.70874 6.22 4.46874 5.93 4.58874C4.77 5.05874 4 6.11874 4 8.24874V17.9987C4 20.9987 5.79 21.9987 8 21.9987H16C18.21 21.9987 20 20.9987 20 17.9987V8.24874C20 6.61874 19.55 5.61874 18.83 5.02874ZM8 12.2487H12C12.41 12.2487 12.75 12.5887 12.75 12.9987C12.75 13.4087 12.41 13.7487 12 13.7487H8C7.59 13.7487 7.25 13.4087 7.25 12.9987C7.25 12.5887 7.59 12.2487 8 12.2487ZM16 17.7487H8C7.59 17.7487 7.25 17.4087 7.25 16.9987C7.25 16.5887 7.59 16.2487 8 16.2487H16C16.41 16.2487 16.75 16.5887 16.75 16.9987C16.75 17.4087 16.41 17.7487 16 17.7487Z" fill="var(--primary-color)"></path>
        </g>
    </svg>`;







// Define the vertical ellipsis SVG within a circular button
const verticalEllipsisIcon = `
    <div class="ellipsis-container" onclick="showModal('modal11', '${noteId}')">
        <div class="ellipsis-button">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: middle;">
                <circle cx="12" cy="5" r="2" fill="var(--text-color)"/>
                <circle cx="12" cy="12" r="2" fill="var(--text-color)"/>
                <circle cx="12" cy="19" r="2" fill="var(--text-color)"/>
            </svg>
        </div>
    </div>
`;


    if (noteDiv.classList.contains('collapsed')) {
        // Show all hidden content
        overview.style.display = 'block';
        keyPointsLabel.style.display = 'block';
        keyPoints.style.display = 'block';
        aiGeneratedTag.style.display = 'flex';
        buttonContainer.style.display = 'flex';
        dateSpan.style.display = 'inline';
        noteTitle.style.display = 'inline';
        noteDiv.classList.remove('collapsed');
        
        // Hide the ellipsis container if it exists
        if (ellipsisContainer) {
            ellipsisContainer.style.display = 'none';
        }

        // Remove the SVG icon if already present
        const svgElement = noteDiv.querySelector('svg');
        if (svgElement) svgElement.remove();

        // Save expanded state to localStorage
        localStorage.setItem(`note-${noteId}`, 'expanded');

    } else {
        // Hide the content
        overview.style.display = 'none';
        keyPointsLabel.style.display = 'none';
        keyPoints.style.display = 'none';
        aiGeneratedTag.style.display = 'none';
        buttonContainer.style.display = 'none';
        dateSpan.style.display = 'block';
        dateSpan.style.marginLeft = '0';
        noteTitle.style.display = 'block';

        // Add the SVG icon in front of the title and date
        noteTitle.insertAdjacentHTML('beforebegin', svgIcon);

        // Add or show the ellipsis container
        if (!ellipsisContainer) {
            ellipsisContainer = document.createElement('div');
            ellipsisContainer.classList.add('ellipsis-container');
            ellipsisContainer.innerHTML = verticalEllipsisIcon;
            noteDiv.appendChild(ellipsisContainer);
        } else {
            ellipsisContainer.style.display = 'block';
        }

        noteDiv.classList.add('collapsed');

        // Save collapsed state to localStorage
        localStorage.setItem(`note-${noteId}`, 'collapsed');
    }
}

// Function to restore note state from localStorage
function restoreNoteState(noteId) {
    const noteDiv = document.querySelector(`[data-id='${noteId}']`);
    const state = localStorage.getItem(`note-${noteId}`);
    
    if (state === 'collapsed') {
        // Initially collapsed
        toggleNoteView(noteId);
    }
}

// Call this function when the page loads to restore all notes' states
function restoreAllNotes() {
    const notes = document.querySelectorAll('.note'); // Assuming .note class on each note element
    notes.forEach(note => {
        const noteId = note.getAttribute('data-id');
        restoreNoteState(noteId);
    });
}

// Example: Call restoreAllNotes when the DOM is fully loaded
document.addEventListener('DOMContentLoaded', restoreAllNotes);






function loadGeneratedPDFs() {
    const userId = firebase.auth().currentUser?.uid;

    if (!userId) {
        console.error("User not authenticated yet");
        return;
    }

    db.collection('generatedpdfs')
        .where('userId', '==', userId)
        .orderBy('timestamp', 'desc')
        .onSnapshot(snapshot => {
            console.log("PDF data snapshot received"); // Log to verify the function is running
            const notesList = document.getElementById('notes-list');

            snapshot.docChanges().forEach(change => {
                const pdfData = change.doc.data();
                const pdfId = change.doc.id;

                // Extract the filename and remove the .pdf extension (if it exists)
                let fileName = pdfData.fileName || "Untitled PDF"; // Fallback if no filename
                const title = fileName.replace(/\.pdf$/i, ""); // Remove .pdf extension, case-insensitive
                const overview = pdfData.overview || "No overview available.";
                const keyPoints = pdfData.keyPoints || [];
                const timestamp = pdfData.timestamp?.toDate(); // Convert Firestore timestamp to Date object
                const dateCreated = timestamp ? timestamp.toLocaleDateString() + ' ' + timestamp.toLocaleTimeString() : "Unknown Date";

                if (change.type === "added" || change.type === "modified") {
                    let noteDiv = document.querySelector(`[data-id='${pdfId}']`);
                    if (!noteDiv) {
                        noteDiv = document.createElement('div');
                        noteDiv.className = 'note-item'; // Use the same class as notes for consistent styling
                        noteDiv.setAttribute('data-id', pdfId);
                        noteDiv.setAttribute('data-type', 'generatedpdf');
                    } else {
                        noteDiv.innerHTML = ''; // Clear existing content to update
                    }

                    // Format the key points as a list of bullet points
                    const formattedKeyPoints = keyPoints.length > 0 
                        ? keyPoints.map(point => `<li>${point.trim()}</li>`).join('')
                        : "<li>No key points available.</li>";

                    // Set the innerHTML including the title (without .pdf), date, overview, and key points
                    noteDiv.innerHTML = `
                        <strong>${title}</strong> <span class="date">${dateCreated}</span> <!-- Title and Date -->
                        <p><span class="overview-label"><strong2>Overview:</strong2></span> ${overview}</p> <!-- Display PDF Overview -->
                        <p><span class="key-points-label"><strong2>Key Points:</strong2></span></p> <!-- Display PDF Key Points -->
                        <ul>${formattedKeyPoints}</ul> <!-- Display PDF Key Points as a list -->
                        <div class="button-container">
                            <button class="edit" onclick="editItem('${pdfId}', 'generatedpdfs')">Edit</button>
                            <button class="delete" onclick="deleteItem('${pdfId}', 'generatedpdfs')">Delete</button>
                        </div>
                        <div class="ai-generated-tag">
                            <svg class="icon" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="-5.0 -10.0 110.0 135.0">
                                <path d="m74.773 57.645c-17.676 5.8398-23.562 11.727-29.402 29.402-0.48047 1.4531-2.5352 1.4531-3.0156 0-5.8398-17.676-11.727-23.562-29.402-29.402-1.4531-0.48047-1.4531-2.5352 0-3.0156 17.676-5.8398 23.562-11.727 29.402-29.402 0.48047-1.4531 2.5352-1.4531 3.0156 0 5.8398 17.676 11.727 23.562 29.402 29.402 1.4531 0.48047 1.4531 2.5352 0 3.0156z"/>
                                <path d="m87.594 28.617c-8.8359 2.918-11.781 5.8633-14.703 14.703-0.23828 0.72656-1.2656 0.72656-1.5078 0-2.918-8.8359-5.8633-11.781-14.703-14.703-0.72656-0.23828-0.72656-1.2656 0-1.5078 8.8359-2.918 11.781-5.8633 14.703-14.703 0.23828-0.72656 1.2656-0.72656 1.5078 0 2.918 8.8359 5.8633 11.781 14.703 14.703 0.72656 0.23828 0.72656 1.2656 0 1.5078z"/>
                            </svg>
                            <span>AI Generated</span>
                        </div>

<div class="quiz-btn" onclick="openQuizModal('${pdfId}')">
    <svg class="quiz-icon" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" fill="none">
        <g>
            <path d="M17.644 19.0181H21.3545L19.4984 14.5241L17.644 19.0181Z" fill="white"></path>
            <path d="M11.25 6C8.3505 6 6 8.35051 6 11.25V36.75C6 39.6495 8.35051 42 11.25 42H24.5187C23.2251 39.9794 22.4751 37.5773 22.4751 35C22.4751 33.4165 22.7582 31.899 23.2766 30.4956H11.25C10.5596 30.4956 10 29.936 10 29.2456C10 28.5553 10.5596 27.9956 11.25 27.9956H24.5215C26.8322 24.3897 30.8745 22 35.4751 22C37.8533 22 40.0823 22.6386 42 23.7536V11.25C42 8.3505 39.6495 6 36.75 6H11.25ZM10 35.25C10 34.5596 10.5596 34 11.25 34H19.2581C19.9484 34 20.5081 34.5596 20.5081 35.25C20.5081 35.9404 19.9484 36.5 19.2581 36.5H11.25C10.5596 36.5 10 35.9404 10 35.25ZM19.4977 9.99829C20.0039 9.99821 20.4601 10.3033 20.6533 10.7711L25.4053 22.2771C25.6688 22.9152 25.3652 23.6461 24.7271 23.9096C24.089 24.1732 23.3581 23.8695 23.0946 23.2315L22.387 21.5181H16.6123L15.9054 23.2311C15.6421 23.8693 14.9113 24.1731 14.2731 23.9098C13.635 23.6465 13.3311 22.9156 13.5945 22.2775L18.3424 10.7715C18.5355 10.3036 18.9916 9.99837 19.4977 9.99829ZM31.7476 9.99811C32.4379 9.99811 32.9976 10.5578 32.9976 11.2481V14H35.7501C36.4405 14 37.0001 14.5596 37.0001 15.25C37.0001 15.9404 36.4405 16.5 35.7501 16.5H32.9976V19.2483C32.9976 19.9386 32.4379 20.4983 31.7476 20.4983C31.0572 20.4983 30.4976 19.9386 30.4976 19.2483V16.5H27.75C27.0596 16.5 26.5 15.9404 26.5 15.25C26.5 14.5596 27.0596 14 27.75 14H30.4976V11.2481C30.4976 10.5578 31.0572 9.99811 31.7476 9.99811Z" fill="white"></path>
            <path d="M46.4751 35C46.4751 41.0751 41.5502 46 35.4751 46C29.4 46 24.4751 41.0751 24.4751 35C24.4751 28.9249 29.4 24 35.4751 24C41.5502 24 46.4751 28.9249 46.4751 35ZM36.4751 28C36.4751 27.4477 36.0274 27 35.4751 27C34.9228 27 34.4751 27.4477 34.4751 28V34H28.4751C27.9228 34 27.4751 34.4477 27.4751 35C27.4751 35.5523 27.9228 36 28.4751 36H34.4751V42C34.4751 42.5523 34.9228 43 35.4751 43C36.0274 43 36.4751 42.5523 36.4751 42V36H42.4751C43.0274 36 43.4751 35.5523 43.4751 35C43.4751 34.4477 43.0274 34 42.4751 34H36.4751V28Z" fill="white"></path>
        </g>
    </svg>
</div>
                        <div class="top-right-svg" onclick="togglePDFView('${pdfId}')">
                            <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" preserveAspectRatio="xMidYMid meet">
    <g>
        <!-- Circle background with primary color -->
        <circle cx="10" cy="10" r="10" fill="var(--primary-color)"/> 
        
        <!-- Original icon with white color -->
        <path fill="white" d="M13.098 8H6.902c-.751 0-1.172.754-.708 1.268L9.292 12.7c.36.399 1.055.399 1.416 0l3.098-3.433C14.27 8.754 13.849 8 13.098 8Z"></path>
    </g>
</svg>
        </div>
                    `;

                    // Insert the new noteDiv at the top of the notesList
                    notesList.insertBefore(noteDiv, notesList.firstChild);

                    // Apply the saved state from localStorage (collapsed or expanded)
                    applyPDFViewState(pdfId);

                } else if (change.type === "removed") {
                    const noteDiv = document.querySelector(`[data-id='${pdfId}']`);
                    if (noteDiv) {
                        notesList.removeChild(noteDiv);
                    }
                }
            });
        }, error => {
            console.error('Error loading PDFs: ', error);
        });
}


function togglePDFView(pdfId) {
    const noteDiv = document.querySelector(`[data-id='${pdfId}']`);
    const noteTitle = noteDiv.querySelector('strong'); // The note title is within a <strong> tag
    const dateSpan = noteDiv.querySelector('.date');
    const overview = noteDiv.querySelector('p:nth-of-type(1)'); // Assuming first <p> is the overview
    const keyPointsLabel = noteDiv.querySelector('.key-points-label'); // "Key Points" label
    const keyPoints = noteDiv.querySelector('ul'); // The list of key points
    const aiGeneratedTag = noteDiv.querySelector('.ai-generated-tag');
    const buttonContainer = noteDiv.querySelector('.button-container'); // Edit/Delete buttons
    let ellipsisContainer = noteDiv.querySelector('.ellipsis-container'); // Ellipsis container

    // Define the SVG code
    const svgIcon = `
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 791.454 791.454" class="note-icon pdf-icon"><g><path fill="var(--accent-color)" fill-rule="evenodd" d="M202.808 0h264.609l224.265 233.758v454.661c0 56.956-46.079 103.035-102.838 103.035H202.808c-56.956 0-103.035-46.079-103.035-103.035V103.035C99.772 46.079 145.851 0 202.808 0z" clip-rule="evenodd" ></path><g fill="#fff"><path fill-rule="evenodd" d="M467.219 0v231.978h224.463z" clip-rule="evenodd" opacity=".302" fill="#ffffff" ></path><path d="M214.278 590.525V445.959h61.505c15.228 0 27.292 4.153 36.389 12.657 9.097 8.306 13.646 19.579 13.646 33.62s-4.549 25.314-13.646 33.62c-9.097 8.504-21.161 12.657-36.389 12.657H251.26v52.012zm36.982-83.456h20.37c5.537 0 9.888-1.187 12.855-3.955 2.966-2.571 4.549-6.131 4.549-10.877s-1.582-8.306-4.549-10.877c-2.966-2.769-7.317-3.955-12.855-3.955h-20.37zm89.785 83.456V445.959h51.221c10.086 0 19.579 1.384 28.478 4.351 8.899 2.966 17.008 7.12 24.127 12.855 7.12 5.537 12.855 13.052 17.008 22.545 3.955 9.493 6.131 20.37 6.131 32.631 0 12.064-2.175 22.941-6.131 32.433-4.153 9.493-9.888 17.008-17.008 22.545-7.12 5.735-15.228 9.888-24.127 12.855-8.899 2.966-18.392 4.351-28.478 4.351zm36.191-31.444h10.679c5.735 0 11.075-.593 16.019-1.978 4.746-1.384 9.295-3.56 13.646-6.526 4.153-2.966 7.515-7.12 9.888-12.657s3.56-12.064 3.56-19.579c0-7.713-1.187-14.239-3.56-19.776s-5.735-9.69-9.888-12.657c-4.351-2.966-8.899-5.142-13.646-6.526-4.944-1.384-10.284-1.978-16.019-1.978h-10.679zM486.6 590.525V445.959h102.838v31.445h-65.856v23.138h52.605v31.247h-52.605v58.736z" fill="#ffffff" ></path></g></g></svg>`;


// Define the vertical ellipsis SVG within a circular button
const verticalEllipsisIcon = `
    <div class="ellipsis-container">
        <div class="ellipsis-button">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: middle;">
                <circle cx="12" cy="5" r="2" fill="var(--text-color)"/>
                <circle cx="12" cy="12" r="2" fill="var(--text-color)"/>
                <circle cx="12" cy="19" r="2" fill="var(--text-color)"/>
            </svg>
        </div>
    </div>
`;

    if (noteDiv.classList.contains('collapsed')) {
        // Show all hidden content
        overview.style.display = 'block';
        keyPointsLabel.style.display = 'block';
        keyPoints.style.display = 'block';
        aiGeneratedTag.style.display = 'flex';
        buttonContainer.style.display = 'flex';
        dateSpan.style.display = 'inline';
        noteTitle.style.display = 'inline';
        noteDiv.classList.remove('collapsed');
        
        // Hide the ellipsis container if it exists
        if (ellipsisContainer) {
            ellipsisContainer.style.display = 'none';
        }

        // Remove the SVG icon if already present
        const svgElement = noteDiv.querySelector('svg');
        if (svgElement) svgElement.remove();

        // Save state to localStorage as expanded
        localStorage.setItem(`pdf-${pdfId}`, 'expanded');

    } else {
        // Hide the content
        overview.style.display = 'none';
        keyPointsLabel.style.display = 'none';
        keyPoints.style.display = 'none';
        aiGeneratedTag.style.display = 'none';
        buttonContainer.style.display = 'none';
        dateSpan.style.display = 'block';
        dateSpan.style.marginLeft = '0';
        noteTitle.style.display = 'block';

        // Add the SVG icon in front of the title and date
        noteTitle.insertAdjacentHTML('beforebegin', svgIcon);

        // Add or show the ellipsis container
        if (!ellipsisContainer) {
            ellipsisContainer = document.createElement('div');
            ellipsisContainer.classList.add('ellipsis-container');
            ellipsisContainer.innerHTML = verticalEllipsisIcon;
            noteDiv.appendChild(ellipsisContainer);
        } else {
            ellipsisContainer.style.display = 'block';
        }

        noteDiv.classList.add('collapsed');

        // Save collapsed state to localStorage
        localStorage.setItem(`pdf-${pdfId}`, 'collapsed');
    }
}

// Call this function when loading to apply the saved state
function applyPDFViewState(pdfId) {
    const savedState = localStorage.getItem(`pdf-${pdfId}`);
    if (savedState === 'collapsed') {
        togglePDFView(pdfId); // Apply collapsed state if saved as collapsed
    }
}




// Call this function after authentication to load all notes
firebase.auth().onAuthStateChanged(user => {
    if (user) {
        loadAllNotes(); // Load all notes on user authentication
    }
});

// Function to create button container for edit/delete actions
function createButtonContainer() {
    const container = document.createElement('div');
    container.className = 'button-container';
    return container;
}

// Function to create an Edit button
function createEditButton(id, type) {
    const button = document.createElement('button');
    button.textContent = 'Edit';
    button.className = 'edit'; // Add edit class
    button.onclick = () => editItem(id, type);
    return button;
}

// Function to create a Delete button
function createDeleteButton(id, type) {
    const button = document.createElement('button');
    button.textContent = 'Delete';
    button.className = 'delete'; // Add delete class
    button.onclick = () => deleteItem(id, type);
    return button;
}

// Function to edit a note
function editItem(id, type) {
    const newValue = prompt(`Enter new value for ${type}:`);
    if (newValue) {
        db.collection(type).doc(id).update({
            [type === 'manualnotes' ? 'note' : 'summary']: newValue // Update the respective field
        }).then(() => {
            console.log(`${type} updated:`, newValue);
        }).catch((error) => {
            console.error(`Error updating ${type}:`, error);
        });
    }
}

// Function to delete a note
function deleteItem(id, type) {
    db.collection(type).doc(id).delete().then(() => {
        console.log(`${type} deleted:`, id);
    }).catch((error) => {
        console.error(`Error deleting ${type}:`, error);
    });
}

function showProgressBar() {
    const progressModal = document.getElementById('progressModal');
    const progressFill = document.querySelector('.progress-fill');
    const progressPercent = document.querySelector('.progress-percent');
    let progress = 0;

    // Show the modal
    progressModal.style.display = 'block';

    // Simulate the progress over time
    const progressInterval = setInterval(() => {
        if (progress < 100) {
            progress += 10; // Increase progress by 10%
            progressFill.style.width = `${progress}%`;
            progressPercent.textContent = `${progress}%`;
        } else {
            clearInterval(progressInterval);
        }
    }, 500); // Update every 500ms
}

function hideProgressBar() {
    const progressModal = document.getElementById('progressModal');
    const progressFill = document.querySelector('.progress-fill');
    const progressPercent = document.querySelector('.progress-percent');

    // Reset the progress bar
    progressFill.style.width = '0%';
    progressPercent.textContent = '0%';

    // Hide the modal
    progressModal.style.display = 'none';
}

function handleError() {
    const progressFill = document.querySelector('.progress-fill');
    const progressPercent = document.querySelector('.progress-percent');
    const modalContent = document.querySelector('.modal-content');

    // Show error state in the progress bar
    progressFill.style.background = 'linear-gradient(90deg, #c0392b, #c0392b)'; // Create a gradient using the red color // Change fill color to red for error
    progressPercent.textContent = 'Failed'; // Show "Failed" instead of percentage

    // Add error message below the progress bar
    const errorMessage = document.createElement('p');
    errorMessage.classList.add('error-message');
    errorMessage.textContent = 'Please try again.';
    modalContent.appendChild(errorMessage); // Append error message to the modal
}

// Helper function to generate a title from the text
function generateTitle(text) {
    const maxTitleLength = 50; // Limit title length
    const firstSentence = text.split('.')[0]; // Use the first sentence for the title
    return firstSentence.length > maxTitleLength ? firstSentence.slice(0, maxTitleLength) + '...' : firstSentence;
}


// Helper function to format the current date
function formatDate() {
    const now = new Date();
    return now.toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
    });
}

// Updated createNote function
function createNote() {
    const noteInput = document.querySelector('#noteModal2 textarea'); // Select textarea from Modal 2
    const noteText = noteInput.value.trim();

    if (!noteText) return; // Early exit if there's no text

    closeModal2();
    closeModal();
    showProgressBar();

    setTimeout(() => {
        generateSummary(noteText)
            .then(({ overview, keyPoints }) => {
                const notesList = document.getElementById('notes-list');
                const existingNotes = Array.from(notesList.children);

                // Generate a title dynamically from the note text
                const title = generateTitle(noteText);
                
                // Ensure title, overview, and keyPoints are defined
                if (!title || !overview || !keyPoints) {
                    console.error('Missing data for title, overview, or keyPoints.');
                    hideProgressBar();
                    return;
                }

                const isDuplicate = existingNotes.some(noteDiv => noteDiv.innerText.includes(overview));

                if (isDuplicate) {
                    console.error('Duplicate note detected.');
                    hideProgressBar();
                    return;
                }

                const noteDiv = document.createElement('div');
                noteDiv.className = 'note-item';

                const dateCreated = formatDate(); // Get the current date

                saveNoteToFirestore(noteText, overview, keyPoints, title, dateCreated)
                    .then(docId => {
                        noteDiv.setAttribute('data-id', docId);
                        hideProgressBar();
                        loadAllNotes(); // Reload the notes after the new one is saved
                    })
                    .catch(error => {
                        console.error('Error generating note:', error);
                        showError(); // Trigger the error handling function
                    });
            })
            .catch(error => {
                console.error('Error generating note:', error);
                showError(); // Trigger the error handling function
            });

        noteInput.value = ''; // Clear the textarea after note creation
    }, 2000); // Simulate a 2-second delay for the note generation process
}

// Function to save the generated note, title, and date to Firestore
function saveNoteToFirestore(noteText, overview, keyPoints, title, dateCreated) {
    const userId = firebase.auth().currentUser.uid; // Get current user's ID

    // Add the note to Firestore
    return db.collection('generatednotes').add({
        userId: userId,
        note: noteText,        // Original note text
        overview: overview,    // Overview of the note
        keyPoints: keyPoints,  // Key points as an array
        title: title,          // Add title to the Firestore document
        dateCreated: dateCreated,  // Add dateCreated to the Firestore document
        timestamp: firebase.firestore.FieldValue.serverTimestamp() // Save the time the note was created
    })
    .then(docRef => {
        console.log('Note successfully saved to Firestore with ID:', docRef.id);
        return docRef.id; // Return the document ID for further use
    })
    .catch(error => {
        console.error('Error saving note to Firestore: ', error);
        throw error; // Re-throw the error for further handling if needed
    });
}


// Add CSS styles to make "Overview" and "Key Points" text size smaller
const style = document.createElement('style');
style.innerHTML = `
    .note-item .overview-label, .note-item .key-points-label {
        font-size: 5px; /* Adjust font size for "Overview" and "Key Points" text */
    }
`;
document.head.appendChild(style);




// Function to create a manual note from Modal 3
function createManualNote() {
    const title = document.getElementById('personalNoteTitle3').value.trim();
    const date = document.getElementById('personalNoteDate3').value;
    const noteInput = document.getElementById('personalTextarea3'); // Select textarea from Modal 3
    const note = noteInput.value.trim();

    if (note && title) {
        db.collection('manualnotes').add({
            title: title,
            date: date,
            note: note,
            userId: firebase.auth().currentUser.uid,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        }).then(() => {
            console.log('Manual note created:', note);
            loadManualNotes(); // Reload manual notes after creation
        }).catch((error) => {
            console.error('Error creating manual note:', error);
        });

        // Clear the input fields after note creation
        document.getElementById('personalNoteTitle3').value = '';
        document.getElementById('personalNoteDate3').value = '';
        noteInput.value = '';
        
        closeModal3(); // Close Modal 3 after creating a personal note
    }
}






// Function to open the modal
function openModal() {
    const modal = document.getElementById("noteModal");
    modal.style.display = "flex"; // Ensure modal is flex to be centered
}

// Function to close the modal
function closeModal() {
    const modal = document.getElementById("noteModal");
    modal.style.display = "none"; // Hide modal
}

// Close modal if clicking outside the modal content
window.onclick = function(event) {
    const modal = document.getElementById("noteModal");
    if (event.target === modal) {
        modal.style.display = "none"; // Close if clicking outside modal content
    }
}

// Function to open Modal 2
function openModal2() {
    const modal = document.getElementById("noteModal2");
    modal.style.display = "block"; // Show modal
}


// Function to close Modal 2
function closeModal2() {
    const modal = document.getElementById("noteModal2");
    modal.style.display = "none"; // Hide modal
}

// Close modal if clicking outside the modal content for Modal 2
window.onclick = function(event) {
    const modal2 = document.getElementById("noteModal2");
    if (event.target === modal2) {
        modal2.style.display = "none"; // Close if clicking outside modal content
    }
}

let currentQuestionIndex = 0; // Track the current question index
let rawQuestions = []; // Store questions for the current session

// Function to open the Quiz Modal and load questions from Firestore
async function openQuizModal(pdfId) {
    const userId = firebase.auth().currentUser?.uid;

    if (!userId) {
        console.error("User not authenticated yet");
        return;
    }

    try {
        // Fetch the quiz data for the specific PDF using the provided pdfId
        const pdfDoc = await db.collection('generatedpdfs').doc(pdfId).get();
        
        if (pdfDoc.exists) {
            const quizData = pdfDoc.data();
            rawQuestions = quizData.rawQuestions || [];
            currentQuestionIndex = 0; // Reset to the first question

            if (rawQuestions.length > 0) {
                loadQuestion(currentQuestionIndex); // Load the first question
                document.getElementById("QuizModal").style.display = "block"; // Show the modal
            } else {
                console.error("No quiz questions found for this PDF.");
            }
        } else {
            console.error("PDF document not found.");
        }
    } catch (error) {
        console.error("Error fetching quiz data from Firestore: ", error);
    }
}

// Function to load a question based on the current index
function loadQuestion(index) {
    const questionData = rawQuestions[index];
    const question = questionData.question;
    const choices = questionData.choices;
    const correctAnswer = questionData.correctAnswer;

    // Populate the modal with the question number and text
    const quizQuestionHeader = document.querySelector('#QuizModal h9');
    quizQuestionHeader.innerHTML = `<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path style="fill:#509FE8;" d="M427.023,503.983H84.977c-9.446,0-17.102-7.656-17.102-17.102V84.977 c0-9.446,7.656-17.102,17.102-17.102h342.046c9.446,0,17.102,7.656,17.102,17.102v401.904 C444.125,496.327,436.469,503.983,427.023,503.983z"></path> <path style="fill:#4D8CCF;" d="M84.977,486.881V84.977c0-9.445,7.656-17.102,17.102-17.102H84.977 c-9.446,0-17.102,7.658-17.102,17.102v401.904c0,9.445,7.656,17.102,17.102,17.102h17.102 C92.634,503.983,84.977,496.326,84.977,486.881z"></path> <rect x="110.63" y="67.875" style="fill:#F6F6F7;" width="290.739" height="393.353"></rect> <path style="fill:#D9DCDF;" d="M152.852,110.63h206.296c4.427,0,8.017-3.589,8.017-8.017V67.875h-222.33v34.739 C144.835,107.041,148.424,110.63,152.852,110.63z"></path> <path style="fill:#FFC44F;" d="M350.063,93.528V59.324c0-9.446-7.656-17.102-17.102-17.102h-42.756 c0-18.891-15.314-34.205-34.205-34.205s-34.205,15.314-34.205,34.205H179.04c-9.446,0-17.102,7.656-17.102,17.102v34.205H350.063z"></path> <path style="fill:#FFD791;" d="M332.96,42.221h-17.102c9.446,0,17.102,7.658,17.102,17.102v34.205h17.102V59.324 C350.063,49.879,342.406,42.221,332.96,42.221z"></path> <path style="fill:#F7AB49;" d="M196.142,42.221H179.04c-9.446,0-17.102,7.658-17.102,17.102v34.205h17.102V59.324 C179.04,49.879,186.696,42.221,196.142,42.221z"></path> <path style="fill:#FF8C78;" d="M356.808,316.761l-85.512-171.023c-2.897-5.794-8.818-9.454-15.297-9.454 c-6.479,0-12.4,3.66-15.297,9.454l-85.511,171.023c-4.224,8.447-0.8,18.721,7.649,22.945c8.445,4.223,18.721,0.799,22.945-7.649 l33.754-67.506h72.923l33.754,67.506c2.996,5.993,9.035,9.459,15.31,9.458c2.57,0,5.18-0.581,7.635-1.809 C357.608,335.482,361.033,325.209,356.808,316.761z M236.64,230.347L256,191.628l19.36,38.719H236.64z"></path> <path d="M427.023,59.858h-68.944v-0.534c0-13.851-11.268-25.119-25.119-25.119h-35.502C293.703,14.743,276.542,0,256,0 c-20.541,0-37.703,14.743-41.458,34.205H179.04c-13.851,0-25.119,11.268-25.119,25.119v0.534H84.977 c-13.851,0-25.119,11.268-25.119,25.119v273.637c0,4.427,3.589,8.017,8.017,8.017s8.017-3.589,8.017-8.017V84.977 c0-5.01,4.076-9.086,9.086-9.086h17.637v385.336c0,4.427,3.589,8.017,8.017,8.017H401.37c4.428,0,8.017-3.589,8.017-8.017v-299.29 c0-4.427-3.588-8.017-8.017-8.017s-8.017,3.589-8.017,8.017v291.273H118.647V75.891h35.273v17.637c0,4.427,3.589,8.017,8.017,8.017 h188.125c4.428,0,8.017-3.589,8.017-8.017V75.891h35.273v43.29c0,4.427,3.588,8.017,8.017,8.017s8.017-3.589,8.017-8.017v-43.29 h17.637c5.01,0,9.086,4.076,9.086,9.086v401.904c0,5.01-4.076,9.086-9.086,9.086H84.977c-5.01,0-9.086-4.076-9.086-9.086V401.37 c0-4.427-3.589-8.017-8.017-8.017s-8.017,3.589-8.017,8.017v85.511c0,13.851,11.268,25.119,25.119,25.119h342.046 c13.851,0,25.119-11.268,25.119-25.119V84.977C452.142,71.126,440.874,59.858,427.023,59.858z M342.046,85.511H169.954V59.324 c0-5.01,4.076-9.086,9.086-9.086h42.756c4.427,0,8.017-3.589,8.017-8.017c0-14.44,11.748-26.188,26.188-26.188 c14.441,0,26.188,11.748,26.188,26.188c0,4.427,3.588,8.017,8.017,8.017h42.756c5.01,0,9.086,4.076,9.086,9.086V85.511z"></path> <path d="M256,25.653c-4.427,0-8.017,3.589-8.017,8.017v8.551c0,4.427,3.589,8.017,8.017,8.017c4.428,0,8.017-3.589,8.017-8.017 V33.67C264.017,29.243,260.428,25.653,256,25.653z"></path> <path d="M352.746,346.876c12.388-6.195,17.427-21.313,11.233-33.7l-85.511-171.023c-4.282-8.565-12.891-13.886-22.467-13.886 c-9.575,0-18.185,5.321-22.467,13.886l-85.511,171.023c-6.194,12.387-1.155,27.506,11.234,33.7 c12.388,6.194,27.506,1.155,33.7-11.234l31.538-63.074h63.014l31.537,63.074C325.17,347.896,340.458,353.017,352.746,346.876z M333.385,328.472l-33.754-67.506c-1.359-2.716-4.133-4.432-7.17-4.432h-72.923c-3.037,0-5.813,1.716-7.17,4.432l-33.754,67.506 c-2.241,4.482-7.71,6.303-12.19,4.064c-4.481-2.24-6.304-7.709-4.064-12.19l85.511-171.023c3.286-6.572,12.968-6.572,16.254,0 l85.512,171.023l0,0c2.288,4.575,0.231,10.263-4.412,12.355C340.831,334.681,335.533,332.768,333.385,328.472z"></path> <path d="M263.17,188.043c-2.897-5.792-11.444-5.794-14.34,0l-19.359,38.719c-2.621,5.24,1.323,11.602,7.17,11.602h38.719 c5.847,0,9.792-6.362,7.17-11.602L263.17,188.043z M249.612,222.33L256,209.553l6.389,12.776H249.612z"></path> <path d="M332.96,128.267c-4.428,0-8.017,3.589-8.017,8.017v9.086h-9.086c-4.428,0-8.017,3.589-8.017,8.017 c0,4.427,3.588,8.017,8.017,8.017h9.086v9.086c0,4.427,3.588,8.017,8.017,8.017c4.428,0,8.017-3.589,8.017-8.017v-9.086h9.086 c4.428,0,8.017-3.589,8.017-8.017c0-4.427-3.588-8.017-8.017-8.017h-9.086v-9.086C340.977,131.857,337.389,128.267,332.96,128.267z"></path> <path d="M332.426,384.267c0-4.427-3.588-8.017-8.017-8.017H187.591c-4.427,0-8.017,3.589-8.017,8.017 c0,4.427,3.589,8.017,8.017,8.017h136.818C328.838,392.284,332.426,388.695,332.426,384.267z"></path> <path d="M187.591,410.455c-4.427,0-8.017,3.589-8.017,8.017c0,4.427,3.589,8.017,8.017,8.017h76.96c4.428,0,8.017-3.589,8.017-8.017 c0-4.427-3.588-8.017-8.017-8.017H187.591z"></path> </g></svg> Quiz Question ${index + 1}             <!-- New Round Button with Updated SVG -->
            <button class="round-button">
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="-5.0 -10.0 110.0 135.0" fill="#ffffff" width="40" height="40">
                    <g>
                        <path d="m50.422 33.258 1.5703 4.3594c1.7422 4.8398 5.5547 8.6484 10.395 10.395l4.3594 1.5703c0.39453 0.14062 0.39453 0.69922 0 0.83984l-4.3594 1.5703c-4.8398 1.7422-8.6484 5.5547-10.395 10.395l-1.5703 4.3594c-0.14062 0.39453-0.69922 0.39453-0.83984 0l-1.5703-4.3594c-1.7422-4.8398-5.5547-8.6484-10.395-10.395l-4.3594-1.5703c-0.39453-0.14062-0.39453-0.69922 0-0.83984l4.3594-1.5703c4.8398-1.7422 8.6484-5.5547 10.395-10.395l1.5703-4.3594c0.14062-0.39453 0.69531-0.39453 0.83984 0z"/>
                        <path d="m85.629 28.539c-0.89453-1.4766-2.8125-1.9375-4.293-1.0547-1.4766 0.89453-1.9453 2.8164-1.0547 4.293 3.3203 5.4766 5.0703 11.777 5.0703 18.227 0 19.492-15.859 35.352-35.352 35.352-3.3398 0-6.5977-0.48828-9.7422-1.3906l3.1016-1.4922c1.5547-0.74609 2.2109-2.6172 1.4609-4.1719-0.74219-1.5547-2.6172-2.2109-4.1719-1.4609l-9.7656 4.6953c-0.78125 0.37891-1.3711 1.0625-1.6289 1.8906-0.25391 0.83203-0.15234 1.7266 0.27734 2.4805l5.3984 9.3984c0.57812 1.0078 1.6289 1.5703 2.7148 1.5703 0.52734 0 1.0625-0.13281 1.5547-0.41406 1.4961-0.85938 2.0156-2.7734 1.1523-4.2656l-1.1875-2.0703c3.5078 0.94922 7.1328 1.4766 10.84 1.4766 22.941 0 41.602-18.664 41.602-41.602-0.003907-7.5859-2.0664-15.012-5.9766-21.461z"/>
                        <path d="m49.996 14.648c3.3398 0 6.6016 0.48828 9.7422 1.3906l-3.1016 1.4922c-1.5547 0.74609-2.2109 2.6172-1.4609 4.1719 0.53906 1.1172 1.6523 1.7695 2.8203 1.7695 0.45703 0 0.91406-0.097656 1.3516-0.30859l9.7656-4.6953c0.78125-0.37891 1.3711-1.0625 1.6289-1.8906 0.25781-0.82812 0.16016-1.7266-0.27344-2.4805l-5.3984-9.3984c-0.85547-1.4961-2.7656-2.0117-4.2656-1.1523-1.4961 0.85938-2.0156 2.7734-1.1523 4.2656l1.1875 2.0703c-3.5078-0.94922-7.1328-1.4766-10.84-1.4766-22.941 0-41.602 18.664-41.602 41.602 0 7.5898 2.0664 15.016 5.9766 21.465 0.58594 0.96875 1.6211 1.5039 2.6758 1.5039 0.55469 0 1.1094-0.14844 1.6172-0.45312 1.4766-0.89453 1.9453-2.8164 1.0547-4.293-3.3203-5.4766-5.0703-11.777-5.0703-18.227-0.003906-19.496 15.855-35.355 35.344-35.355z"/>
                    </g>
                </svg>
            </button>`; // Adds question number

    document.getElementById('quiz-question').textContent = question;
    document.getElementById('optionA').textContent = "A. " + choices[0];
    document.getElementById('optionB').textContent = "B. " + choices[1];
    document.getElementById('optionC').textContent = "C. " + choices[2];
    document.getElementById('optionD').textContent = "D. " + choices[3];

    // Reset styles and Next button
    const options = document.querySelectorAll('.quiz-card');
    options.forEach(option => {
        option.style.backgroundColor = ''; // Reset background color
        option.onclick = () => handleOptionClick(option, option.id.slice(-1)); // Slice to get 'A', 'B', 'C', 'D'
    });
    document.getElementById('next-button').style.display = 'none';
}


function handleOptionClick(selectedOption, selectedLetter) {
    const questionData = rawQuestions[currentQuestionIndex];
    const correctAnswer = questionData.correctAnswer;

    // Extract the answer text without the letter (A, B, C, D)
    const answerText = selectedOption.textContent.slice(3); 

    // If the selected answer is correct
    if (selectedLetter === correctAnswer) {
        selectedOption.style.backgroundColor = 'green';

        // Replace the letter (A, B, C, or D) with the correct answer SVG
        selectedOption.innerHTML = `
        <div class="quiz-option-content" style="display: flex; align-items: center;">
            <span class="quiz-letter" style="display: flex; justify-content: center; align-items: center; width: 34px; height: 34px;">
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="34" height="34" x="0" y="0" viewBox="0 0 507.2 507.2" style="enable-background:new 0 0 512 512" xml:space="preserve">
                    <g>
                        <circle cx="253.6" cy="253.6" r="253.6" fill="#32ba7c"></circle>
                        <path d="M188.8 368l130.4 130.4c108-28.8 188-127.2 188-244.8v-7.2L404.8 152 188.8 368z" fill="#0aa06e"></path>
                        <path d="M260 310.4c11.2 11.2 11.2 30.4 0 41.6l-23.2 23.2c-11.2 11.2-30.4 11.2-41.6 0L93.6 272.8c-11.2-11.2-11.2-30.4 0-41.6l23.2-23.2c11.2-11.2 30.4-11.2 41.6 0L260 310.4z" fill="#ffffff"></path>
                        <path d="M348.8 133.6c11.2-11.2 30.4-11.2 41.6 0l23.2 23.2c11.2 11.2 11.2 30.4 0 41.6l-176 175.2c-11.2 11.2-30.4 11.2-41.6 0l-23.2-23.2c-11.2-11.2-11.2-30.4 0-41.6l176-175.2z" fill="#ffffff"></path>
                    </g>
                </svg>
            </span>
            <span class="quiz-option-text" style="margin-left: 10px;">${answerText}</span>
        </div>
        `;
        document.getElementById('next-button').style.display = 'block'; // Show Next button on correct answer
    } 
    // If the selected answer is wrong
    else {
        selectedOption.style.backgroundColor = 'red';

        // Replace the letter (A, B, C, or D) with the wrong answer SVG
        selectedOption.innerHTML = `
        <div class="quiz-option-content" style="display: flex; align-items: center;">
            <span class="quiz-letter" style="display: flex; justify-content: center; align-items: center; width: 34px; height: 34px;">
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="34" height="34" x="0" y="0" viewBox="0 0 507.2 507.2" style="enable-background:new 0 0 512 512" xml:space="preserve">
                    <g>
                        <circle cx="253.6" cy="253.6" r="253.6" fill="#f15249"></circle>
                        <path d="M147.2 368L284 504.8c115.2-13.6 206.4-104 220.8-219.2L367.2 148l-220 220z" fill="#ad0e0e"></path>
                        <path d="M373.6 309.6c11.2 11.2 11.2 30.4 0 41.6l-22.4 22.4c-11.2 11.2-30.4 11.2-41.6 0l-176-176c-11.2-11.2-11.2-30.4 0-41.6l23.2-23.2c11.2-11.2 30.4-11.2 41.6 0l175.2 176.8z" fill="#ffffff"></path>
                        <path d="M280.8 216L216 280.8l93.6 92.8c11.2 11.2 30.4 11.2 41.6 0l23.2-23.2c11.2-11.2 11.2-30.4 0-41.6L280.8 216z" fill="#d6d6d6"></path>
                        <path d="M309.6 133.6c11.2-11.2 30.4-11.2 41.6 0l23.2 23.2c11.2 11.2 11.2 30.4 0 41.6L197.6 373.6c-11.2 11.2-30.4 11.2-41.6 0l-22.4-22.4c-11.2-11.2-11.2-30.4 0-41.6l176-176z" fill="#ffffff"></path>
                    </g>
                </svg>
            </span>
            <span class="quiz-option-text" style="margin-left: 10px;">${answerText}</span>
        </div>
        `;
    }
}





// Function to handle moving to the next question
function nextQuestion() {
    currentQuestionIndex++; // Move to the next question

    if (currentQuestionIndex < rawQuestions.length) {
        loadQuestion(currentQuestionIndex); // Load the next question
    } else {
        closeQuizModal(); // Close the modal if all questions are done
    }
}

// Function to close the Quiz Modal and reset
function closeQuizModal() {
    document.getElementById("QuizModal").style.display = "none";
    currentQuestionIndex = 0; // Reset the question index
}

// Add a Next button in the HTML after quiz options





// Close modal if clicking outside the modal content for Modal 2
window.onclick = function(event) {
    const modal5 = document.getElementById("QuizModal");
    if (event.target === modal5) {
        modal5.style.display = "none"; // Close if clicking outside modal content
    }
}

// Function to open Modal 3
function openModal3() {
    const modal = document.getElementById("personalNoteModal3");
    modal.style.display = "block"; // Show modal
}

// Function to close Modal 3
function closeModal3() {
    const modal = document.getElementById("personalNoteModal3");
    modal.style.display = "none"; // Hide modal
}

// Close modal if clicking outside the modal content for Modal 3
window.onclick = function(event) {
    const modal3 = document.getElementById("personalNoteModal3");
    if (event.target === modal3) {
        modal3.style.display = "none"; // Close if clicking outside modal content
    }
}




    </script>
    
            <script>
        document.querySelector('.sidebar-toggle').addEventListener('click', () => {
            document.querySelector('.sidebar').classList.toggle('active');
        });
    </script>

    <script>
    function toggleNightMode() {
        document.body.classList.toggle('night-mode');
        // Save the user's preference in localStorage
        if (document.body.classList.contains('night-mode')) {
            localStorage.setItem('nightMode', 'enabled');
        } else {
            localStorage.setItem('nightMode', 'disabled');
        }
    }

    // Check localStorage to see if night mode was enabled previously
    document.addEventListener('DOMContentLoaded', (event) => {
        if (localStorage.getItem('nightMode') === 'enabled') {
            document.body.classList.add('night-mode');
        }
    });

    document.getElementById('toggleNightMode').addEventListener('click', function() {
    document.body.classList.toggle('night-mode');
});

    
</script>

<script>
    document.querySelector('.sidebar-toggle').addEventListener('click', () => {
        document.querySelector('.sidebar').classList.toggle('active');
    });
</script>

<script>
    async function toggleNightMode() {
        document.body.classList.toggle('night-mode');
        const isNightMode = document.body.classList.contains('night-mode');

        // Update localStorage
        localStorage.setItem('nightMode', isNightMode ? 'enabled' : 'disabled');

        // Save the theme preference to Firestore
            try {
                const user = firebase.auth().currentUser;
                if (user) {
                    const userId = user.uid;
                    await db.collection('users').doc(userId).set({
                        nightMode: isNightMode ? 'enabled' : 'disabled'
                    }, { merge: true });
                } else {
                    console.error('No user is signed in');
                }
            } catch (error) {
                console.error('Error updating Firestore:', error);
            }

            // Update theme icon
            updateThemeIcon(isNightMode ? 'moon' : 'sun');
        }
    function updateThemeIcon(state) {
        const themeIcon = document.getElementById('theme-icon');
        const themeContainer = document.querySelector('.theme-icon');

        // Animation effect
        themeContainer.classList.add('active');

        setTimeout(() => {
            if (state === 'moon') {
                themeIcon.innerHTML = `<path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>`;
                themeIcon.dataset.state = 'sun';
            } else {
                themeIcon.innerHTML = `<path d="M14.5739 1.11056L13.7826 2.69316C13.7632 2.73186 13.7319 2.76325 13.6932 2.7826L12.1106 3.5739C11.9631 3.64761 11.9631 3.85797 12.1106 3.93167L13.6932 4.72297C13.7319 4.74233 13.7632 4.77371 13.7826 4.81241L14.5739 6.39502C14.6476 6.54243 14.858 6.54243 14.9317 6.39502L15.723 4.81241C15.7423 4.77371 15.7737 4.74232 15.8124 4.72297L17.395 3.93167C17.5424 3.85797 17.5424 3.64761 17.395 3.5739L15.8124 2.7826C15.7737 2.76325 15.7423 2.73186 15.723 2.69316L14.9317 1.11056C14.858 0.963147 14.6476 0.963148 14.5739 1.11056Z" fill="#FFFFFF"></path> <path d="M19.2419 5.07223L18.4633 7.40815C18.4434 7.46787 18.3965 7.51474 18.3368 7.53464L16.0009 8.31328C15.8185 8.37406 15.8185 8.63198 16.0009 8.69276L18.3368 9.4714C18.3965 9.4913 18.4434 9.53817 18.4633 9.59789L19.2419 11.9338C19.3027 12.1161 19.5606 12.1161 19.6214 11.9338L20.4 9.59789C20.42 9.53817 20.4668 9.4913 20.5265 9.4714L22.8625 8.69276C23.0448 8.63198 23.0448 8.37406 22.8625 8.31328L20.5265 7.53464C20.4668 7.51474 20.42 7.46787 20.4 7.40815L19.6214 5.07223C19.5606 4.88989 19.3027 4.88989 19.2419 5.07223Z" fill="#FFFFFF"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M10.4075 13.6642C13.2348 16.4915 17.6517 16.7363 20.6641 14.3703C20.7014 14.341 20.7385 14.3113 20.7754 14.2812C20.9148 14.1674 21.051 14.0479 21.1837 13.9226C21.2376 13.8718 21.2909 13.8201 21.3436 13.7674C21.8557 13.2552 22.9064 13.5578 22.7517 14.2653C22.6983 14.5098 22.6365 14.7517 22.5667 14.9905C22.5253 15.1321 22.4811 15.2727 22.4341 15.4122C22.4213 15.4502 22.4082 15.4883 22.395 15.5262C20.8977 19.8142 16.7886 23.0003 12 23.0003C5.92487 23.0003 1 18.0754 1 12.0003C1 7.13315 4.29086 2.98258 8.66889 1.54252L8.72248 1.52504C8.8185 1.49401 8.91503 1.46428 9.01205 1.43587C9.26959 1.36046 9.5306 1.29438 9.79466 1.23801C10.5379 1.07934 10.8418 2.19074 10.3043 2.72815C10.251 2.78147 10.1987 2.83539 10.1473 2.88989C10.0456 2.99777 9.94766 3.10794 9.8535 3.22023C9.83286 3.24485 9.8124 3.26957 9.79212 3.29439C7.32966 6.30844 7.54457 10.8012 10.4075 13.6642ZM8.99331 15.0784C11.7248 17.8099 15.6724 18.6299 19.0872 17.4693C17.4281 19.6024 14.85 21.0003 12 21.0003C7.02944 21.0003 3 16.9709 3 12.0003C3 9.09163 4.45653 6.47161 6.66058 4.81846C5.41569 8.27071 6.2174 12.3025 8.99331 15.0784Z" fill="#FFFFFF"></path>`;
                themeIcon.dataset.state = 'moon';
            }
            themeContainer.classList.remove('active');
        }, 500); // Duration matches the CSS animation duration
    }

        // Check Firestore for night mode preference
        document.addEventListener('DOMContentLoaded', async (event) => {
            try {
                firebase.auth().onAuthStateChanged(async (user) => {
                    if (user) {
                        const userId = user.uid;
                        try {
                            const doc = await db.collection('users').doc(userId).get();
                            const nightMode = doc.exists ? doc.data().nightMode : null;
                            if (nightMode === 'enabled') {
                                document.body.classList.add('night-mode');
                                updateThemeIcon('moon');
                            } else {
                                updateThemeIcon('sun');
                            }
                        } catch (error) {
                            console.error('Error fetching Firestore document:', error);
                        }

                        // Event listener for toggle button
                        document.getElementById('toggleNightMode').addEventListener('click', toggleNightMode);
                    } else {
                        console.error('No user is signed in');
                    }
                });
            } catch (error) {
                console.error('Error initializing Firebase Authentication:', error);
            }
        });

    // Event listener for toggle button
    document.getElementById('toggleNightMode').addEventListener('click', toggleNightMode);
</script>

<script>
function loadSmallProfilePicture() {
    const currentUser = firebase.auth().currentUser;
    const avatarContainer = document.getElementById('smallProfilePictureContainer');
    const defaultAvatar = document.getElementById('defaultAvatar');

    if (currentUser) {
        const uid = currentUser.uid;
        const userDocRef = firestore.collection('users').doc(uid);

        userDocRef.get().then(doc => {
            if (doc.exists) {
                const data = doc.data();
                const profilePictureUrl = data.profilePicture;

                if (profilePictureUrl) {
                    // Create and append the new profile picture
                    const img = document.createElement('img');
                    img.src = profilePictureUrl;
                    img.alt = 'Profile Picture';
                    img.style.width = '40px'; // Ensure the image has the same size as the SVG
                    img.style.height = '40px';
                    img.style.borderRadius = '50%';

                    // Replace the SVG with the new image
                    avatarContainer.innerHTML = '';  // Clear the current content
                    avatarContainer.appendChild(img);
                } else {
                    console.log("No profile picture set for user.");
                }
            } else {
                console.error("No user document found.");
            }
        }).catch(error => {
            console.error("Error loading profile picture: ", error);
        });
    } else {
        console.error("User is not authenticated.");
    }
}

// Call the function when the page loads
document.addEventListener('DOMContentLoaded', function() {
    firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
            loadSmallProfilePicture();
        }
    });
});


function showProgressBar() {
    const progressModal = document.getElementById('progressModal');
    const progressFill = document.querySelector('.progress-fill');
    const progressPercent = document.querySelector('.progress-percent');
    const errorMessage = document.getElementById('error-message');
    let progress = 0;

    // Reset any previous error messages and percentage text
    errorMessage.style.display = 'none';
    progressPercent.textContent = '0%';
    progressFill.style.width = '0%';

    // Show the modal
    progressModal.style.display = 'block';

    // Simulate the progress over time
    const progressInterval = setInterval(() => {
        if (progress < 100) {
            progress += 10; // Increase progress by 10%
            progressFill.style.width = `${progress}%`;
            progressPercent.textContent = `${progress}%`;
        } else {
            clearInterval(progressInterval);
        }
    }, 500); // Update every 500ms
}

function hideProgressBar() {
    const progressModal = document.getElementById('progressModal');
    const progressFill = document.querySelector('.progress-fill');
    const progressPercent = document.querySelector('.progress-percent');

    // Reset the progress bar
    progressFill.style.width = '0%';
    progressPercent.textContent = '0%';

    // Hide the modal
    progressModal.style.display = 'none';
}

function showError() {
    const progressModal = document.getElementById('progressModal');
    const progressFill = document.querySelector('.progress-fill');
    const progressPercent = document.querySelector('.progress-percent');
    const errorMessage = document.getElementById('error-message');

    // Check if the text content contains a percentage or a number
    const progressText = progressPercent.textContent;
    const hasNumberOrPercentage = /\d+%/.test(progressText); // Checks if there's a number followed by a %

    if (hasNumberOrPercentage) {
        // Wait 5 seconds before showing the failed text
        setTimeout(() => {
            // Show error message and set percentage to "Failed"
            progressFill.style.background = 'linear-gradient(90deg, #c0392b, #c0392b)'; // Error gradient color
            progressPercent.textContent = 'Failed';
            errorMessage.style.display = 'block';
        }, 5000); // 5000 milliseconds = 5 seconds
    }
}








</script>


    </body>
</html>
